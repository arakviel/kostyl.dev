---
title: '–ü–∞—Ç—Ç–µ—Ä–Ω–∏ Dependency Injection'
description: '–¢—Ä–∏ —Å–ø–æ—Å–æ–±–∏ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π —É C#: Constructor, Property —Ç–∞ Method Injection. –ì–ª–∏–±–æ–∫–∏–π —Ä–æ–∑–±—ñ—Ä –∫–æ–∂–Ω–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É, –∞–Ω–∞–ª–æ–≥—ñ—ó –∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —Å–≤—ñ—Ç—É, –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è, –ø–∞—Ç—Ç–µ—Ä–Ω–∏ Factory —Ç–∞ Decorator —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ DI.'
---

# –ü–∞—Ç—Ç–µ—Ä–Ω–∏ Dependency Injection

## –í—Å—Ç—É–ø: –¢—Ä–∏ –°–ø–æ—Å–æ–±–∏ –ü–µ—Ä–µ–¥–∞—Ç–∏ –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å

–†–∞–Ω—ñ—à–µ –º–∏ –∑—Ä–æ–∑—É–º—ñ–ª–∏, —â–æ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —Ç—Ä–µ–±–∞ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç–∏ –∑–∑–æ–≤–Ω—ñ (Dependency Injection). –ê–ª–µ —î **—Ç—Ä–∏ —Ä—ñ–∑–Ω–∏—Ö —Å–ø–æ—Å–æ–±–∏** —Ü–µ –∑—Ä–æ–±–∏—Ç–∏. –ö–æ–∂–µ–Ω –º–∞—î —Å–≤–æ—é –∞–Ω–∞–ª–æ–≥—ñ—é:

**Constructor Injection** ‚Äî "–û—Ñ—ñ—Ü—ñ–π–Ω–∏–π –∫–æ–Ω—Ç—Ä–∞–∫—Ç –ø—Ä–∏ –ø—Ä–∏–π–æ–º—ñ –Ω–∞ —Ä–æ–±–æ—Ç—É"  
–¢–∏ –ø—ñ–¥–ø–∏—Å—É—î—à —É–≥–æ–¥—É, –¥–µ —á—ñ—Ç–∫–æ –ø—Ä–æ–ø–∏—Å–∞–Ω–æ: —Ç–æ–±—ñ –ø–æ—Ç—Ä—ñ–±–µ–Ω —Å—Ç—ñ–ª, –∫–æ–º–ø'—é—Ç–µ—Ä —ñ –¥–æ—Å—Ç—É–ø –¥–æ —Å–∏—Å—Ç–µ–º–∏. –í—Å–µ —Ü–µ –Ω–∞–¥–∞–Ω–µ –ø—Ä–∏ –≤—Å—Ç—É–ø—ñ. –ë–µ–∑ —Ü—å–æ–≥–æ –∫–ª–∞—Å –Ω–µ –º–æ–∂–µ **—ñ—Å–Ω—É–≤–∞—Ç–∏**.

**Property Injection** ‚Äî "–î–æ–¥–∞—Ç–∫–æ–≤–µ –æ–±–ª–∞–¥–Ω–∞–Ω–Ω—è —è–∫–µ –º–æ–∂–Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø—ñ–∑–Ω—ñ—à–µ"  
–ö–ª–∞—Å –º–æ–∂–Ω–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —ñ –±–µ–∑ –Ω—å–æ–≥–æ, –∞–ª–µ —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω –ø—Ä–∏–Ω—Ç–µ—Ä ‚Äî –π–æ–≥–æ –ø—ñ–¥–∫–ª—é—á–∞—é—Ç—å –ø—ñ—Å–ª—è. –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å **–Ω–µ –æ–±–æ–≤'—è–∑–∫–æ–≤–∞**.

**Method Injection** ‚Äî "–¢–∏–º—á–∞—Å–æ–≤–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è"  
–ë—É–¥—ñ–≤–µ–ª—å–Ω–∏–∫ –º–∞—î –≤–ª–∞—Å–Ω–∏–π –¥—Ä–µ–ª—å, –∞–ª–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –π–æ–º—É –ø–æ–∑–∏—á–∞—é—Ç—å —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–∏–π –ø–µ—Ä—Ñ–æ—Ä–∞—Ç–æ—Ä. –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –ø–æ—Ç—Ä—ñ–±–Ω–∞ **–ª–∏—à–µ –¥–ª—è –æ–¥–Ω–æ–≥–æ –≤–∏–∫–ª–∏–∫—É**.

---

## –ß–∞—Å—Ç–∏–Ω–∞ 1: Constructor Injection

### 1.1. –©–æ —Ü–µ —Ç–∞–∫–µ —ñ –Ω–∞–≤—ñ—â–æ

**Constructor Injection** ‚Äî —Ü–µ –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–∏–π —Ç–∞ –Ω–∞–π—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω—ñ—à–∏–π —Å–ø–æ—Å—ñ–± DI. –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∫–ª–∞—Å—É —ñ —Å—Ç–∞—é—Ç—å –¥–æ—Å—Ç—É–ø–Ω–∏–º–∏ **–æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è** –æ–±'—î–∫—Ç–∞.

–ö–ª—é—á–æ–≤–∞ —ñ–¥–µ—è: –æ–±'—î–∫—Ç –Ω–µ –º–æ–∂–µ **—ñ—Å–Ω—É–≤–∞—Ç–∏** —É –Ω–µ–ø–æ–≤–Ω–æ–º—É —Å—Ç–∞–Ω—ñ. –Ø–∫—â–æ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –Ω–µ –Ω–∞–¥–∞–Ω–∞ ‚Äî –æ–±'—î–∫—Ç –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –≤–∑–∞–≥–∞–ª—ñ.

### 1.2. –ë–∞–∑–æ–≤–∏–π –ø—Ä–∏–∫–ª–∞–¥

```csharp showLineNumbers
// –Ü–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ ‚Äî "–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∏" –º—ñ–∂ –∫–ª–∞—Å–∞–º–∏
public interface ILogger { void Log(string message); }
public interface IOrderRepository { void Save(Order order); }
public interface IEmailService { void Send(string to, string body); }

// OrderService –∑ Constructor Injection
public class OrderService
{
    // –ü—Ä–∏–≤–∞—Ç–Ω—ñ –ø–æ–ª—è, —â–æ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ.
    // Readonly ‚Äî –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ –ø—ñ—Å–ª—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ —ó—Ö –Ω–µ –º–æ–∂–Ω–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏.
    private readonly IOrderRepository _repository;
    private readonly IEmailService _emailService;
    private readonly ILogger _logger;

    // –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —î "–ø—É–±–ª—ñ—á–Ω–∏–º –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–º": –æ–≥–æ–ª–æ—à—É—î —á–æ–≥–æ –ø–æ—Ç—Ä–µ–±—É—î –∫–ª–∞—Å.
    // –¶–µ —î–¥–∏–Ω–µ –º—ñ—Å—Ü–µ, –¥–µ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ "–≤–≤–æ–¥—è—Ç—å—Å—è" (inject) —É –∫–ª–∞—Å.
    public OrderService(
        IOrderRepository repository,
        IEmailService emailService,
        ILogger logger)
    {
        // Guard clauses ‚Äî –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ null
        _repository = repository ?? throw new ArgumentNullException(nameof(repository));
        _emailService = emailService ?? throw new ArgumentNullException(nameof(emailService));
        _logger = logger ?? throw new ArgumentNullException(nameof(logger));
    }

    // –ú–µ—Ç–æ–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –∞–ª–µ –Ω–µ –∑–Ω–∞—é—Ç—å –ø—Ä–æ —ó—Ö –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Ç–∏–ø
    public void PlaceOrder(Order order)
    {
        _logger.Log($"Placing order {order.Id}...");
        _repository.Save(order);
        _emailService.Send(order.CustomerEmail, $"–ó–∞–º–æ–≤–ª–µ–Ω–Ω—è #{order.Id} –ø—Ä–∏–π–Ω—è—Ç–æ!");
        _logger.Log($"Order {order.Id} placed successfully.");
    }
}
```

### 1.3. –ü–µ—Ä–µ–≤–∞–≥–∏ Constructor Injection

**1. –Ø–≤–Ω—ñ—Å—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π**  
–î–æ—Å—Ç–∞—Ç–Ω—å–æ –ø–æ–≥–ª—è–Ω—É—Ç–∏ –Ω–∞ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä ‚Äî —ñ –∑—Ä–∞–∑—É –∑—Ä–æ–∑—É–º—ñ–ª–æ, —â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∫–ª–∞—Å—É. –¶–µ –∂–∏–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è.

**2. –ì–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–∏–π –ø–æ–≤–Ω–∏–π —Å—Ç–∞–Ω**  
–û–±'—î–∫—Ç –∞–±–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –∑ —É—Å—ñ–º–∞ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—è–º–∏, –∞–±–æ –Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –≤–∑–∞–≥–∞–ª—ñ. –ù–µ–º–∞—î –ø—Ä–æ–º—ñ–∂–Ω–æ–≥–æ "–Ω–∞–ø—ñ–≤–≥–æ—Ç–æ–≤–æ–≥–æ" —Å—Ç–∞–Ω—É.

**3. –ù–µ–∑–º—ñ–Ω–Ω—ñ—Å—Ç—å (Immutability)**  
–ó–∞–≤–¥—è–∫–∏ `readonly` –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—Ç—å—Å—è –æ–¥–∏–Ω —Ä–∞–∑. Thread-safe –∑–∞ —Å–≤–æ—î—é –ø—Ä–∏—Ä–æ–¥–æ—é.

**4. –õ–µ–≥–∫—ñ—Å—Ç—å —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è**  
–£ —Ç–µ—Å—Ç–∞—Ö –º–∏ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–¥–∞—î–º–æ –º–æ–∫–∏ —É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä:

```csharp showLineNumbers
[TestMethod]
public void PlaceOrder_ShouldSaveAndSendEmail()
{
    // Arrange: —è–≤–Ω–æ —ñ –∑—Ä–æ–∑—É–º—ñ–ª–æ
    var mockRepo = new Mock<IOrderRepository>();
    var mockEmail = new Mock<IEmailService>();
    var mockLogger = new Mock<ILogger>();

    // –ü–µ—Ä–µ–¥–∞—î–º–æ –º–æ–∫–∏ ‚Äî –∫–ª–∞—Å —ó—Ö –Ω–µ "–ø–æ–º—ñ—Ç–∏—Ç—å"!
    var service = new OrderService(
        mockRepo.Object,
        mockEmail.Object,
        mockLogger.Object);

    var order = new Order { Id = 1, CustomerEmail = "test@test.com" };

    // Act
    service.PlaceOrder(order);

    // Assert
    mockRepo.Verify(r => r.Save(order), Times.Once);
    mockEmail.Verify(e => e.Send("test@test.com", It.IsAny<string>()), Times.Once);
}
```

### 1.4. –ü—Ä–æ–±–ª–µ–º–∞ "Constructor Over-injection"

–ö–æ–ª–∏ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –º–∞—î –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤ ‚Äî —Ü–µ **–∑–∞–ø–∞—Ö –∫–æ–¥—É** (code smell):

```csharp
// ‚ùå –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∑ 8+ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ ‚Äî —Å–∏–≥–Ω–∞–ª –ø—Ä–æ –ø—Ä–æ–±–ª–µ–º—É!
public class ComplexOrderService
{
    public ComplexOrderService(
        IOrderRepository repository,
        IEmailService emailService,
        ILogger logger,
        IInventoryService inventory,
        IPaymentGateway payment,
        INotificationService notifications,
        IShippingService shipping,
        IAuditService audit)   // 8 –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤!
    { /* ... */ }
}
```

**–°–∏–≥–Ω–∞–ª**: –ö–ª–∞—Å –ø–æ—Ä—É—à—É—î Single Responsibility Principle. –í—ñ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞ –∑–∞–Ω–∞–¥—Ç–æ –±–∞–≥–∞—Ç–æ —Ä–µ—á–µ–π. –†—ñ—à–µ–Ω–Ω—è ‚Äî –≤–∏–¥—ñ–ª–∏—Ç–∏ –º–µ–Ω—à—ñ –∫–ª–∞—Å–∏ –∞–±–æ –∑–≥—Ä—É–ø—É–≤–∞—Ç–∏ –ø–æ–≤'—è–∑–∞–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —É "–¥–æ–º–µ–Ω–Ω–∏–π —Å–µ—Ä–≤—ñ—Å".

```csharp
// ‚úÖ –ö—Ä–∞—â–µ: –∑–≥—Ä—É–ø—É—î–º–æ –ø–æ–≤'—è–∑–∞–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
public record OrderProcessingContext(
    IInventoryService Inventory,
    IPaymentGateway Payment,
    IShippingService Shipping);

public class OrderService
{
    public OrderService(
        IOrderRepository repository,
        IEmailService emailService,
        ILogger logger,
        OrderProcessingContext processingCtx)  // –¢–µ–ø–µ—Ä 4 –ø–∞—Ä–∞–º–µ—Ç—Ä–∏
    { /* ... */ }
}
```

---

## –ß–∞—Å—Ç–∏–Ω–∞ 2: Property Injection

### 2.1. –©–æ —Ü–µ —Ç–∞–∫–µ —ñ –∫–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏

**Property Injection** (—Ç–∞–∫–æ–∂ Setter Injection) ‚Äî –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª—é—é—Ç—å—Å—è —á–µ—Ä–µ–∑ **–ø—É–±–ª—ñ—á–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ** –ø—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–±'—î–∫—Ç–∞.

–¶–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è **–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π** ‚Äî —Ç–∏—Ö, –¥–µ –∫–ª–∞—Å –º–æ–∂–µ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω—É–≤–∞—Ç–∏ –±–µ–∑ –Ω–∏—Ö (—Ö–æ—á–∞, –º–æ–∂–ª–∏–≤–æ, —ñ –∑ –æ–±–º–µ–∂–µ–Ω–æ—é —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—é).

### 2.2. –ü—Ä–∏–∫–ª–∞–¥: Logger —è–∫ –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å

```csharp showLineNumbers
// Property Injection ‚Äî –¥–ª—è –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
public class OrderProcessor
{
    // –û–ë–û–í'–Ø–ó–ö–û–í–Ü –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ ‚Äî —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
    private readonly IOrderRepository _repository;
    private readonly IPaymentGateway _payment;

    public OrderProcessor(IOrderRepository repository, IPaymentGateway payment)
    {
        _repository = repository;
        _payment = payment;
    }

    // –ù–ï–û–ë–û–í'–Ø–ó–ö–û–í–ê –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å ‚Äî —á–µ—Ä–µ–∑ –≤–ª–∞—Å—Ç–∏–≤—ñ—Å—Ç—å.
    // –ö–ª–∞—Å –º–æ–∂–µ —ñ—Å–Ω—É–≤–∞—Ç–∏ —ñ –±–µ–∑ –ª–æ–≥–µ—Ä–∞ (–±—É–¥–µ –ø—Ä–æ—Å—Ç–æ –±–µ–∑ –ª–æ–≥—É–≤–∞–Ω–Ω—è).
    // Null Object Pattern: NullLogger –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç—å, –∞–ª–µ –Ω–µ –∫–∏–¥–∞—î null exception.
    public ILogger Logger { get; set; } = NullLogger.Instance;

    public void ProcessOrder(Order order)
    {
        Logger.Log($"Processing order {order.Id}");  // –ë–µ–∑–ø–µ—á–Ω–æ –Ω–∞–≤—ñ—Ç—å –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–µ—Ä–∞
        _payment.Charge(order.Total);
        _repository.Save(order);
        Logger.Log($"Order {order.Id} processed");
    }
}

// Null Object Pattern –¥–ª—è Logger
public class NullLogger : ILogger
{
    public static readonly NullLogger Instance = new();
    public void Log(string message) { }  // –ù—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏—Ç—å
}
```

### 2.3. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –∫–æ–¥—ñ —Ç–∞ —Ç–µ—Å—Ç–∞—Ö

```csharp showLineNumbers
// –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –±–µ–∑ –ª–æ–≥–µ—Ä–∞
var processor = new OrderProcessor(repository, payment);
// Logger = NullLogger –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ ‚Äî –Ω–µ –∫–∏–¥–∞—î exception!

// –î–æ–¥–∞—î–º–æ –ª–æ–≥–µ—Ä –∑–∞ –ø–æ—Ç—Ä–µ–±–∏
processor.Logger = new ConsoleLogger();

// –£ —Ç–µ—Å—Ç—ñ: –≤—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –º–æ–∫ –ø—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
var processor = new OrderProcessor(mockRepo, mockPayment);
processor.Logger = mockLogger; // –ù–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ –¥–ª—è —Ä–æ–±–æ—Ç–∏!

// –£ DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ñ Microsoft DI –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î Property Injection –Ω–∞—Ç–∏–≤–Ω–æ.
// –ê–ª–µ –º–æ–∂–Ω–∞ —á–µ—Ä–µ–∑ factory:
services.AddScoped<OrderProcessor>(sp =>
{
    var processor = new OrderProcessor(
        sp.GetRequiredService<IOrderRepository>(),
        sp.GetRequiredService<IPaymentGateway>());
    processor.Logger = sp.GetService<ILogger>() ?? NullLogger.Instance; // Property injection!
    return processor;
});
```

### 2.4. –ù–µ–¥–æ–ª—ñ–∫–∏ Property Injection

```csharp
// ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 1: –ù–µ–ø–æ–≤–Ω–∏–π —Å—Ç–∞–Ω –æ–±'—î–∫—Ç–∞
var processor = new OrderProcessor(repository, payment);
// processor.Logger –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ ‚Äî –∞–ª–µ –æ–±'—î–∫—Ç "–∂–∏–≤–µ" –±–µ–∑ –ø—Ä–æ–±–ª–µ–º

// ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 2: –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–º—ñ–Ω–µ–Ω—ñ –ø—ñ—Å–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
processor.Logger = new ConsoleLogger();
// ... —è–∫–∏–π—Å—å –∫–æ–¥ ...
processor.Logger = null; // ‚Üê –•—Ç–æ—Å—å –æ–±–Ω—É–ª–∏–≤! NullReferenceException!

// ‚ùå –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ–∑—Ä–æ–∑—É–º—ñ–ª–æ, —è–∫–µ –º—ñ–Ω—ñ–º–∞–ª—å–Ω–µ –≤–∏–º–æ–≥–∞ –¥–æ –∫–ª–∞—Å—É
// (—â–æ –æ–±–æ–≤'—è–∑–∫–æ–≤–µ, —â–æ –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–µ ‚Äî –¥–æ–≤–æ–¥–∏—Ç—å—Å—è —á–∏—Ç–∞—Ç–∏ –≤—Å—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é)
```

::warning
Microsoft DI (IServiceCollection) **–Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î** Property Injection "–∑ –∫–æ—Ä–æ–±–∫–∏". –Ø–∫—â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–µ–Ω Property Injection ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ factory-—Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—é –∞–±–æ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ (Autofac, Castle Windsor).
::

---

## –ß–∞—Å—Ç–∏–Ω–∞ 3: Method Injection

### 3.1. –©–æ —Ü–µ —Ç–∞–∫–µ —ñ –∫–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏

**Method Injection** ‚Äî –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è —è–∫ **–ø–∞—Ä–∞–º–µ—Ç—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–µ—Ç–æ–¥—É**, –∞ –Ω–µ –≤—Å—å–æ–≥–æ –∫–ª–∞—Å—É. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è, –∫–æ–ª–∏ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –ø–æ—Ç—Ä—ñ–±–Ω–∞ **—Ç—ñ–ª—å–∫–∏ –≤ –æ–¥–Ω–æ–º—É –º–µ—Ç–æ–¥—ñ**, —ñ –Ω–µ–º–∞—î —Å–µ–Ω—Å—É —Ç—Ä–∏–º–∞—Ç–∏ —ó—ó –≤–µ—Å—å —á–∞—Å.

### 3.2. –ö–ª–∞—Å–∏—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥

```csharp showLineNumbers
public class DataProcessor
{
    // –ù–µ–º–∞—î –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ ILogger —É –ø–æ–ª—è—Ö –∫–ª–∞—Å—É!
    // –û—Å–Ω–æ–≤–Ω–∞ –ª–æ–≥—ñ–∫–∞ –Ω–µ –ø–æ—Ç—Ä–µ–±—É—î –ª–æ–≥—É–≤–∞–Ω–Ω—è.

    public void ProcessData(DataSet data)
    {
        // –ë—ñ–∑–Ω–µ—Å –ª–æ–≥—ñ–∫–∞ –±–µ–∑ –ª–æ–≥—É–≤–∞–Ω–Ω—è
        foreach (var row in data.Rows)
            TransformRow(row);
    }

    // !!! Method Injection ‚Äî –ª–æ–≥–µ—Ä –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ —Å—é–¥–∏
    // –¶–µ–π –º–µ—Ç–æ–¥ –ø–æ—Ç—Ä–µ–±—É—î –Ω–∞–ª–∞–≥–æ–¥–∂–µ–Ω–Ω—è –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö —Å—Ü–µ–Ω–∞—Ä—ñ—è—Ö
    public void ProcessDataWithLogging(DataSet data, ILogger logger)
    {
        logger.Log("Processing started");

        foreach (var row in data.Rows)
        {
            logger.Log($"Processing row {row.Id}");
            TransformRow(row);
        }

        logger.Log("Processing complete");
    }

    private void TransformRow(DataRow row) { /* ... */ }
}
```

### 3.3. Method Injection —É ASP.NET Core: IFromServices

ASP.NET Core –Ω–∞—Ç–∏–≤–Ω–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î Method Injection –¥–ª—è Controller actions:

```csharp showLineNumbers
[ApiController]
[Route("api/[controller]")]
public class ReportController : ControllerBase
{
    // –ó–∞–≥–∞–ª—å–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ ‚Äî —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä (–∑–∞–≤–∂–¥–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ)
    private readonly ILogger<ReportController> _logger;

    public ReportController(ILogger<ReportController> logger)
    {
        _logger = logger;
    }

    // [FromServices] injection ‚Äî –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å —Ç—ñ–ª—å–∫–∏ –¥–ª—è —Ü—å–æ–≥–æ –µ–Ω–¥–ø–æ—ñ–Ω—Ç—É
    // –ù–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ "—Ç—è–≥–Ω—É—Ç–∏" IReportGenerator —É –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä —è–∫—â–æ –≤—ñ–Ω —Ä—ñ–¥–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è!
    [HttpGet("monthly")]
    public async Task<IActionResult> GetMonthlyReport(
        [FromServices] IReportGenerator reportGenerator,  // Method Injection!
        [FromQuery] int month,
        [FromQuery] int year)
    {
        _logger.LogInformation("Generating {Month}/{Year} report", month, year);
        var report = await reportGenerator.GenerateMonthlyAsync(month, year);
        return Ok(report);
    }

    [HttpGet("annual")]
    public async Task<IActionResult> GetAnnualReport(
        [FromServices] IAnnualReportGenerator annualGenerator,  // –Ü–Ω—à–∞ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å!
        [FromQuery] int year)
    {
        var report = await annualGenerator.GenerateAsync(year);
        return Ok(report);
    }
}
```

### 3.4. –ö–æ–ª–∏ Method Injection –≤–∏–ø—Ä–∞–≤–¥–∞–Ω–∏–π?

**–î–æ—Ä–µ—á–Ω–æ:**
- –ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –ø–æ—Ç—Ä—ñ–±–Ω–∞ —Ç—ñ–ª—å–∫–∏ –≤ –æ–¥–Ω–æ–º—É –º–µ—Ç–æ–¥—ñ —ñ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –Ω—ñ–¥–µ –±—ñ–ª—å—à–µ
- Expensive-to-create –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å —è–∫—É —Ö–æ—á–µ–º–æ "–ª—ñ–Ω–∏—Ç–∏" (–∞–ª–µ –∫—Ä–∞—â–µ Lazy<T>)
- ASP.NET Core `[FromServices]` –¥–ª—è —Ä—ñ–¥–∫–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–Ω–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤ —É –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞—Ö

**–ù–µ –¥–æ—Ä–µ—á–Ω–æ:**
- –Ø–∫—â–æ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –ø–æ—Ç—Ä—ñ–±–Ω–∞ –≤ 2+ –º–µ—Ç–æ–¥–∞—Ö ‚Äî –∫—Ä–∞—â–µ —á–µ—Ä–µ–∑ Constructor Injection
- –Ø–∫—â–æ –∑–∞–±—Ä—É–¥–Ω—é—î —Å–∏–≥–Ω–∞—Ç—É—Ä—É –º–µ—Ç–æ–¥—É –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏

---

## –ß–∞—Å—Ç–∏–Ω–∞ 4: –ü–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è

| –ö—Ä–∏—Ç–µ—Ä—ñ–π | Constructor | Property | Method |
|---|---|---|---|
| **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è** | ‚úÖ –ó–∞–≤–∂–¥–∏ preferred | ‚ö†Ô∏è –ù–µ–æ–±–æ–≤'—è–∑–∫–æ–≤—ñ | ‚ö†Ô∏è –°–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –≤–∏–ø–∞–¥–∫–∏ |
| **–û–±–æ–≤'—è–∑–∫–æ–≤—ñ—Å—Ç—å** | –û–±–æ–≤'—è–∑–∫–æ–≤–∞ | –ù–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∞ | –°–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∞ –¥–ª—è –º–µ—Ç–æ–¥—É |
| **–°—Ç–∞–Ω –æ–±'—î–∫—Ç–∞** | –ó–∞–≤–∂–¥–∏ –ø–æ–≤–Ω–∏–π | –ú–æ–∂–µ –±—É—Ç–∏ –Ω–µ–ø–æ–≤–Ω–∏–º | ‚Äî |
| **Immutability** | ‚úÖ (readonly) | ‚ùå (–º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏—Å—å) | ‚úÖ (per-call) |
| **Testability** | ‚úÖ –õ–µ–≥–∫–æ | ‚ö†Ô∏è –¢—Ä–µ–±–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª—é–≤–∞—Ç–∏ | ‚úÖ –ü–µ—Ä–µ–¥–∞—î—Ç—å—Å—è —É –≤–∏–∫–ª–∏–∫—É |
| **Microsoft DI** | ‚úÖ –ù–∞—Ç–∏–≤–Ω–æ | ‚ùå –¢—ñ–ª—å–∫–∏ —á–µ—Ä–µ–∑ factory | ‚úÖ [FromServices] |
| **–Ø–≤–Ω—ñ—Å—Ç—å** | ‚úÖ –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä | ‚ö†Ô∏è –í–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ | ‚ö†Ô∏è –ü–∞—Ä–∞–º–µ—Ç—Ä–∏ –º–µ—Ç–æ–¥—É |

::mermaid

```mermaid
graph TD
    Q{"–ó–∞–ª–µ–∂–Ω—ñ—Å—Ç—å\n–æ–±–æ–≤'—è–∑–∫–æ–≤–∞?"}
    Q -->|–¢–∞–∫| CI["‚úÖ Constructor Injection\nrecommended"]
    Q -->|–ù—ñ| Q2{"–ü–æ—Ç—Ä—ñ–±–Ω–∞\n—Ç—ñ–ª—å–∫–∏ –≤\n–æ–¥–Ω–æ–º—É –º–µ—Ç–æ–¥—ñ?"}
    Q2 -->|–¢–∞–∫| MI["‚ö†Ô∏è Method Injection\n[FromServices]"]
    Q2 -->|–ù—ñ| PI["‚ö†Ô∏è Property Injection\n–∑ Null Object Pattern"]

    style CI fill:#10b981,stroke:#059669,color:#ffffff
    style MI fill:#f59e0b,stroke:#b45309,color:#1e293b
    style PI fill:#f59e0b,stroke:#b45309,color:#1e293b
```

::

---

## –ß–∞—Å—Ç–∏–Ω–∞ 5: –ü–∞—Ç—Ç–µ—Ä–Ω Factory —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ DI

### 5.1. –ß–æ–º—É Factory –ø–æ—Ç—Ä—ñ–±–Ω–∞?

DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –≤–∏—Ä—ñ—à—É—î –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ **–æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∑–∞–ø—É—Å–∫—É** (–¥–ª—è Singleton) –∞–±–æ **–Ω–∞ –ø–æ—á–∞—Ç–∫—É scope** (–¥–ª—è Scoped). –ê–ª–µ —â–æ —è–∫—â–æ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ **–¥–∏–Ω–∞–º—ñ—á–Ω–æ** —É runtime –≤–∏—Ä—ñ—à–∏—Ç–∏, —è–∫–∏–π —Ç–∏–ø —Å—Ç–≤–æ—Ä–∏—Ç–∏?

```csharp
// ‚ùå –ü—Ä–æ–±–ª–µ–º–∞: –Ω–µ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–¥–∞—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –ø—Ä–∏ Resolve —á–µ—Ä–µ–∑ DI
services.AddScoped<IEmailService, SmtpEmailService>();
// SmtpEmailService –ø–æ—Ç—Ä–µ–±—É—î –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π email –æ–¥–µ—Ä–∂—É–≤–∞—á–∞ ‚Äî –∞–ª–µ –∑–≤—ñ–¥–∫–∏ –π–æ–≥–æ –≤–∑—è—Ç–∏?

var emailService = provider.GetRequiredService<IEmailService>();
// –î–æ –∫–æ–≥–æ –Ω–∞–¥—Å–∏–ª–∞—Ç–∏? –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–Ω–∞—î –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è!
```

### 5.2. Factory Pattern –≤–∏—Ä—ñ—à–µ–Ω–Ω—è

```csharp showLineNumbers
// –í–∞—Ä—ñ–∞–Ω—Ç 1: Factory —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
public interface IEmailServiceFactory
{
    IEmailService CreateForRecipient(string recipientEmail);
}

public class EmailServiceFactory : IEmailServiceFactory
{
    private readonly ILogger _logger;
    private readonly SmtpConfig _config;

    // Factory —Å–∞–º–∞ –æ—Ç—Ä–∏–º—É—î –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ —á–µ—Ä–µ–∑ DI!
    public EmailServiceFactory(ILogger logger, SmtpConfig config)
    {
        _logger = logger;
        _config = config;
    }

    public IEmailService CreateForRecipient(string recipientEmail)
    {
        _logger.Log($"Creating email service for {recipientEmail}");
        return new SmtpEmailService(_config, recipientEmail);
    }
}

// –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
services.AddSingleton<IEmailServiceFactory, EmailServiceFactory>();

// –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
public class OrderService
{
    private readonly IEmailServiceFactory _emailFactory;

    public OrderService(IEmailServiceFactory emailFactory)
    {
        _emailFactory = emailFactory;
    }

    public void PlaceOrder(Order order)
    {
        // –î–∏–Ω–∞–º—ñ—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î–º–æ —Å–µ—Ä–≤—ñ—Å –∑ –ø–æ—Ç—Ä—ñ–±–Ω–∏–º –æ–¥–µ—Ä–∂—É–≤–∞—á–µ–º
        var emailService = _emailFactory.CreateForRecipient(order.CustomerEmail);
        emailService.Send("–í–∞—à–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏–π–Ω—è—Ç–æ!");
    }
}
```

### 5.3. Func<T> —è–∫ Factory

–£ Microsoft DI –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ `Func<T>` —è–∫ –≤–±—É–¥–æ–≤–∞–Ω—É Factory:

```csharp showLineNumbers
// –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è: Func —è–∫ factory
services.AddTransient<IEmailService, SmtpEmailService>();
services.AddSingleton<Func<IEmailService>>(sp =>
    () => sp.GetRequiredService<IEmailService>());

// –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è ‚Äî Func<T> inject —è–∫ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å!
public class NotificationService
{
    private readonly Func<IEmailService> _emailFactory;

    public NotificationService(Func<IEmailService> emailFactory)
    {
        _emailFactory = emailFactory;
    }

    public void Notify(string to, string message)
    {
        // –ö–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É –æ—Ç—Ä–∏–º—É—î–º–æ –Ω–æ–≤–∏–π Transient email —Å–µ—Ä–≤—ñ—Å
        var email = _emailFactory();
        email.Send(to, message);
    }
}
```

---

## –ß–∞—Å—Ç–∏–Ω–∞ 6: –ü–∞—Ç—Ç–µ—Ä–Ω Decorator —É –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ DI

**Decorator** –¥–æ–∑–≤–æ–ª—è—î –¥–æ–¥–∞—Ç–∏ –ø–æ–≤–µ–¥—ñ–Ω–∫—É –¥–æ —Å–µ—Ä–≤—ñ—Å—É (–ª–æ–≥—É–≤–∞–Ω–Ω—è, –∫–µ—à—É–≤–∞–Ω–Ω—è, retry) **–±–µ–∑ –∑–º—ñ–Ω–∏** –π–æ–≥–æ –∫–æ–¥—É. –£ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ DI ‚Äî decorator "–æ–≥–æ—Ä—Ç–∞—î" –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏–π —Å–µ—Ä–≤—ñ—Å.

```csharp showLineNumbers
// –ë–∞–∑–æ–≤–∏–π —Å–µ—Ä–≤—ñ—Å
public class SqlOrderRepository : IOrderRepository
{
    public void Save(Order order) { /* SQL INSERT */ }
    public Order Get(int id) { /* SQL SELECT */ return null!; }
}

// Decorator: –¥–æ–¥–∞—î –ª–æ–≥—É–≤–∞–Ω–Ω—è –±–µ–∑ –∑–º—ñ–Ω–∏ SqlOrderRepository!
public class LoggingOrderRepository : IOrderRepository
{
    private readonly IOrderRepository _inner;  // –†–µ–∞–ª—å–Ω–∏–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π
    private readonly ILogger _logger;

    // –ü—Ä–∏–π–º–∞—î "–≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ–π" —Å–µ—Ä–≤—ñ—Å —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä ‚Äî —Ü–µ —Ç–µ–∂ DI!
    public LoggingOrderRepository(IOrderRepository inner, ILogger logger)
    {
        _inner = inner;
        _logger = logger;
    }

    public void Save(Order order)
    {
        _logger.Log($"[BEFORE] Saving order {order.Id}");
        _inner.Save(order);  // –î–µ–ª–µ–≥—É—î–º–æ —Ä–µ–∞–ª—å–Ω—ñ–π —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
        _logger.Log($"[AFTER] Order {order.Id} saved");
    }

    public Order Get(int id)
    {
        _logger.Log($"[BEFORE] Getting order {id}");
        var result = _inner.Get(id);
        _logger.Log($"[AFTER] Got order {id}: {result?.Status}");
        return result;
    }
}

// –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∑ Decorator —á–µ—Ä–µ–∑ Scrutor (–±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–ª—è Microsoft DI)
// PM> Install-Package Scrutor
services.AddScoped<IOrderRepository, SqlOrderRepository>();
services.Decorate<IOrderRepository, LoggingOrderRepository>();  // –û–≥–æ—Ä—Ç–∞—î–º–æ!

// –ê–±–æ –≤—Ä—É—á–Ω—É —á–µ—Ä–µ–∑ factory
services.AddScoped<SqlOrderRepository>();
services.AddScoped<IOrderRepository>(sp =>
{
    var inner = sp.GetRequiredService<SqlOrderRepository>();
    var logger = sp.GetRequiredService<ILogger>();
    return new LoggingOrderRepository(inner, logger);  // Decorator –≤—Ä—É—á–Ω—É
});
```

**–õ–æ–≥—ñ–∫–∞ –ª–∞–Ω—Ü—é–≥–∞ Decorator:**

```
OrderService ‚Üí LoggingOrderRepository ‚Üí CachingOrderRepository ‚Üí SqlOrderRepository
                  (decorator)              (decorator)              (—Ä–µ–∞–ª—å–Ω–∞ –ë–î)
```

–ö–æ–∂–µ–Ω decorator –æ–≥–æ—Ä—Ç–∞—î –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —ñ –¥–æ–¥–∞—î —Å–≤—ñ–π —à–∞—Ä —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—ñ.

---

## –ü—ñ–¥—Å—É–º–æ–∫

–¢—Ä–∏ –º–µ—Ç–æ–¥–∏ DI –≤–∏—Ä—ñ—à—É—é—Ç—å —Ä—ñ–∑–Ω—ñ –∑–∞–¥–∞—á—ñ. –ü—Ä–∞–≤–∏–ª–æ –≤–∏–±–æ—Ä—É –ø—Ä–æ—Å—Ç–µ:

::card-group

::card{title="Constructor Injection" icon="i-heroicons-building-office-2"}
**–ó–∞–≤–∂–¥–∏ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º**. –û–±–æ–≤'—è–∑–∫–æ–≤—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ, —è–∫–∏—Ö –∫–ª–∞—Å –Ω–µ –º–æ–∂–µ —ñ—Å–Ω—É–≤–∞—Ç–∏ –±–µ–∑ –Ω–∏—Ö. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ —è–≤–Ω—ñ—Å—Ç—å, testability —Ç–∞ immutability.
::

::card{title="Property Injection" icon="i-heroicons-adjustments-horizontal"}
**–¢—ñ–ª—å–∫–∏ –¥–ª—è –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∏—Ö –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π**. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Null Object Pattern —è–∫ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º. –†—ñ–¥–∫–æ –ø–æ—Ç—Ä—ñ–±–µ–Ω —É –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–ø—Ä–æ–µ–∫—Ç–æ–≤–∞–Ω–æ–º—É –∫–æ–¥—ñ.
::

::card{title="Method Injection" icon="i-heroicons-beaker"}
**–î–ª—è —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ–≥–æ –º–µ—Ç–æ–¥—É**. –Ø–∫—â–æ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –ø–æ—Ç—Ä—ñ–±–Ω–∞ —Ç—ñ–ª—å–∫–∏ –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ, –Ω–µ–º–∞—î —Å–µ–Ω—Å—É "—Ç—è–≥–Ω—É—Ç–∏" —ó—ó —É –≤–µ—Å—å –∫–ª–∞—Å. ASP.NET Core `[FromServices]` ‚Äî –∑—Ä—É—á–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è.
::

::

---

## üìù –ó–∞–≤–¥–∞–Ω–Ω—è

### –ó–∞–≤–¥–∞–Ω–Ω—è 1: –í–∏–±—ñ—Ä –º–µ—Ç–æ–¥—É (Easy)

–î–ª—è –∫–æ–∂–Ω–æ—ó —Å–∏—Ç—É–∞—Ü—ñ—ó –æ–±–µ—Ä—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –º–µ—Ç–æ–¥ DI —Ç–∞ –ø–æ—è—Å–Ω—ñ—Ç—å —á–æ–º—É:

1. `UserService` –∑–∞–≤–∂–¥–∏ –ø–æ—Ç—Ä–µ–±—É—î `IUserRepository` –¥–ª—è –≤—Å—ñ—Ö —Å–≤–æ—ó—Ö –º–µ—Ç–æ–¥—ñ–≤
2. `DataProcessor` –º–∞—î –º–µ—Ç–æ–¥ `ExportToExcel(IExcelWriter writer)` ‚Äî writer –ø–æ—Ç—Ä—ñ–±–µ–Ω –ª–∏—à–µ —Ç—É—Ç
3. `HttpClient` —É –∫–ª–∞—Å—ñ –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏—Å—è, –∞–ª–µ —è–∫—â–æ –Ω–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π ‚Äî –∫–ª–∞—Å —É—Å–µ –æ–¥–Ω–æ –∫–æ—Ä–µ–∫—Ç–Ω–æ –ø—Ä–∞—Ü—é—î (–ø–æ–≤–µ—Ä—Ç–∞—î empty results)
4. ASP.NET Core Controller –º–∞—î endpoint `/api/reports/pdf` —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `IPdfGenerator`

### –ó–∞–≤–¥–∞–Ω–Ω—è 2: –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è Decorator (Medium)

–†–µ–∞–ª—ñ–∑—É–π—Ç–µ `CachingOrderRepository` ‚Äî decorator –¥–ª—è `IOrderRepository`, —â–æ –∫–µ—à—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ `Get(int id)` –≤ `Dictionary<int, Order>` –Ω–∞ 5 —Ö–≤–∏–ª–∏–Ω. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ –ª–∞–Ω—Ü—é–≥: `SqlOrderRepository` ‚Üí `LoggingOrderRepository` ‚Üí `CachingOrderRepository`.

### –ó–∞–≤–¥–∞–Ω–Ω—è 3: Factory –¥–ª—è –¥–∏–Ω–∞–º—ñ—á–Ω–æ–≥–æ –≤–∏–±–æ—Ä—É (Hard)

–†–µ–∞–ª—ñ–∑—É–π—Ç–µ —Å–∏—Å—Ç–µ–º—É —Å–ø–æ–≤—ñ—â–µ–Ω—å –∑ –∫—ñ–ª—å–∫–æ–º–∞ –∫–∞–Ω–∞–ª–∞–º–∏:
- `INotificationChannel` ‚Äî —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- `EmailChannel`, `SmsChannel`, `PushChannel` ‚Äî —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó
- `INotificationChannelFactory` ‚Äî —Ñ–∞–±—Ä–∏–∫–∞, —â–æ –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ç—Ä—ñ–±–Ω–∏–π –∫–∞–Ω–∞–ª –∑–∞ `NotificationType` enum

–ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ –≤—Å—ñ —É Microsoft DI —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ factory —É `NotificationService.SendAsync(notification)`.
