# React Hook Form: –ì–ª–∏–±–æ–∫–µ –†–æ–∑—É–º—ñ–Ω–Ω—è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ —Ç–∞ –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

::note
**–ü–µ—Ä–µ–¥—É–º–æ–≤–∏**: –î–ª—è –ø–æ–≤–Ω–æ–≥–æ –∑–∞—Å–≤–æ—î–Ω–Ω—è —Ü—å–æ–≥–æ –º–∞—Ç–µ—Ä—ñ–∞–ª—É –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ —Ä–æ–∑—É–º—ñ—Ç–∏:

- –û—Å–Ω–æ–≤–∏ React (—Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏, —Ö—É–∫–∏ `useState`, `useRef`, `useEffect`)
- [–ë–∞–∑–æ–≤—É —Ä–æ–±–æ—Ç—É –∑ —Ñ–æ—Ä–º–∞–º–∏ –≤ React](./01.react-forms.md)
- –ö–æ–Ω—Ü–µ–ø—Ü—ñ—ó controlled —Ç–∞ uncontrolled –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤

::

---

## –í—Å—Ç—É–ø: –ï–≤–æ–ª—é—Ü—ñ—è –†–æ–±–æ—Ç–∏ –∑ –§–æ—Ä–º–∞–º–∏

–£—è–≤—ñ—Ç—å, —â–æ –≤–∏ —Ä–æ–∑—Ä–æ–±–ª—è—î—Ç–µ —Å–∫–ª–∞–¥–Ω—É —Ñ–æ—Ä–º—É —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∑ 20+ –ø–æ–ª—è–º–∏: –æ—Å–æ–±–∏—Å—Ç—ñ –¥–∞–Ω—ñ, –∞–¥—Ä–µ—Å–∞, –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –±–µ–∑–ø–µ–∫–∏, –ø—Ä–µ—Ñ–µ—Ä–µ–Ω—Ü—ñ—ó. –ü—Ä–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—ñ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É –∑ `useState` –∫–æ–∂–Ω–µ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –∫–ª–∞–≤—ñ—à—ñ –≤–∏–∫–ª–∏–∫–∞—î —Ä–µ-—Ä–µ–Ω–¥–µ—Ä **–≤—Å—å–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**. –î–ª—è 20 –ø–æ–ª—ñ–≤ —Ç–∞ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ü–µ –æ–∑–Ω–∞—á–∞—î **—Å–æ—Ç–Ω—ñ –Ω–µ–ø–æ—Ç—Ä—ñ–±–Ω–∏—Ö —Ä–µ–Ω–¥–µ—Ä—ñ–≤** –∑–∞ —Ö–≤–∏–ª–∏–Ω—É.

**React Hook Form** –≤–∏—Ä—ñ—à—É—î —Ü—é —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—É –ø—Ä–æ–±–ª–µ–º—É —á–µ—Ä–µ–∑ —ñ–Ω–Ω–æ–≤–∞—Ü—ñ–π–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥, –∑–∞—Å–Ω–æ–≤–∞–Ω–∏–π –Ω–∞ **uncontrolled inputs** —Ç–∞ **—Ä–æ–∑—É–º–Ω–æ–º—É —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—ñ ref-–∞–º–∏**.

::mermaid

```mermaid
flowchart LR
    subgraph Traditional["üêå –¢—Ä–∞–¥–∏—Ü—ñ–π–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ (Controlled)"]
        direction TB
        I1[Input onChange] --> S1[setState]
        S1 --> R1[**Re-render –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**]
        R1 --> V1[Virtual DOM diff]
        V1 --> D1[DOM update]
    end

    subgraph RHF["‚ö° React Hook Form (Uncontrolled)"]
        direction TB
        I2[Input onChange] --> REF[Ref update]
        REF --> SUB{–Ñ –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∏?}
        SUB -->|–ù–µ–º–∞—î| SKIP[–ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ —Ä–µ–Ω–¥–µ—Ä]
        SUB -->|–¢–∞–∫| R2[–†–µ–Ω–¥–µ—Ä —Ç—ñ–ª—å–∫–∏ –ø—ñ–¥–ø–∏—Å–∞–Ω–∏—Ö]
    end

    style Traditional fill:#ef4444,stroke:#b91c1c,color:#ffffff
    style RHF fill:#22c5e,stroke:#15803d,color:#ffffff
```

::

### –ö–ª—é—á–æ–≤—ñ –ø–µ—Ä–µ–≤–∞–≥–∏ React Hook Form

::card-group
::card{title="–ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–∏" icon="i-heroicons-bolt"}
–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è uncontrolled inputs —Ç–∞ ref-—ñ–≤ –∑–∞–º—ñ—Å—Ç—å state –∑–º–µ–Ω—à—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ–Ω–¥–µ—Ä—ñ–≤ —É **10-100 —Ä–∞–∑—ñ–≤**.
::

::card{title="–ú–∞–ª–∏–π —Ä–æ–∑–º—ñ—Ä –±–∞–Ω–¥–ª—É" icon="i-heroicons-arrow-down-circle"}
–õ–∏—à–µ **~12KB gzipped** ‚Äî –æ–¥–Ω–∞ –∑ –Ω–∞–π–ª–µ–≥—à–∏—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫ (Formik ~45KB, Redux Form ~26KB).
::

::card{title="–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å" icon="i-heroicons-rocket-launch"}
–§–æ—Ä–º–∏ –º–æ–Ω—Ç—É—é—Ç—å—Å—è —à–≤–∏–¥—à–µ –∑–∞ controlled –∞–Ω–∞–ª–æ–≥–∏ –∑–∞–≤–¥—è–∫–∏ –º–µ–Ω—à—ñ–π –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –æ–±—á–∏—Å–ª–µ–Ω—å –ø—ñ–¥ —á–∞—Å —Ä–µ–Ω–¥–µ—Ä—É.
::

::card{title="DX —Ç–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è" icon="i-heroicons-puzzle-piece"}
–í–±—É–¥–æ–≤–∞–Ω–∞ TypeScript –ø—ñ–¥—Ç—Ä–∏–º–∫–∞, —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ Yup/Zod/Joi, React DevTools, —Ç–∞ UI-–±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞–º–∏.
::
::

---

## –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞ –¢–µ–æ—Ä—ñ—è: Controlled vs Uncontrolled

–ü–µ—Ä–µ–¥ —Ç–∏–º, —è–∫ –∑–∞–≥–ª–∏–±–∏—Ç–∏—Å—è –≤ React Hook Form, –∫—Ä–∏—Ç–∏—á–Ω–æ –≤–∞–∂–ª–∏–≤–æ –∑—Ä–æ–∑—É–º—ñ—Ç–∏ —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ –¥–≤–æ–º–∞ –ø—ñ–¥—Ö–æ–¥–∞–º–∏ –¥–æ —Ä–æ–±–æ—Ç–∏ –∑ —Ñ–æ—Ä–º–∞–º–∏.

### Controlled Components (–ö–µ—Ä–æ–≤–∞–Ω—ñ)

**Controlled component** ‚Äî —Ü–µ —ñ–Ω–ø—É—Ç, —á–∏—î –∑–Ω–∞—á–µ–Ω–Ω—è –ø–æ–≤–Ω—ñ—Å—Ç—é –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç—å—Å—è React state:

```jsx showLineNumbers
import { useState } from 'react'

function ControlledForm() {
    const [email, setEmail] = useState('')

    // –ö–æ–∂–Ω–µ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—è –∫–ª–∞–≤—ñ—à—ñ:
    // 1. –í–∏–∫–ª–∏–∫–∞—î setEmail
    // 2. –û–Ω–æ–≤–ª—é—î state
    // 3. –†–µ-—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
    // 4. React –ø–æ—Ä—ñ–≤–Ω—é—î Virtual DOM
    // 5. –û–Ω–æ–≤–ª—é—î —Ä–µ–∞–ª—å–Ω–∏–π DOM (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)

    return (
        <input
            value={email} // –î–∂–µ—Ä–µ–ª–æ —ñ—Å—Ç–∏–Ω–∏: React state
            onChange={(e) => setEmail(e.target.value)}
        />
    )
}
```

**–ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª –∑–º—ñ–Ω–∏ –∑–Ω–∞—á–µ–Ω–Ω—è:**

::mermaid

```mermaid
sequenceDiagram
    participant User as üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á
    participant Input as üìù Input DOM
    participant React as ‚öõÔ∏è React
    participant State as üíæ State

    User->>Input: –í–≤–æ–¥–∏—Ç—å "a"
    Input->>React: onChange event
    React->>State: setState('a')
    State->>React: Trigger re-render
    React->>React: Virtual DOM diff
    React->>Input: Update value prop

    Note over React: üî¥ –ü–û–í–ù–ò–ô –†–ï-–†–ï–ù–î–ï–† –ö–û–ú–ü–û–ù–ï–ù–¢–ê
```

::

**–ü–µ—Ä–µ–≤–∞–≥–∏ controlled:**

- ‚úÖ –ü–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∑–Ω–∞—á–µ–Ω–Ω—è–º (–ª–µ–≥–∫–æ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞—Ç–∏, –æ–±–º–µ–∂—É–≤–∞—Ç–∏)
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–Ω–µ —á–∏—Ç–∞–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è
- ‚úÖ –õ–µ–≥–∫–æ –≤–∞–ª—ñ–¥—É–≤–∞—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ

**–ù–µ–¥–æ–ª—ñ–∫–∏ controlled:**

- ‚ùå –ö–æ–∂–Ω–∞ –∑–º—ñ–Ω–∞ = —Ä–µ-—Ä–µ–Ω–¥–µ—Ä
- ‚ùå –í–µ–ª–∏–∫–µ —Å–ø–æ–∂–∏–≤–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö —Ñ–æ—Ä–º
- ‚ùå –ü–æ–≥–∞–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –ø—Ä–∏ –±–∞–≥–∞—Ç—å–æ—Ö –ø–æ–ª—è—Ö

### Uncontrolled Components (–ù–µ–∫–µ—Ä–æ–≤–∞–Ω—ñ)

**Uncontrolled component** ‚Äî —Ü–µ —ñ–Ω–ø—É—Ç, —á–∏—î –∑–Ω–∞—á–µ–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è **–≤ —Å–∞–º–æ–º—É DOM**, –∞ React –æ—Ç—Ä–∏–º—É—î –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ **ref**:

```jsx showLineNumbers
import { useRef } from 'react'

function UncontrolledForm() {
    const emailRef = useRef(null)

    const handleSubmit = (e) => {
        e.preventDefault()
        // –ß–∏—Ç–∞—î–º–æ –∑–Ω–∞—á–µ–Ω–Ω—è —Ç—ñ–ª—å–∫–∏ –ø—Ä–∏ submit
        console.log(emailRef.current.value) // –ü—Ä—è–º–∏–π –¥–æ—Å—Ç—É–ø –¥–æ DOM
    }

    // –ù–ï –ü–û–¢–†–Ü–ë–ï–ù useState!
    // –ù–ï –ü–û–¢–†–Ü–ë–ï–ù onChange!
    // –ñ–æ–¥–Ω–∏—Ö —Ä–µ-—Ä–µ–Ω–¥–µ—Ä—ñ–≤ –ø—Ä–∏ –≤–≤–µ–¥–µ–Ω–Ω—ñ!

    return (
        <form onSubmit={handleSubmit}>
            <input ref={emailRef} defaultValue="" />
            <button type="submit">–í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏</button>
        </form>
    )
}
```

**–ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª –∑–º—ñ–Ω–∏ –∑–Ω–∞—á–µ–Ω–Ω—è:**

::mermaid

```mermaid
sequenceDiagram
    participant User as üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á
    participant Input as üìù Input DOM
    participant React as ‚öõÔ∏è React

    User->>Input: –í–≤–æ–¥–∏—Ç—å "a"
    Input->>Input: –û–Ω–æ–≤–ª—é—î –≤–ª–∞—Å–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è

    Note over Input: DOM –∑–±–µ—Ä—ñ–≥–∞—î state
    Note over React: üü¢ –ñ–û–î–ù–ò–• –†–ï-–†–ï–ù–î–ï–†–Ü–í!

    User->>React: Submit —Ñ–æ—Ä–º–∏
    React->>Input: –ß–∏—Ç–∞—î —á–µ—Ä–µ–∑ ref.current.value
```

::

**–ü–µ—Ä–µ–≤–∞–≥–∏ uncontrolled:**

- ‚úÖ –ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–∏
- ‚úÖ –ü—Ä–æ—Å—Ç—ñ—à–∏–π –∫–æ–¥ (–º–µ–Ω—à–µ boilerplate)
- ‚úÖ –®–≤–∏–¥—à–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å

**–ù–µ–¥–æ–ª—ñ–∫–∏ uncontrolled:**

- ‚ùå –°–∫–ª–∞–¥–Ω—ñ—à–µ –∫–µ—Ä—É–≤–∞—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º –ø—Ä–æ–≥—Ä–∞–º–Ω–æ
- ‚ùå –ü–æ—Ç—Ä—ñ–±–Ω—ñ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –∑—É—Å–∏–ª–ª—è –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ
- ‚ùå –ú–µ–Ω—à "React-way" –ø—ñ–¥—Ö—ñ–¥

### –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

| –ú–µ—Ç—Ä–∏–∫–∞                               | Controlled (useState) | Uncontrolled (ref) | React Hook Form |
| :------------------------------------ | :-------------------- | :----------------- | :-------------- |
| **–†–µ–Ω–¥–µ—Ä—ñ–≤ –ø—Ä–∏ –≤–≤–µ–¥–µ–Ω–Ω—ñ 10 —Å–∏–º–≤–æ–ª—ñ–≤** | 10                    | 0                  | 0               |
| **–†–µ–Ω–¥–µ—Ä—ñ–≤ –ø—Ä–∏ –∑–º—ñ–Ω—ñ 20 –ø–æ–ª—ñ–≤**       | 20                    | 0                  | 0-2\*           |
| **–ß–∞—Å –º–æ–Ω—Ç—É–≤–∞–Ω–Ω—è —Ñ–æ—Ä–º–∏ (20 –ø–æ–ª—ñ–≤)**   | ~80ms                 | ~20ms              | ~25ms           |
| **–°–ø–æ–∂–∏–≤–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ**                | –í–∏—Å–æ–∫–µ                | –ù–∏–∑—å–∫–µ             | –ù–∏–∑—å–∫–µ          |

_\*–ó–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `watch()` —Ç–∞ —ñ–Ω—à–∏—Ö –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤_

::tip
**–ó–æ–ª–æ—Ç–µ –ø—Ä–∞–≤–∏–ª–æ**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **controlled**, –∫–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–µ–Ω –º–∏—Ç—Ç—î–≤–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å (–∞–≤—Ç–æ–∫–æ–º–ø–ª—ñ—Ç, –º–∞—Å–∫–∏ –≤–≤–æ–¥—É). –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **uncontrolled** –¥–ª—è —Ñ–æ—Ä–º –∑ –±–∞–≥–∞—Ç—å–º–∞ –ø–æ–ª—è–º–∏, –¥–µ –≤–∞–∂–ª–∏–≤–∞ –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å.
::

---

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ React Hook Form: –ü—ñ–¥ –ö–∞–ø–æ—Ç–æ–º

React Hook Form ‚Äî —Ü–µ –Ω–µ –ø—Ä–æ—Å—Ç–æ "wrapper –¥–ª—è —Ñ–æ—Ä–º", –∞ —Å–∫–ª–∞–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∑ –¥–µ–∫—ñ–ª—å–∫–æ–º–∞ –∫–ª—é—á–æ–≤–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏.

### –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∞ –î—ñ–∞–≥—Ä–∞–º–∞

::mermaid

```mermaid
flowchart TB
    subgraph API["üéØ Public API"]
        useForm["useForm()"]
        register["register()"]
        handleSubmit["handleSubmit()"]
        watch["watch()"]
    end

    subgraph Core["‚öôÔ∏è Core Engine"]
        RefStore["üì¶ Ref Storage"]
        FormState["üìä Form State (Proxy)"]
        Validators["‚úÖ Validation Engine"]
        Subscribers["üîî Subscription System"]
    end

    subgraph DOM["üåê DOM Layer"]
        Inputs["üìù Input Elements"]
    end

    useForm --> RefStore
    useForm --> FormState

    register --> RefStore
    register --> Validators

    handleSubmit --> Validators
    handleSubmit --> RefStore

    watch --> Subscribers

    Inputs -.ref.-> RefStore
    Inputs -.onChange.-> Validators

    FormState -.Proxy.-> Subscribers

    style Core fill:#3b82f6,stroke:#1d4ed8,color:#ffffff
    style API fill:#22c5e,stroke:#15803d,color:#ffffff
    style DOM fill:#f59e0b,stroke:#b45309,color:#ffffff
```

::

### 1. Ref Storage System

**React Hook Form –∑–±–µ—Ä—ñ–≥–∞—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ –≤—Å—ñ —ñ–Ω–ø—É—Ç–∏ –≤ Map-—Å—Ç—Ä—É–∫—Ç—É—Ä—ñ**:

```javascript showLineNumbers
// –°–ø—Ä–æ—â–µ–Ω–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
const fieldsRef = new Map([
    ['email', { ref: inputElement, options: { required: true } }],
    ['password', { ref: inputElement, options: { minLength: 8 } }],
])
```

–ö–æ–ª–∏ –≤–∏ –≤–∏–∫–ª–∏–∫–∞—î—Ç–µ `register('email')`, –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∞:

1. **–°—Ç–≤–æ—Ä—é—î ref callback** –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è DOM –µ–ª–µ–º–µ–Ω—Ç–∞
2. **–ó–±–µ—Ä—ñ–≥–∞—î –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó** –¥–ª—è —Ü—å–æ–≥–æ –ø–æ–ª—è
3. **–ü—ñ–¥–ø–∏—Å—É—î—Ç—å—Å—è –Ω–∞ DOM –ø–æ–¥—ñ—ó** (onChange, onBlur)
4. **–ù–ï –≤–∏–∫–ª–∏–∫–∞—î —Ä–µ-—Ä–µ–Ω–¥–µ—Ä** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

### 2. Proxy Pattern –¥–ª—è formState

–û–¥–Ω–∞ –∑ –Ω–∞–π—Ä–æ–∑—É–º–Ω—ñ—à–∏—Ö —á–∞—Å—Ç–∏–Ω ‚Äî **lazy evaluation formState —á–µ—Ä–µ–∑ Proxy**:

```javascript showLineNumbers
// –°–ø—Ä–æ—â–µ–Ω–∞ —ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—è
const formState = new Proxy(
    {},
    {
        get(target, prop) {
            // –ü—ñ–¥–ø–∏—Å—É—î–º–æ—Å—è —Ç—ñ–ª—å–∫–∏ –Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ!
            subscribe(prop)
            return calculateFormState(prop)
        },
    },
)

// –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
function MyForm() {
    const { formState } = useForm()

    // –¢—ñ–ª—å–∫–∏ 'isDirty' –≤–∏–∫–ª–∏–∫–∞—î –ø—ñ–¥–ø–∏—Å–∫—É!
    console.log(formState.isDirty)

    // 'isValid' –ù–ï –æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è, —è–∫—â–æ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è
    // formState.isValid
}
```

::warning
**–í–∞–∂–ª–∏–≤–æ**: –Ø–∫—â–æ –≤–∏ –Ω–µ —á–∏—Ç–∞—î—Ç–µ `formState` –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ, **–∂–æ–¥–Ω–∏—Ö –æ–±—á–∏—Å–ª–µ–Ω—å –Ω–µ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è**. –¶–µ –≤–µ–ª–∏—á–µ–∑–Ω–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è!
::

### 3. Event Delegation –¥–ª—è –í–∞–ª—ñ–¥–∞—Ü—ñ—ó

–ó–∞–º—ñ—Å—Ç—å –¥–æ–¥–∞–≤–∞–Ω–Ω—è –≤–∞–ª—ñ–¥–∞—Ç–æ—Ä—ñ–≤ –¥–æ –∫–æ–∂–Ω–æ–≥–æ —ñ–Ω–ø—É—Ç—É, React Hook Form –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î **—Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω—É —Å–∏—Å—Ç–µ–º—É**:

```javascript showLineNumbers
// onChange –±—É–¥—å-—è–∫–æ–≥–æ —ñ–Ω–ø—É—Ç—É –≤–µ–¥–µ –¥–æ:
function handleChange(event) {
    const fieldName = event.target.name
    const fieldConfig = fieldsRef.get(fieldName)

    if (shouldValidate(fieldConfig)) {
        validateField(fieldName, event.target.value)
    }

    // –û–Ω–æ–≤–ª—é—î–º–æ —Ç—ñ–ª—å–∫–∏ –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤ –Ω–∞ —Ü–µ –ø–æ–ª–µ
    notifySubscribers(fieldName)
}
```

### –ü–æ–≤–Ω–∏–π –ñ–∏—Ç—Ç—î–≤–∏–π –¶–∏–∫–ª –§–æ—Ä–º–∏

::mermaid

```mermaid
sequenceDiagram
    participant Dev as üë®‚Äçüíª –†–æ–∑—Ä–æ–±–Ω–∏–∫
    participant RHF as ‚öõÔ∏è React Hook Form
    participant DOM as üåê DOM
    participant User as üë§ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á

    Dev->>RHF: useForm()
    RHF->>RHF: –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è RefStore, FormState

    Dev->>RHF: register('email', rules)
    RHF->>DOM: –°—Ç–≤–æ—Ä–∏—Ç–∏ ref callback

    User->>DOM: –í–≤–æ–¥–∏—Ç—å —Ç–µ–∫—Å—Ç
    DOM->>RHF: onChange event
    RHF->>RHF: –í–∞–ª—ñ–¥–∞—Ü—ñ—è (—è–∫—â–æ mode = 'onChange')

    alt –Ñ –ø—ñ–¥–ø–∏—Å–Ω–∏–∫–∏ –Ω–∞ 'email'
        RHF->>Dev: –†–µ-—Ä–µ–Ω–¥–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
    else –ù–µ–º–∞—î –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤
        RHF->>RHF: –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ —Ä–µ–Ω–¥–µ—Ä
    end

    User->>Dev: Submit —Ñ–æ—Ä–º–∏
    Dev->>RHF: handleSubmit(onSubmit)
    RHF->>RHF: –í–∞–ª—ñ–¥–∞—Ü—ñ—è –≤—Å—ñ—Ö –ø–æ–ª—ñ–≤

    alt –§–æ—Ä–º–∞ –≤–∞–ª—ñ–¥–Ω–∞
        RHF->>Dev: onSubmit(data)
    else –Ñ –ø–æ–º–∏–ª–∫–∏
        RHF->>Dev: –†–µ–Ω–¥–µ—Ä –∑ errors
    end
```

::

---

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –ë–∞–∑–æ–≤–µ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

```bash
npm install react-hook-form
```

TypeScript —Ç–∏–ø–∏ –≤–∫–ª—é—á–µ–Ω—ñ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º ‚Äî –¥–æ–¥–∞—Ç–∫–æ–≤–µ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–µ.

### –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è: –î–æ —ñ –ü—ñ—Å–ª—è

–î–ª—è –ø–æ—á–∞—Ç–∫—É, –¥–∞–≤–∞–π—Ç–µ –ø–æ–¥–∏–≤–∏–º–æ—Å—è –Ω–∞ —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–∏–º –ø—ñ–¥—Ö–æ–¥–æ–º —Ç–∞ React Hook Form:

::code-group

```jsx [–ë–µ–∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏]
import { useState } from 'react'

function LoginForm() {
    const [email, setEmail] = useState('')
    const [password, setPassword] = useState('')
    const [errors, setErrors] = useState({})

    const validate = () => {
        const newErrors = {}
        if (!email) newErrors.email = "Email –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π"
        if (!password) newErrors.password = "–ü–∞—Ä–æ–ª—å –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π"
        if (password.length < 8) newErrors.password = '–ú—ñ–Ω—ñ–º—É–º 8 —Å–∏–º–≤–æ–ª—ñ–≤'
        setErrors(newErrors)
        return Object.keys(newErrors).length === 0
    }

    const handleSubmit = (e) => {
        e.preventDefault()
        if (validate()) {
            console.log({ email, password })
        }
    }

    return (
        <form onSubmit={handleSubmit}>
            <input value={email} onChange={(e) => setEmail(e.target.value)} />
            {errors.email && <span>{errors.email}</span>}

            <input type="password" value={password} onChange={(e) => setPassword(e.target.value)} />
            {errors.password && <span>{errors.password}</span>}

            <button type="submit">–£–≤—ñ–π—Ç–∏</button>
        </form>
    )
}
```

```jsx [–ó React Hook Form]
import { useForm } from 'react-hook-form'

function LoginForm() {
    const {
        register,
        handleSubmit,
        formState: { errors },
    } = useForm()

    const onSubmit = (data) => console.log(data)

    return (
        <form onSubmit={handleSubmit(onSubmit)}>
            <input {...register('email', { required: "Email –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π" })} />
            {errors.email && <span>{errors.email.message}</span>}

            <input
                type="password"
                {...register('password', {
                    required: "–ü–∞—Ä–æ–ª—å –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π",
                    minLength: { value: 8, message: '–ú—ñ–Ω—ñ–º—É–º 8 —Å–∏–º–≤–æ–ª—ñ–≤' },
                })}
            />
            {errors.password && <span>{errors.password.message}</span>}

            <button type="submit">–£–≤—ñ–π—Ç–∏</button>
        </form>
    )
}
```

::

**–ö–ª—é—á–æ–≤—ñ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ:**

1. ‚ùå **–ù–µ–º–∞—î** –æ–∫—Ä–µ–º–∏—Ö `useState` –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø–æ–ª—è
2. ‚ùå **–ù–µ–º–∞—î** —Ä—É—á–Ω–∏—Ö `onChange` handlers
3. ‚ùå **–ù–µ–º–∞—î** —Ä—É—á–Ω–æ—ó –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó —Ç–∞ `setErrors`
4. ‚úÖ **–í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–µ–∫–ª–∞—Ä–∞—Ç–∏–≤–Ω–∞** ‚Äî –ø—Ä—è–º–æ –≤ `register`
5. ‚úÖ **–ö–æ–¥ –∫–æ—Ä–æ—Ç—à–∏–π** —Ç–∞ —á–∏—Ç–∞–±–µ–ª—å–Ω—ñ—à–∏–π
6. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è** —Ä–µ-—Ä–µ–Ω–¥–µ—Ä—ñ–≤

### –ü–µ—Ä—à–∏–π –ü—Ä–∏–∫–ª–∞–¥ –∑ –ü–æ—è—Å–Ω–µ–Ω–Ω—è–º

```jsx showLineNumbers
import { useForm } from 'react-hook-form'

function SimpleForm() {
    // 1. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ —Ñ–æ—Ä–º—É
    const {
        register, // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –ø–æ–ª—ñ–≤
        handleSubmit, // Wrapper –¥–ª—è submit handler
        formState: { errors }, // –û–±'—î–∫—Ç –∑ –ø–æ–º–∏–ª–∫–∞–º–∏ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
    } = useForm()

    // 2. Callback, —â–æ –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è –ø—Ä–∏ —É—Å–ø—ñ—à–Ω–æ–º—É submit
    const onSubmit = (data) => {
        console.log(data) // { email: '...', password: '...' }
    }

    return (
        <form onSubmit={handleSubmit(onSubmit)}>
            {/* 3. –†–µ—î—Å—Ç—Ä—É—î–º–æ –ø–æ–ª–µ 'email' –∑ –ø—Ä–∞–≤–∏–ª–∞–º–∏ */}
            <input
                {...register('email', {
                    required: "Email –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π",
                    pattern: {
                        value: /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,
                        message: '–ù–µ–≤–∞–ª—ñ–¥–Ω–∏–π email',
                    },
                })}
            />
            {/* 4. –ü–æ–∫–∞–∑—É—î–º–æ –ø–æ–º–∏–ª–∫—É, —è–∫—â–æ —î */}
            {errors.email && <span>{errors.email.message}</span>}

            <input
                type="password"
                {...register('password', {
                    required: "–ü–∞—Ä–æ–ª—å –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π",
                    minLength: { value: 8, message: '–ú—ñ–Ω—ñ–º—É–º 8 —Å–∏–º–≤–æ–ª—ñ–≤' },
                })}
            />
            {errors.password && <span>{errors.password.message}</span>}

            <button type="submit">–£–≤—ñ–π—Ç–∏</button>
        </form>
    )
}
```

**–©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø—ñ–¥ –∫–∞–ø–æ—Ç–æ–º:**

::steps

### useForm() —Å—Ç–≤–æ—Ä—é—î –≤–Ω—É—Ç—Ä—ñ—à–Ω—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É

–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î—Ç—å—Å—è Map –¥–ª—è refs —Ç–∞ –ø—Ä–∞–≤–∏–ª –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó:

```javascript
{
  refs: new Map(),
  formState: new Proxy(...),
  validators: new Map(),
}
```

### register('email') –ø–æ–≤–µ—Ä—Ç–∞—î props

```javascript
{
  name: 'email',
  ref: [Function],  // Callback –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è DOM –µ–ª–µ–º–µ–Ω—Ç–∞
  onChange: [Function],  // Handler –¥–ª—è –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
  onBlur: [Function],  // Handler –¥–ª—è onBlur –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó
}
```

### Spread –æ–ø–µ—Ä–∞—Ç–æ—Ä –ø–µ—Ä–µ–¥–∞—î props

`{...register('email')}` —Ä–æ–∑–≥–æ—Ä—Ç–∞—î—Ç—å—Å—è —É:

```jsx
<input name="email" ref={...} onChange={...} onBlur={...} />
```

### –ü—Ä–∏ –∑–º—ñ–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è

- DOM –æ–Ω–æ–≤–ª—é—î—Ç—å—Å—è –Ω–∞—Ç–∏–≤–Ω–æ (–±—Ä–∞—É–∑–µ—Ä–æ–º)
- Ref –∑–±–µ—Ä—ñ–≥–∞—î –ø–æ—Å–∏–ª–∞–Ω–Ω—è
- **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –ù–ï —Ä–µ-—Ä–µ–Ω–¥–µ—Ä–∏—Ç—å—Å—è** (—è–∫—â–æ –Ω–µ–º–∞—î –ø—ñ–¥–ø–∏—Å–Ω–∏–∫—ñ–≤)

### –ü—Ä–∏ submit

`handleSubmit` –∑—á–∏—Ç—É—î –≤—Å—ñ –∑–Ω–∞—á–µ–Ω–Ω—è —á–µ—Ä–µ–∑ refs, –≤–∞–ª—ñ–¥—É—î, —ñ —è–∫—â–æ –≤–∞–ª—ñ–¥–Ω–æ ‚Äî –≤–∏–∫–ª–∏–∫

–∞—î `onSubmit(data)`

::
