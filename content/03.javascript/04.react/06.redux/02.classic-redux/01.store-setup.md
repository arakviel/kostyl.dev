# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Store (Classic Redux)

–ú–∏ –ø–æ—á–∏–Ω–∞—î–º–æ –ø—Ä–∞–∫—Ç–∏—á–Ω—É —á–∞—Å—Ç–∏–Ω—É –∑ "–∫–ª–∞—Å–∏—á–Ω–æ–≥–æ" Redux. –¶–µ —Å–∞–º–µ —Ç–æ–π –ø—ñ–¥—Ö—ñ–¥, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤—Å—è –¥–æ 2019 —Ä–æ–∫—É. –•–æ—á–∞ –∑–∞—Ä–∞–∑ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Redux Toolkit, —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Ç–æ–≥–æ, —è–∫ –ø—Ä–∞—Ü—é—î `createStore`, —î –∫—Ä–∏—Ç–∏—á–Ω–∏–º –¥–ª—è —Ä–æ–∑—É–º—ñ–Ω–Ω—è —Å–∞–º–æ—ó —Å—É—Ç—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏.

::alert{type="warning"}
–í–∏ –º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏, —â–æ –º–µ—Ç–æ–¥–∏ `createStore` –≤ –æ—Ñ—ñ—Ü—ñ–π–Ω—ñ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó –ø–æ–∑–Ω–∞—á–µ–Ω—ñ —è–∫ **deprecated**. –ù–µ –ª—è–∫–∞–π—Ç–µ—Å—è. –í–æ–Ω–∏ –Ω–µ –≤–∏–¥–∞–ª–µ–Ω—ñ, –ø—Ä–æ—Å—Ç–æ –∫–æ–º–∞–Ω–¥–∞ Redux –Ω–∞–ø–æ–ª–µ–≥–ª–∏–≤–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Toolkit. –ê–ª–µ –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è –º–∏ –ø–æ—á–Ω–µ–º–æ —Å–∞–º–µ –∑ "–±–∞–∑–∏".
::

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

–î–ª—è –ø–æ—á–∞—Ç–∫—É –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–µ–Ω –ª–∏—à–µ –ø–∞–∫–µ—Ç `redux`. –ú–∏ –ø–æ–∫–∏ —â–æ –Ω–µ –ø—ñ–¥–∫–ª—é—á–∞—î–º–æ React.

```bash
npm install redux
```

## –ê–Ω–∞—Ç–æ–º—ñ—è Store

–£—è–≤—ñ—Ç—å, —â–æ –≤–∏ —Å—Ç–≤–æ—Ä—é—î—Ç–µ –∑–≤–∏—á–∞–π–Ω–∏–π JavaScript —Ñ–∞–π–ª `store.js`. –ù–∞—à–µ –∑–∞–≤–¥–∞–Ω–Ω—è ‚Äî —Å—Ç–≤–æ—Ä–∏—Ç–∏ –æ–±'—î–∫—Ç, —è–∫–∏–π –±—É–¥–µ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —á–∏—Å–ª–æ (–ª—ñ—á–∏–ª—å–Ω–∏–∫).

### 1. –ü–æ—á–∞—Ç–∫–æ–≤–∏–π —Å—Ç–∞–Ω (Initial State)

–°–ø–æ—á–∞—Ç–∫—É –≤–∏–∑–Ω–∞—á–∏–º–æ, –∑ —á–æ–≥–æ –º–∏ –ø–æ—á–∏–Ω–∞—î–º–æ.

```javascript
const initialState = {
  value: 0
};
```

### 2. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Reducer

–†–µ–¥—é—Å–µ—Ä ‚Äî —Ü–µ —Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –ø—Ä–∏–π–º–∞—î —Ä—ñ—à–µ–Ω–Ω—è, —è–∫ –∑–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞–Ω.

```javascript
// (state, action) => newState
function counterReducer(state = initialState, action) {
  // –ú–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ "—Ç–∏–ø" –¥—ñ—ó
  if (action.type === 'counter/increment') {
    // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –ù–û–í–ò–ô –æ–±'—î–∫—Ç —Å—Ç–∞–Ω—É
    return { ...state, value: state.value + 1 };
  }
  
  if (action.type === 'counter/decrement') {
    return { ...state, value: state.value - 1 };
  }

  // –î—É–∂–µ –≤–∞–∂–ª–∏–≤–æ! –Ø–∫—â–æ –¥—ñ—è –Ω–∞–º –Ω–µ–≤—ñ–¥–æ–º–∞, –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ —Å—Ç–∞—Ä–∏–π —Å—Ç–∞–Ω –±–µ–∑ –∑–º—ñ–Ω.
  return state; 
}
```

::tip
–ó–≤–µ—Ä–Ω—ñ—Ç—å —É–≤–∞–≥—É –Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º `state = initialState`. –ö–æ–ª–∏ Redux –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è –≤–ø–µ—Ä—à–µ, –≤—ñ–Ω –ø–µ—Ä–µ–¥–∞—î –≤ —Ä–µ–¥—é—Å–µ—Ä `undefined` –∑–∞–º—ñ—Å—Ç—å —Å—Ç–µ–π—Ç–∞. –¶–µ–π –ø–∞—Ä–∞–º–µ—Ç—Ä –≥–∞—Ä–∞–Ω—Ç—É—î, —â–æ —É –Ω–∞—Å –±—É–¥–µ –ø–æ—á–∞—Ç–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è.
::

### 3. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è Store

–¢–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é `createStore` –∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ `redux`.

```javascript
import { createStore } from 'redux';

const store = createStore(counterReducer);

export default store;
```

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è Store (Vanilla JS)

–©–æ–± –¥–æ–≤–µ—Å—Ç–∏, —â–æ Redux –Ω–µ –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π –¥–æ React, –¥–∞–≤–∞–π—Ç–µ –ø–æ–¥–∏–≤–∏–º–æ—Å—è, —è–∫ –∑ –Ω–∏–º –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ —É –∑–≤–∏—á–∞–π–Ω–æ–º—É JS —Å–∫—Ä–∏–ø—Ç—ñ.

–£ –æ–±'—î–∫—Ç–∞ `store` —î 3 –≥–æ–ª–æ–≤–Ω—ñ –º–µ—Ç–æ–¥–∏:

### `getState()`

–ü–æ–≤–µ—Ä—Ç–∞—î –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω.

```javascript
console.log(store.getState()); 
// Output: { value: 0 }
```

### `dispatch(action)`

–í—ñ–¥–ø—Ä–∞–≤–ª—è—î –¥—ñ—é –¥–ª—è –∑–º—ñ–Ω–∏ —Å—Ç–∞–Ω—É.

```javascript
store.dispatch({ type: 'counter/increment' });

console.log(store.getState());
// Output: { value: 1 }
```

### `subscribe(listener)`

–î–æ–∑–≤–æ–ª—è—î –ø—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è –Ω–∞ –∑–º—ñ–Ω–∏. –§—É–Ω–∫—Ü—ñ—è-—Å–ª—É—Ö–∞—á –±—É–¥–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏—Å—è —â–æ—Ä–∞–∑—É, –∫–æ–ª–∏ action –±—É–≤ –æ–±—Ä–æ–±–ª–µ–Ω–∏–π (dispatch –∑–∞–≤–µ—Ä—à–∏–≤—Å—è).

```javascript
const unsubscribe = store.subscribe(() => {
  console.log('–°—Ç–∞–Ω –∑–º—ñ–Ω–∏–≤—Å—è!', store.getState());
});

store.dispatch({ type: 'counter/increment' });
// Logs: "–°—Ç–∞–Ω –∑–º—ñ–Ω–∏–≤—Å—è! { value: 2 }"

store.dispatch({ type: 'counter/decrement' });
// Logs: "–°—Ç–∞–Ω –∑–º—ñ–Ω–∏–≤—Å—è! { value: 1 }"

// –í—ñ–¥–ø–∏—Å–∞—Ç–∏—Å—è
unsubscribe();
```

## –ü–æ–≤–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥ –∫–æ–¥—É

–ó–±–µ—Ä–µ–º–æ –≤—Å–µ —Ä–∞–∑–æ–º:

::code-group
```javascript [store.js]
import { createStore } from 'redux';

const initialState = { value: 0 };

function counterReducer(state = initialState, action) {
  switch (action.type) {
    case 'counter/increment':
      return { ...state, value: state.value + 1 };
    case 'counter/decrement':
      return { ...state, value: state.value - 1 };
    default:
      return state;
  }
}

const store = createStore(counterReducer);

export default store;
```

```javascript [index.js]
import store from './store';

// UI –µ–ª–µ–º–µ–Ω—Ç–∏
const valueEl = document.getElementById('value');
const btnInc = document.getElementById('increment');
const btnDec = document.getElementById('decrement');

// 1. –§—É–Ω–∫—Ü—ñ—è —Ä–µ–Ω–¥–µ—Ä—É UI –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Å—Ç–∞–Ω—É
function render() {
  const state = store.getState();
  valueEl.innerHTML = state.value.toString();
}

// 2. –ü—ñ–¥–ø–∏—Å—É—î–º–æ—Å—å –Ω–∞ –∑–º—ñ–Ω–∏ (render –±—É–¥–µ –≤–∏–∫–ª–∏–∫–∞—Ç–∏—Å—å –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É dispatch)
render(); // –ü–µ—Ä—à–∏–π —Ä–µ–Ω–¥–µ—Ä
store.subscribe(render);

// 3. –û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ–π UI -> Dispatch Action
btnInc.addEventListener('click', () => {
  store.dispatch({ type: 'counter/increment' });
});

btnDec.addEventListener('click', () => {
  store.dispatch({ type: 'counter/decrement' });
});
```
::

–¶–µ –≤—Å–µ! –¶–µ —ñ —î —è–¥—Ä–æ Redux. –£—Å–µ —ñ–Ω—à–µ (React-Redux, Middleware, Toolkit) ‚Äî —Ü–µ –Ω–∞–¥–±—É–¥–æ–≤–∏ –Ω–∞–¥ —Ü–∏–º –ø—Ä–æ—Å—Ç–∏–º –ø–∞—Ç–µ—Ä–Ω–æ–º: `Action -> Dispatch -> Reducer -> Store -> Subscribe`.

–î–∞–ª—ñ –º–∏ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ, —è–∫ —Å—Ç—Ä—É–∫—Ç—É—Ä—É–≤–∞—Ç–∏ –∫–æ–¥ –ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–æ, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ Actions Constants —Ç–∞ Creators.

üëâ [–î–∞–ª—ñ: Actions —Ç–∞ Action Creators](./02.actions-constants.md)
