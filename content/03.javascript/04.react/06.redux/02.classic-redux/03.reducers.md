# –õ–æ–≥—ñ–∫–∞ Reducers

–ú–∏ –≤–∂–µ –∑–Ω–∞—î–º–æ, —â–æ —Ä–µ–¥—é—Å–µ—Ä ‚Äî —Ü–µ —á–∏—Å—Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—è `(state, action) => newState`. –ê–ª–µ —è–∫ –ø–∏—Å–∞—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ —Ä–µ–¥—é—Å–µ—Ä–∏, –∫–æ–ª–∏ —Å—Ç–∞–Ω ‚Äî —Ü–µ –Ω–µ –ø—Ä–æ—Å—Ç–æ –æ–¥–Ω–µ —á–∏—Å–ª–æ, –∞ —Å–∫–ª–∞–¥–Ω–∏–π –æ–±'—î–∫—Ç?

## –ü—Ä–æ—î–∫—Ç—É–≤–∞–Ω–Ω—è –°—Ç—Ä—É–∫—Ç—É—Ä–∏ –°—Ç–∞–Ω—É (State Shape)

–ü–µ—Ä–µ–¥ —Ç–∏–º —è–∫ –ø–∏—Å–∞—Ç–∏ –∫–æ–¥, –≤–∞—Ä—Ç–æ –ø–æ–¥—É–º–∞—Ç–∏ –ø—Ä–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–∏—Ö.

**–ü–æ–≥–∞–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥:**
```javascript
const initialState = {
  isModalOpen: false,
  userName: 'Ivan',
  todos: [],
  // –í—Å–µ –Ω–∞ –∫—É–ø—É
  filter: 'all',
  loading: false
};
```

**–•–æ—Ä–æ—à–∏–π –ø—Ä–∏–∫–ª–∞–¥ (–ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –∑–∞ –¥–æ–º–µ–Ω–∞–º–∏):**
```javascript
const initialState = {
  ui: {
    isModalOpen: false,
    theme: 'dark'
  },
  users: {
    currentUser: { name: 'Ivan' },
    loading: false
  },
  todos: {
    items: [],
    filter: 'all'
  }
};
```

–£ —Ü—å–æ–º—É —É—Ä–æ—Ü—ñ –º–∏ –∑–æ—Å–µ—Ä–µ–¥–∏–º–æ—Å—è –Ω–∞ —Ç–æ–º—É, —è–∫ —Ä–µ–¥—é—Å–µ—Ä –æ–±—Ä–æ–±–ª—è—î –æ–¥–Ω—É —á–∞—Å—Ç–∏–Ω—É —Ü—å–æ–≥–æ —Å—Ç–∞–Ω—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `todos`).

## –ü–∞—Ç–µ—Ä–Ω–∏ –æ–±—Ä–æ–±–∫–∏ Actions

–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –ø–∞—Ç–µ—Ä–Ω ‚Äî —Ü–µ `switch` statement.

```javascript
const initialState = [];

function todosReducer(state = initialState, action) {
  switch (action.type) {
    case 'ADD_TODO':
      // –õ–æ–≥—ñ–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è
      return [...state, action.payload];
      
    case 'TOGGLE_TODO':
      // –õ–æ–≥—ñ–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
      return state.map(todo => {
        if (todo.id !== action.payload) return todo;
        return { ...todo, completed: !todo.completed };
      });
      
    case 'REMOVE_TODO':
      // –õ–æ–≥—ñ–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è
      return state.filter(todo => todo.id !== action.payload);

    default:
      // –ó–∞–≤–∂–¥–∏ –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω, —è–∫—â–æ action –Ω–µ –Ω–∞—à!
      return state;
  }
}
```

### –ß–æ–º—É `switch`, –∞ –Ω–µ `if/else`?

–¢–µ—Ö–Ω—ñ—á–Ω–æ —Ä—ñ–∑–Ω–∏—Ü—ñ –Ω–µ–º–∞—î. –ê–ª–µ `switch` —î –∑–∞–≥–∞–ª—å–Ω–æ–ø—Ä–∏–π–Ω—è—Ç–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–æ–º —É —Å–ø—ñ–ª—å–Ω–æ—Ç—ñ Redux, –æ—Å–∫—ñ–ª—å–∫–∏ –≤—ñ–Ω —á–∏—Ç–∞–±–µ–ª—å–Ω—ñ—à–∏–π, –∫–æ–ª–∏ –∫–µ–π—Å—ñ–≤ –±–∞–≥–∞—Ç–æ.

### –û–±—Ä–æ–±–∫–∞ –æ–¥–Ω–æ–≥–æ Action —Ä—ñ–∑–Ω–∏–º–∏ Reducers

–¶–µ –æ–¥–Ω–∞ –∑ –Ω–∞–π–ø–æ—Ç—É–∂–Ω—ñ—à–∏—Ö –º–æ–∂–ª–∏–≤–æ—Å—Ç–µ–π Redux. **–û–¥–∏–Ω Action –º–æ–∂–µ –±—É—Ç–∏ –æ–±—Ä–æ–±–ª–µ–Ω–∏–π –¥–µ–∫—ñ–ª—å–∫–æ–º–∞ –†–µ–¥—é—Å–µ—Ä–∞–º–∏ –æ–¥–Ω–æ—á–∞—Å–Ω–æ!**

–£—è–≤—ñ—Ç—å action `LOGOUT`.
-   `usersReducer` –ø–æ–≤–∏–Ω–µ–Ω –æ—á–∏—Å—Ç–∏—Ç–∏ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞.
-   `todosReducer` –ø–æ–≤–∏–Ω–µ–Ω –æ—á–∏—Å—Ç–∏—Ç–∏ —Å–ø–∏—Å–æ–∫ –∑–∞–≤–¥–∞–Ω—å.
-   `uiReducer` –ø–æ–≤–∏–Ω–µ–Ω —Å–∫–∏–Ω—É—Ç–∏ —Ç–µ–º—É –Ω–∞ –¥–µ—Ñ–æ–ª—Ç–Ω—É.

–í–∞–º –Ω–µ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥—ñ—Å–ø–∞—Ç—á–∏—Ç–∏ 3 —Ä—ñ–∑–Ω—ñ –µ–∫—à–µ–Ω–∏ (`USER_LOGOUT`, `TODOS_CLEAR`, `UI_RESET`). –í–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç–µ **–æ–¥–∏–Ω** action `LOGOUT`, —ñ –∫–æ–∂–µ–Ω —Ä–µ–¥—é—Å–µ—Ä —Ä–µ–∞–≥—É—î –Ω–∞ –Ω—å–æ–≥–æ –ø–æ-—Å–≤–æ—î–º—É.

```javascript
// todosReducer.js
case 'LOGOUT':
  return []; // –û—á–∏—â–∞—î–º–æ —Ç—É–¥—É—à–∫–∏

// usersReducer.js
case 'LOGOUT':
  return null; // –í–∏–¥–∞–ª—è—î–º–æ —é–∑–µ—Ä–∞
```

–¶–µ —Ä–æ–±–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –Ω–µ–∑–∞–ª–µ–∂–Ω–∏–º–∏ –≤—ñ–¥ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ —Å—Ç–æ—Ä—É. –ö–Ω–æ–ø–∫–∞ "–í–∏—Ö—ñ–¥" –ø—Ä–æ—Å—Ç–æ –∫–∞–∂–µ "–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –≤–∏–π—à–æ–≤", –∞ —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ –∑–Ω–∞—î, —â–æ —Ç—Ä–µ–±–∞ –ø–æ—á–∏—Å—Ç–∏—Ç–∏.

## –°–∫–ª–∞–¥–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è (Nested Data)

–Ø–∫ –º–∏ –≥–æ–≤–æ—Ä–∏–ª–∏ —Ä–∞–Ω—ñ—à–µ, –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≥–ª–∏–±–æ–∫–æ –≤–∫–ª–∞–¥–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö ‚Äî —Ü–µ –ø–µ–∫–ª–æ –≤ –∫–ª–∞—Å–∏—á–Ω–æ–º—É Redux.

```javascript
case 'UPDATE_SUBTASK':
  return {
    ...state,
    items: state.items.map(item => {
      if (item.id !== action.payload.itemId) return item;
      return {
        ...item,
        subtasks: item.subtasks.map(subtask => {
           if (subtask.id !== action.payload.subtaskId) return subtask;
           return { ...subtask, completed: true };
        })
      };
    })
  };
```

–¶–µ –∂–∞—Ö–ª–∏–≤–æ —á–∏—Ç–∞—î—Ç—å—Å—è —ñ –ª–µ–≥–∫–æ –¥–æ–ø—É—Å–∫–∞—é—Ç—å—Å—è –ø–æ–º–∏–ª–∫–∏.

**–ü–æ—Ä–∞–¥–∞ –¥–ª—è –∫–ª–∞—Å–∏—á–Ω–æ–≥–æ Redux**: –ù–∞–º–∞–≥–∞–π—Ç–µ—Å—è —Ç—Ä–∏–º–∞—Ç–∏ —Å—Ç–∞–Ω –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ "–ø–ª–∞—Å–∫–∏–º" (Flat). –£–Ω–∏–∫–∞–π—Ç–µ –≥–ª–∏–±–æ–∫–æ—ó –≤–∫–ª–∞–¥–µ–Ω–æ—Å—Ç—ñ.

–Ø–∫—â–æ –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ –∑–≤'—è–∑–∫–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–æ—Å—Ç–∏ —ñ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ), –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **–ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—é –¥–∞–Ω–∏—Ö** (–∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –¥–∞–Ω—ñ —è–∫ —É –±–∞–∑—ñ –¥–∞–Ω–∏—Ö, —á–µ—Ä–µ–∑ ID, –∞ –Ω–µ –≤–∫–ª–∞–¥–µ–Ω–∏–º–∏ –º–∞—Å–∏–≤–∞–º–∏).

::alert{type="info"}
Redux Toolkit –≤–∏—Ä—ñ—à—É—î –ø—Ä–æ–±–ª–µ–º—É –≤–∫–ª–∞–¥–µ–Ω–æ—Å—Ç—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Immer, –¥–æ–∑–≤–æ–ª—è—é—á–∏ –ø–∏—Å–∞—Ç–∏ `item.subtasks[0].completed = true`. –ê–ª–µ –≤ –∫–ª–∞—Å–∏—á–Ω–æ–º—É Redux –≤–∏ *–∑–æ–±–æ–≤'—è–∑–∞–Ω—ñ* —Å—Ç—Ä–∞–∂–¥–∞—Ç–∏ (–∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —É—Ç–∏–ª—ñ—Ç–∏ –¥–ª—è —ñ–º–º—É—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ).
::

–î–∞–ª—ñ –º–∏ —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ, —è–∫ —Ä–æ–∑–±–∏–≤–∞—Ç–∏ –æ–¥–∏–Ω –≤–µ–ª–∏–∫–∏–π —Ä–µ–¥—é—Å–µ—Ä –Ω–∞ –±–∞–≥–∞—Ç–æ –º–∞–ª–µ–Ω—å–∫–∏—Ö.

üëâ [–î–∞–ª—ñ: –ö–æ–º–±—ñ–Ω—É–≤–∞–Ω–Ω—è Reducers](./04.data-flow.md)
