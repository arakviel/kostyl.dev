# –°–µ–ª–µ–∫—Ç–æ—Ä–∏ —Ç–∞ –ú–µ–º–æ—ñ–∑–∞—Ü—ñ—è (Reselect)

–ú–∏ –≤–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ –ø—Ä–æ—Å—Ç—ñ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ —Ç–∏–ø—É `state => state.value`. –ê–ª–µ —â–æ, —è–∫ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑—Ä–æ–±–∏—Ç–∏ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –¥–∞–Ω–∏—Ö?

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –∑–∞–≤–¥–∞–Ω—å.

```javascript
const filteredTodos = useSelector(state => {
  console.log('Calculating...');
  return state.todos.filter(t => t.completed === state.filter);
});
```

**–ü—Ä–æ–±–ª–µ–º–∞**: –¶—è —Ñ—É–Ω–∫—Ü—ñ—è –±—É–¥–µ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏—Å—è **–ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É —Ä–µ–Ω–¥–µ—Ä—ñ** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –∞–±–æ –ø—Ä–∏ –∫–æ–∂–Ω—ñ–π –∑–º—ñ–Ω—ñ *–±—É–¥—å-—è–∫–æ—ó* —á–∞—Å—Ç–∏–Ω–∏ Redux —Å—Ç–æ—Ä—É. –Ø–∫—â–æ —Å–ø–∏—Å–æ–∫ –≤–µ–ª–∏–∫–∏–π, —Ü–µ "–≤–±'—î" –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å.

–ë—ñ–ª—å—à–µ —Ç–æ–≥–æ, –æ—Å–∫—ñ–ª—å–∫–∏ `.filter()` –ø–æ–≤–µ—Ä—Ç–∞—î **–Ω–æ–≤–∏–π –º–∞—Å–∏–≤**, React –±—É–¥–µ –¥—É–º–∞—Ç–∏, —â–æ –¥–∞–Ω—ñ –∑–º—ñ–Ω–∏–ª–∏—Å—è, —ñ —Ä–æ–±–∏—Ç–∏–º–µ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó —Ç–æ–π —Å–∞–º–∏–π.

## createSelector

–†—ñ—à–µ–Ω–Ω—è ‚Äî **–ú–µ–º–æ—ñ–∑–∞—Ü—ñ—è**. –¶–µ –∑–∞–ø–∞–º'—è—Ç–æ–≤—É–≤–∞–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –ø–µ–≤–Ω–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤.

Redux Toolkit –µ–∫—Å–ø–æ—Ä—Ç—É—î —Ñ—É–Ω–∫—Ü—ñ—é `createSelector` (–∑ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Reselect).

```javascript
import { createSelector } from '@reduxjs/toolkit';

// –í—Ö—ñ–¥–Ω—ñ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏ (Input Selectors)
// –í–æ–Ω–∏ –ø—Ä–æ—Å—Ç–æ –¥—ñ—Å—Ç–∞—é—Ç—å –¥–∞–Ω—ñ –∑—ñ —Å—Ç–∞–Ω—É
const selectTodos = state => state.todos.items;
const selectFilter = state => state.todos.filter;

// –ú–µ–º–æ—ñ–∑–æ–≤–∞–Ω–∏–π —Å–µ–ª–µ–∫—Ç–æ—Ä
export const selectFilteredTodos = createSelector(
  [selectTodos, selectFilter], // –ú–∞—Å–∏–≤ –≤—Ö—ñ–¥–Ω–∏—Ö —Å–µ–ª–µ–∫—Ç–æ—Ä—ñ–≤
  (todos, filter) => {         // –§—É–Ω–∫—Ü—ñ—è-–ø–µ—Ä–µ—Ç–≤–æ—Ä—é–≤–∞—á
    console.log('Calculating...'); 
    // –¶–µ–π –∫–æ–¥ –≤–∏–∫–æ–Ω–∞—î—Ç—å—Å—è –¢–Ü–õ–¨–ö–ò —è–∫—â–æ –∑–º—ñ–Ω–∏—Ç—å—Å—è todos –ê–ë–û filter
    
    if (filter === 'all') return todos;
    if (filter === 'completed') return todos.filter(t => t.completed);
    return todos.filter(t => !t.completed);
  }
);
```

### –Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î?

1.  `createSelector` –≤–∏–∫–ª–∏–∫–∞—î –≤—Ö—ñ–¥–Ω—ñ —Å–µ–ª–µ–∫—Ç–æ—Ä–∏.
2.  –í—ñ–Ω –ø–æ—Ä—ñ–≤–Ω—é—î —ó—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–º–∏ (—á–µ—Ä–µ–∑ `===`).
3.  –Ø–∫—â–æ –≤—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ –Ω–µ –∑–º—ñ–Ω–∏–ª–∏—Å—è -> –≤—ñ–Ω –ø–æ–≤–µ—Ä—Ç–∞—î –∑–±–µ—Ä–µ–∂–µ–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç **–±–µ–∑ –≤–∏–∫–ª–∏–∫—É** —Ñ—É–Ω–∫—Ü—ñ—ó-–ø–µ—Ä–µ—Ç–≤–æ—Ä—é–≤–∞—á–∞.
4.  –Ø–∫—â–æ –∑–º—ñ–Ω–∏–ª–∏—Å—è -> –≤–∏–∫–ª–∏–∫–∞—î —Ñ—É–Ω–∫—Ü—ñ—é, –∑–±–µ—Ä—ñ–≥–∞—î –Ω–æ–≤–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ñ –ø–æ–≤–µ—Ä—Ç–∞—î –π–æ–≥–æ.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```jsx
import { useSelector } from 'react-redux';
import { selectFilteredTodos } from './todosSlice';

const TodoList = () => {
  const todos = useSelector(selectFilteredTodos);
  // ...
};
```

–¢–µ–ø–µ—Ä, —è–∫—â–æ –º–∏ –∑–º—ñ–Ω–∏–º–æ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (—ñ–Ω—à–∏–π —Å–ª–∞–π—Å), `selectTodos` —ñ `selectFilter` –ø–æ–≤–µ—Ä–Ω—É—Ç—å —Ç—ñ —Å–∞–º—ñ –æ–±'—î–∫—Ç–∏. `createSelector` –ø–æ–±–∞—á–∏—Ç—å —Ü–µ —ñ –Ω–µ –±—É–¥–µ –∑–∞–ø—É—Å–∫–∞—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é. –ü—Ä–æ—Ñ—ñ—Ç!

## –°–µ–ª–µ–∫—Ç–æ—Ä–∏ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

–Ü–Ω–æ–¥—ñ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç–∏ –∞—Ä–≥—É–º–µ–Ω—Ç —É —Å–µ–ª–µ–∫—Ç–æ—Ä (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, ID).

```javascript
export const selectTodoById = createSelector(
  [
    state => state.todos.items,
    (state, userId) => userId // –î—Ä—É–≥–∏–π –∞—Ä–≥—É–º–µ–Ω—Ç
  ],
  (todos, userId) => todos.filter(todo => todo.userId === userId)
);
```

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
```javascript
const userTodos = useSelector(state => selectTodoById(state, props.userId));
```

::alert{type="warning"}
**–£–≤–∞–≥–∞**: –°–µ–ª–µ–∫—Ç–æ—Ä–∏ –∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –º–∞—é—Ç—å –∫–µ—à —Ä–æ–∑–º—ñ—Ä–æ–º 1. –Ø–∫—â–æ –≤–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –æ–¥–∏–Ω —ñ —Ç–æ–π —Å–∞–º–∏–π —Å–µ–ª–µ–∫—Ç–æ—Ä —É –±–∞–≥–∞—Ç—å–æ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –∑ *—Ä—ñ–∑–Ω–∏–º–∏* –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏, –º–µ–º–æ—ñ–∑–∞—Ü—ñ—è –Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏–º–µ –∫–æ—Ä–µ–∫—Ç–Ω–æ. –î–ª—è —Ç–∞–∫–∏—Ö –≤–∏–ø–∞–¥–∫—ñ–≤ —Ç—Ä–µ–±–∞ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ "—Ñ–∞–±—Ä–∏–∫–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä—ñ–≤" (useMemo), –∞–ª–µ —Ü–µ –≤–∂–µ —Ç–µ–º–∞ –¥–ª—è –æ–∫—Ä–µ–º–æ—ó —Å—Ç–∞—Ç—Ç—ñ.
::

---

–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è ‚Äî —Ü–µ –¥–æ–±—Ä–µ, –∞–ª–µ —â–µ –∫—Ä–∞—â–µ ‚Äî –Ω–µ –ø–∏—Å–∞—Ç–∏ –∫–æ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –≤—Ä—É—á–Ω—É –≤–∑–∞–≥–∞–ª—ñ. –ó—É—Å—Ç—Ä—ñ—á–∞–π—Ç–µ RTK Query.

üëâ [–î–∞–ª—ñ: –í—Å—Ç—É–ø –¥–æ RTK Query](./02.rtk-query-intro.md)
