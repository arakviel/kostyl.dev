# –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤ (Integration)

–ö–æ–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `useSelector` –∞–±–æ `useDispatch`, –º–∏ –Ω–µ –º–æ–∂–µ–º–æ –ø—Ä–æ—Å—Ç–æ –≤—ñ–¥—Ä–µ–Ω–¥–µ—Ä–∏—Ç–∏ –π–æ–≥–æ –≤ —Ç–µ—Å—Ç—ñ. –í—ñ–Ω –≤–ø–∞–¥–µ –∑ –ø–æ–º–∏–ª–∫–æ—é `could not find react-redux context value`.

–ù–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–±–≥–æ—Ä–Ω—É—Ç–∏ –π–æ–≥–æ –≤ `<Provider>`.

## –£—Ç–∏–ª—ñ—Ç–∞ `renderWithProviders`

–†–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é-–æ–±–≥–æ—Ä—Ç–∫—É –Ω–∞–¥ `render` –∑ React Testing Library.

```javascript [src/utils/test-utils.jsx]
import React from 'react';
import { render } from '@testing-library/react';
import { configureStore } from '@reduxjs/toolkit';
import { Provider } from 'react-redux';
import userReducer from '../features/user/userSlice';

export function renderWithProviders(
  ui,
  {
    preloadedState = {},
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Å—Ç–≤–æ—Ä—é—î–º–æ store, —è–∫—â–æ –π–æ–≥–æ –Ω–µ –ø–µ—Ä–µ–¥–∞–ª–∏
    store = configureStore({ reducer: { user: userReducer }, preloadedState }),
    ...renderOptions
  } = {}
) {
  function Wrapper({ children }) {
    return <Provider store={store}>{children}</Provider>;
  }

  // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ –æ–±'—î–∫—Ç store —Ä–∞–∑–æ–º –∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ render
  return { store, ...render(ui, { wrapper: Wrapper, ...renderOptions }) };
}
```

## –¢–µ—Å—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

–¢–µ–ø–µ—Ä –º–∏ –º–æ–∂–µ–º–æ –ø–∏—Å–∞—Ç–∏ —Ç–µ—Å—Ç–∏ –¥—É–∂–µ –ª–µ–≥–∫–æ.

```jsx [features/user/UserProfile.test.jsx]
import { screen, fireEvent } from '@testing-library/react';
import { renderWithProviders } from '../../utils/test-utils';
import UserProfile from './UserProfile';

test('renders user name from state', () => {
  // 1. –†–µ–Ω–¥–µ—Ä–∏–º–æ –∑ –ø–æ—á–∞—Ç–∫–æ–≤–∏–º —Å—Ç–∞–Ω–æ–º
  renderWithProviders(<UserProfile />, {
    preloadedState: {
      user: { name: 'Ivan', age: 25 }
    }
  });

  // 2. –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ —ñ–º'—è –Ω–∞ –µ–∫—Ä–∞–Ω—ñ
  expect(screen.getByText(/Ivan/i)).toBeInTheDocument();
});

test('updates name on button click', () => {
  const { store } = renderWithProviders(<UserProfile />, {
    preloadedState: { user: { name: 'Old Name' } }
  });

  // –ö–ª—ñ–∫–∞—î–º–æ –∫–Ω–æ–ø–∫—É
  fireEvent.click(screen.getByText(/Change Name/i));

  // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —â–æ –≤ —Å—Ç–æ—Ä—ñ –∑–º—ñ–Ω–∏–ª–∏—Å—è –¥–∞–Ω—ñ
  expect(store.getState().user.name).toBe('New Name');
  
  // –ê–±–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ UI, —è–∫—â–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–µ–∞–≥—É—î –Ω–∞ –∑–º—ñ–Ω–∏
  expect(screen.getByText(/New Name/i)).toBeInTheDocument();
});
```

–¶–µ–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ–∑–≤–æ–ª—è—î —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∑ Redux –ª–æ–≥—ñ–∫–æ—é. –í–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—Ç–µ —Ä–µ–∞–ª—å–Ω—É –ø–æ–≤–µ–¥—ñ–Ω–∫—É: "–Ø –Ω–∞—Ç–∏—Å–Ω—É–≤ –∫–Ω–æ–ø–∫—É -> –°—Ç–æ—Ä –æ–Ω–æ–≤–∏–≤—Å—è -> UI –æ–Ω–æ–≤–∏–≤—Å—è".

üëâ [–î–∞–ª—ñ: –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è Thunks —Ç–∞ API](./05.testing-thunks.md)
