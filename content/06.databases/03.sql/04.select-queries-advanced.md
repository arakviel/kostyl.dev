---
title: SELECT –∑–∞–ø–∏—Ç–∏ - –†–æ–∑—à–∏—Ä–µ–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ
description: –†–æ–∑—à–∏—Ä–µ–Ω—ñ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏ SELECT - IN, BETWEEN, LIKE –∑ wildcards, —Ñ—É–Ω–∫—Ü—ñ—ó –¥–∞—Ç —Ç–∞ —Ä—è–¥–∫—ñ–≤, —Å–∫–ª–∞–¥–Ω—ñ —É–º–æ–≤–∏ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó
---

# SELECT –∑–∞–ø–∏—Ç–∏ - –†–æ–∑—à–∏—Ä–µ–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

## –í—ñ–¥ –±–∞–∑–æ–≤–∏—Ö –¥–æ —Å–∫–ª–∞–¥–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤

–£ –ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π —Ç–µ–º—ñ –º–∏ –≤–∏–≤—á–∏–ª–∏ –æ—Å–Ω–æ–≤–∏ SELECT. –¢–µ–ø–µ—Ä —Ä–æ–∑–≥–ª—è–Ω–µ–º–æ **—Ä–æ–∑—à–∏—Ä–µ–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ** –¥–ª—è –±—ñ–ª—å—à –≥–Ω—É—á–∫–æ—ó —Ç–∞ –ø–æ—Ç—É–∂–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞–Ω–∏–º–∏.

::mermaid

```mermaid
mindmap
root((SELECT<br/>–†–æ–∑—à–∏—Ä–µ–Ω—ñ))
IN
["–°–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω—å"]
["–ü—ñ–¥–∑–∞–ø–∏—Ç–∏"]
BETWEEN
["–î—ñ–∞–ø–∞–∑–æ–Ω–∏ —á–∏—Å–µ–ª"]
["–î—ñ–∞–ø–∞–∑–æ–Ω–∏ –¥–∞—Ç"]
LIKE
["% wildcards"]
["_ wildcards"]
["[] wildcards"]
–§—É–Ω–∫—Ü—ñ—ó*–¥–∞—Ç
["YEAR MONTH DAY"]
["DATEADD DATEDIFF"]
["GETDATE"]
–§—É–Ω–∫—Ü—ñ—ó*—Ä—è–¥–∫—ñ–≤
["LEN SUBSTRING"]
["UPPER LOWER"]
["TRIM REPLACE"]
```

::

---

## –û–ø–µ—Ä–∞—Ç–æ—Ä IN: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω—å

**IN** –¥–æ–∑–≤–æ–ª—è—î –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ value –º—ñ—Å—Ç–∏—Ç—å—Å—è –≤ **—Å–ø–∏—Å–∫—É** –∑–Ω–∞—á–µ–Ω—å.

### –ë–∞–∑–æ–≤–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```sql
WHERE column IN (value1, value2, value3, ...)
```

### –ü—Ä–∏–∫–ª–∞–¥–∏

::code-group

```sql [IN –∑–∞–º—ñ—Å—Ç—å –º–Ω–æ–∂–∏–Ω–Ω–∏—Ö OR]
-- ‚ùå –î–æ–≤–≥–∏–π —Å–ø–æ—Å—ñ–± (–∑ OR)
SELECT * FROM Students
WHERE YEAR(BirthDate) = 1997
   OR YEAR(BirthDate) = 1998
   OR YEAR(BirthDate) = 1999;

-- ‚úÖ –ö–æ—Ä–æ—Ç—à–∏–π —Å–ø–æ—Å—ñ–± (–∑ IN)
SELECT * FROM Students
WHERE YEAR(BirthDate) IN (1997, 1998, 1999);
```

```sql [IN –∑ —Ç–µ–∫—Å—Ç–æ–≤–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏]
SELECT * FROM Students
WHERE LastName IN ('–ü–µ—Ç—Ä–µ–Ω–∫–æ', '–ö–æ–≤–∞–ª–µ–Ω–∫–æ', '–®–µ–≤—á–µ–Ω–∫–æ');
```

```sql [NOT IN (–≤–∏–∫–ª—é—á–µ–Ω–Ω—è)]
-- –°—Ç—É–¥–µ–Ω—Ç–∏ –ù–ï –Ω–∞—Ä–æ–¥–∂–µ–Ω—ñ –≤ 1997 —Ç–∞ 1999
SELECT * FROM Students
WHERE YEAR(BirthDate) NOT IN (1997, 1999);
```

::

### IN –∑ –ø—ñ–¥–∑–∞–ø–∏—Ç–∞–º–∏

IN –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ñ–Ω—à–æ–≥–æ SELECT:

```sql
-- –°—Ç—É–¥–µ–Ω—Ç–∏ –∑—ñ —Å—Ç–∏–ø–µ–Ω–¥—ñ—î—é –≤–∏—â–µ —Å–µ—Ä–µ–¥–Ω—å–æ—ó
SELECT * FROM Students
WHERE Grants IN (
    SELECT Grants
    FROM Students
    WHERE Grants > (SELECT AVG(Grants) FROM Students)
);
```

::tip
**Performance**: IN –∑ –Ω–µ–≤–µ–ª–∏–∫–∏–º —Å–ø–∏—Å–∫–æ–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç (–¥–æ 10-20 –∑–Ω–∞—á–µ–Ω—å) - —à–≤–∏–¥–∫–æ. –î–ª—è –≤–µ–ª–∏–∫–∏—Ö —Å–ø–∏—Å–∫—ñ–≤ –∞–±–æ —Å–∫–ª–∞–¥–Ω–∏—Ö –ø—ñ–¥–∑–∞–ø–∏—Ç—ñ–≤ —Ä–æ–∑–≥–ª—è–Ω—å—Ç–µ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∏ (JOIN, EXISTS).
::

---

## –û–ø–µ—Ä–∞—Ç–æ—Ä BETWEEN: –î—ñ–∞–ø–∞–∑–æ–Ω–∏ –∑–Ω–∞—á–µ–Ω—å

**BETWEEN** –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –∑–Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ **–¥—ñ–∞–ø–∞–∑–æ–Ω—ñ** (–≤–∫–ª—é—á–Ω–æ –∑ –º–µ–∂–∞–º–∏).

### –ë–∞–∑–æ–≤–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```sql
WHERE column BETWEEN value1 AND value2
-- –ï–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–æ: column >= value1 AND column <= value2
```

### –ü—Ä–∏–∫–ª–∞–¥–∏ –∑ —á–∏—Å–ª–∞–º–∏

```sql
-- –°—Ç—É–¥–µ–Ω—Ç–∏ –∑—ñ —Å—Ç–∏–ø–µ–Ω–¥—ñ—î—é –≤—ñ–¥ 1300 –¥–æ 1500
SELECT FirstName, LastName, Grants
FROM Students
WHERE Grants BETWEEN 1300 AND 1500;

-- –ï–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–æ:
WHERE Grants >= 1300 AND Grants <= 1500;
```

::warning
**BETWEEN –≤–∫–ª—é—á–∞—î –æ–±–∏–¥–≤—ñ –º–µ–∂—ñ**:

- `BETWEEN 1300 AND 1500` –æ–∑–Ω–∞—á–∞—î `>= 1300 AND <= 1500`
- –í–∫–ª—é—á–∞—î —è–∫ 1300, —Ç–∞–∫ —ñ 1500
  ::

### BETWEEN –∑ –¥–∞—Ç–∞–º–∏

```sql
-- –°—Ç—É–¥–µ–Ω—Ç–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω—ñ –≤ 1998 —Ä–æ—Ü—ñ
SELECT * FROM Students
WHERE BirthDate BETWEEN '1998-01-01' AND '1998-12-31';

-- –°—Ç—É–¥–µ–Ω—Ç–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω—ñ –≤ –ø–µ—Ä—à–æ–º—É –ø—ñ–≤—Ä—ñ—á—á—ñ 1998
SELECT * FROM Students
WHERE BirthDate BETWEEN '1998-01-01' AND '1998-06-30';
```

### NOT BETWEEN

```sql
-- –°—Ç—É–¥–µ–Ω—Ç–∏ –∑—ñ —Å—Ç–∏–ø–µ–Ω–¥—ñ—î—é –ù–ï –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ 1300-1500
SELECT * FROM Students
WHERE Grants NOT BETWEEN 1300 AND 1500;

-- –ï–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–æ:
WHERE Grants < 1300 OR Grants > 1500;
```

### BETWEEN vs –æ–ø–µ—Ä–∞—Ç–æ—Ä—ñ–≤ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

::tabs

::tabs-item{label="BETWEEN (—á–∏—Ç–∞–±–µ–ª—å–Ω—ñ—à–µ)"}

```sql
WHERE Age BETWEEN 18 AND 25
WHERE Price BETWEEN 100 AND 500
WHERE OrderDate BETWEEN '2024-01-01' AND '2024-12-31'
```

**–ü–µ—Ä–µ–≤–∞–≥–∏**: –ö–æ—Ä–æ—Ç—à–µ, –∑—Ä–æ–∑—É–º—ñ–ª—ñ—à–µ
::

::tabs-item{label="AND (–≥–Ω—É—á–∫—ñ—à–µ)"}

```sql
WHERE Age >= 18 AND Age < 25         -- –í–∏–∫–ª—é—á–∏—Ç–∏ 25!
WHERE Price > 100 AND Price <= 500   -- –í–∏–∫–ª—é—á–∏—Ç–∏ 100!
```

**–ü–µ—Ä–µ–≤–∞–≥–∏**: –ë—ñ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ –º–µ–∂–∞–º–∏
::

::

---

## LIKE: Pattern Matching (–ø–æ—à—É–∫ –∑–∞ —à–∞–±–ª–æ–Ω–æ–º)

**LIKE** –¥–æ–∑–≤–æ–ª—è—î —à—É–∫–∞—Ç–∏ —Ç–µ–∫—Å—Ç –∑–∞ **—à–∞–±–ª–æ–Ω–æ–º** –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º wildcards.

### Wildcards (—Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏)

| Wildcard | –ó–Ω–∞—á–µ–Ω–Ω—è                         | –ü—Ä–∏–∫–ª–∞–¥   | –ó–Ω–∞–π–¥–µ                       |
| :------- | :------------------------------- | :-------- | :--------------------------- |
| `%`      | –ë—É–¥—å-—è–∫–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–∏–º–≤–æ–ª—ñ–≤ (0+) | `'%–µ–Ω–∫–æ'` | –ü–µ—Ç—Ä**–µ–Ω–∫–æ**, –ö–æ–≤–∞–ª**–µ–Ω–∫–æ**  |
| `_`      | –†—ñ–≤–Ω–æ –æ–¥–∏–Ω —Å–∏–º–≤–æ–ª                | `'–ê___'`  | **–ê–Ω–Ω–∞**, **–ê–ª–ª–∞** (4 –±—É–∫–≤–∏) |
| `[]`     | –û–¥–∏–Ω —Å–∏–º–≤–æ–ª –∑—ñ —Å–ø–∏—Å–∫—É            | `'[–ú–ê]%'` | **–ú**–∞—Ä—ñ—è, **–ê**–Ω–Ω–∞          |
| `[^]`    | –û–¥–∏–Ω —Å–∏–º–≤–æ–ª –ù–ï –∑—ñ —Å–ø–∏—Å–∫—É         | `'[^–ú]%'` | **–Ü**–≤–∞–Ω, **–ê**–Ω–Ω–∞ (–Ω–µ –ú)    |

### –ü—Ä–∏–∫–ª–∞–¥–∏ –∑ % (–±—É–¥—å-—è–∫–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å)

::code-group

```sql [–ü–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑...]
-- –ü—Ä—ñ–∑–≤–∏—â–∞ —â–æ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ "–ü–µ—Ç"
SELECT * FROM Students
WHERE LastName LIKE '–ü–µ—Ç%';
-- –ó–Ω–∞–π–¥–µ: –ü–µ—Ç—Ä–µ–Ω–∫–æ, –ü–µ—Ç—Ä–æ–≤, ...
```

```sql [–ó–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞...]
-- –ü—Ä—ñ–∑–≤–∏—â–∞ —â–æ –∑–∞–∫—ñ–Ω—á—É—é—Ç—å—Å—è –Ω–∞ "–µ–Ω–∫–æ"
SELECT * FROM Students
WHERE LastName LIKE '%–µ–Ω–∫–æ';
-- –ó–Ω–∞–π–¥–µ: –ü–µ—Ç—Ä–µ–Ω–∫–æ, –ö–æ–≤–∞–ª–µ–Ω–∫–æ, –¢–∫–∞—á–µ–Ω–∫–æ, ...
```

```sql [–ú—ñ—Å—Ç–∏—Ç—å...]
-- –ü—Ä—ñ–∑–≤–∏—â–∞ —â–æ –º—ñ—Å—Ç—è—Ç—å "–æ–≤"
SELECT * FROM Students
WHERE LastName LIKE '%–æ–≤%';
-- –ó–Ω–∞–π–¥–µ: –ú–æ—Ä–æ–∑ [–Ω–µ–º–∞—î], –ö–æ–≤–∞–ª—å [–Ω–µ–º–∞—î], –∞–ª–µ –∑–Ω–∞–π–¥–µ —è–∫–±–∏ –±—É–≤ –ü–µ—Ç—Ä–æ–≤
```

```sql [–ü–æ—á–∏–Ω–∞—î—Ç—å—Å—è —ñ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è]
-- Email –∑ Gmail
SELECT * FROM Students
WHERE Email LIKE '%@gmail.com';
```

::

### –ü—Ä–∏–∫–ª–∞–¥–∏ –∑ \_ (–æ–¥–∏–Ω —Å–∏–º–≤–æ–ª)

```sql
-- –Ü–º–µ–Ω–∞ –∑ 4 –ª—ñ—Ç–µ—Ä
SELECT * FROM Students
WHERE FirstName LIKE '____';  -- 4 –ø—ñ–¥–∫—Ä–µ—Å–ª–µ–Ω–Ω—è
-- –ó–Ω–∞–π–¥–µ: –Ü–≤–∞–Ω (4 –±—É–∫–≤–∏), –ù–ï –∑–Ω–∞–π–¥–µ: –ú–∞—Ä—ñ—è (5 –±—É–∫–≤)

-- –î—Ä—É–≥–∞–∞ –ª—ñ—Ç–µ—Ä–∞ '–∞'
SELECT * FROM Students
WHERE FirstName LIKE '_–∞%';
-- –ó–Ω–∞–π–¥–µ: –ú–∞—Ä—ñ—è (–ú-–∞-...), NOT –Ü–≤–∞–Ω
```

### –ü—Ä–∏–∫–ª–∞–¥–∏ –∑ [] (—Å–ø–∏—Å–æ–∫ —Å–∏–º–≤–æ–ª—ñ–≤)

```sql
-- –ü—Ä—ñ–∑–≤–∏—â–∞ —â–æ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ –ú –∞–±–æ –ö
SELECT * FROM Students
WHERE LastName LIKE '[–ú–ö]%';
-- –ó–Ω–∞–π–¥–µ: –ú–æ—Ä–æ–∑, –ú–µ–ª—å–Ω–∏–∫, –ö–æ–≤–∞–ª–µ–Ω–∫–æ, –ö–æ–≤–∞–ª—å

-- Email –∑ —Ü–∏—Ñ—Ä–∞–º–∏ –Ω–∞ –ø–æ—á–∞—Ç–∫—É
SELECT * FROM Students
WHERE Email LIKE '[0-9]%';
-- –ó–Ω–∞–π–¥–µ: 123test@..., 5user@..., –ù–ï –∑–Ω–∞–π–¥–µ: user123@...

-- –Ü–º–µ–Ω–∞ —â–æ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ –≥–æ–ª–æ—Å–Ω–æ—ó
SELECT * FROM Students
WHERE FirstName LIKE '[–ê–ï–ò–Ü–û–£–Ø–Æ–Ñ–á–∞–µ–∏–æ—É—è—é—î—ó]%';
```

### –ü—Ä–∏–∫–ª–∞–¥–∏ –∑ [^] (–ù–ï –∑—ñ —Å–ø–∏—Å–∫—É)

```sql
-- –ü—Ä—ñ–∑–≤–∏—â–∞ —â–æ –ù–ï –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ –ü –∞–±–æ –ö
SELECT * FROM Students
WHERE LastName LIKE '[^–ü–ö]%';
-- –ó–Ω–∞–π–¥–µ: –ú–æ—Ä–æ–∑, –®–µ–≤—á–µ–Ω–∫–æ, –ù–ï –∑–Ω–∞–π–¥–µ: –ü–µ—Ç—Ä–µ–Ω–∫–æ, –ö–æ–≤–∞–ª–µ–Ω–∫–æ

-- –Ü–º–µ–Ω–∞ –ë–ï–ó —Ü–∏—Ñ—Ä
SELECT * FROM Students
WHERE FirstName NOT LIKE '%[0-9]%';
```

### ESCAPE: –ï–∫—Ä–∞–Ω—É–≤–∞–Ω–Ω—è —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ñ–≤

–©–æ —Ä–æ–±–∏—Ç–∏, —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ —Å–∞–º —Å–∏–º–≤–æ–ª `%` –∞–±–æ `_`?

```sql
-- –ó–Ω–∞–π—Ç–∏ email —â–æ –º—ñ—Å—Ç–∏—Ç—å –ø—ñ–¥–∫—Ä–µ—Å–ª–µ–Ω–Ω—è
SELECT * FROM Students
WHERE Email LIKE '%!_%' ESCAPE '!';
--                    ^         ^^^
--              –µ–∫—Ä–∞–Ω—É–≤–∞–ª–∏ _    —Å–∏–º–≤–æ–ª escape

-- –ó–Ω–∞–π—Ç–∏ –ø—Ä–æ–¥—É–∫—Ç–∏ –∑ % —É –Ω–∞–∑–≤—ñ "50% discount"
SELECT * FROM Products
WHERE ProductName LIKE '%!%%' ESCAPE '!';
```

### Case Sensitivity

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º LIKE **case-insensitive**:

```sql
WHERE LastName LIKE '–ø–µ—Ç—Ä–µ–Ω–∫–æ'  -- –ó–Ω–∞–π–¥–µ "–ü–µ—Ç—Ä–µ–Ω–∫–æ", "–ü–ï–¢–†–ï–ù–ö–û"
```

–î–ª—è case-sensitive:

```sql
WHERE LastName COLLATE Latin1_General_CS_AS LIKE '–ü–µ—Ç—Ä–µ–Ω–∫–æ'
```

::tip
**Performance –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è**: LIKE –∑ `%` –Ω–∞ –ø–æ—á–∞—Ç–∫—É (`'%value'`) **–ù–ï –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —ñ–Ω–¥–µ–∫—Å–∏** —ñ –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω–∏–º –Ω–∞ –≤–µ–ª–∏–∫–∏—Ö —Ç–∞–±–ª–∏—Ü—è—Ö. –ü–æ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ —É–Ω–∏–∫–∞–π—Ç–µ patterns —Ç–∏–ø—É `'%value%'`.
::

---

## –†–æ–±–æ—Ç–∞ –∑ –¥–∞—Ç–∞–º–∏

SQL Server –Ω–∞–¥–∞—î –±–∞–≥–∞—Ç–æ —Ñ—É–Ω–∫—Ü—ñ–π –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞—Ç–∞–º–∏.

### –§—É–Ω–∫—Ü—ñ—ó –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤

::code-group

```sql [–†—ñ–∫, –º—ñ—Å—è—Ü—å, –¥–µ–Ω—å]
SELECT
    FirstName,
    BirthDate,
    YEAR(BirthDate) AS BirthYear,
    MONTH(BirthDate) AS BirthMonth,
    DAY(BirthDate) AS BirthDay
FROM Students;
```

```sql [–ù–∞–∑–≤–∞ –º—ñ—Å—è—Ü—è]
SELECT
    FirstName,
    BirthDate,
    DATENAME(MONTH, BirthDate) AS MonthName,
    DATENAME(WEEKDAY, BirthDate) AS DayOfWeek
FROM Students;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 'January', 'Monday'
```

```sql [–ù–æ–º–µ—Ä –¥–Ω—è —Ç–∏–∂–Ω—è]
SELECT
    FirstName,
    DATEPART(WEEKDAY, BirthDate) AS DayNumber
FROM Students;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 1 = Sunday, 2 = Monday, ...
```

::

### –ü–æ—Ç–æ—á–Ω–∞ –¥–∞—Ç–∞ —ñ —á–∞—Å

```sql
SELECT
    GETDATE() AS CurrentDateTime,          -- 2024-02-07 22:30:45.123
    SYSDATETIME() AS HighPrecision,        -- –ë—ñ–ª—å—à–µ —Ç–æ—á–Ω–æ—Å—Ç—ñ
    GETUTCDATE() AS UTC;                   -- UTC —á–∞—Å
```

### DATEADD: –î–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ –¥–∞—Ç–∏

```sql
-- –§–æ—Ä–º–∞—Ç: DATEADD(datepart, number, date)

SELECT
    BirthDate,
    DATEADD(YEAR, 18, BirthDate) AS AdultDate,      -- +18 —Ä–æ–∫—ñ–≤
    DATEADD(MONTH, 6, BirthDate) AS HalfYearLater,  -- +6 –º—ñ—Å—è—Ü—ñ–≤
    DATEADD(DAY, -30, GETDATE()) AS MonthAgo        -- -30 –¥–Ω—ñ–≤ –≤—ñ–¥ —Å—å–æ–≥–æ–¥–Ω—ñ
FROM Students;
```

**datepart** –º–æ–∂–µ –±—É—Ç–∏:

- `YEAR`, `MONTH`, `DAY`
- `HOUR`, `MINUTE`, `SECOND`
- `WEEK`, `QUARTER`

### DATEDIFF: –†—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ –¥–∞—Ç–∞–º–∏

```sql
-- –§–æ—Ä–º–∞—Ç: DATEDIFF(datepart, startdate, enddate)

SELECT
    FirstName,
    BirthDate,
    DATEDIFF(YEAR, BirthDate, GETDATE()) AS ApproximateAge,
    DATEDIFF(DAY, BirthDate, GETDATE()) AS DaysOld,
    DATEDIFF(MONTH, BirthDate, GETDATE()) AS MonthsOld
FROM Students;
```

::warning
**DATEDIFF(YEAR, ...)** –ù–ï –¥–∞—î —Ç–æ—á–Ω–∏–π –≤—ñ–∫!

```sql
DATEDIFF(YEAR, '1998-12-31', '1999-01-01') = 1
-- –ê–ª–µ —Ä—ñ–∑–Ω–∏—Ü—è –ª–∏—à–µ 1 –¥–µ–Ω—å!

-- –î–ª—è —Ç–æ—á–Ω–æ–≥–æ –≤—ñ–∫—É:
DATEDIFF(YEAR, BirthDate, GETDATE()) -
    CASE
        WHEN MONTH(BirthDate) > MONTH(GETDATE()) OR
             (MONTH(BirthDate) = MONTH(GETDATE()) AND DAY(BirthDate) > DAY(GETDATE()))
        THEN 1
        ELSE 0
    END AS ExactAge
```

::

### –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –∑ –¥–∞—Ç–∞–º–∏

```sql
-- –°—Ç—É–¥–µ–Ω—Ç–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω—ñ –≤ —Å—ñ—á–Ω—ñ
SELECT * FROM Students
WHERE MONTH(BirthDate) = 1;

-- –°—Ç—É–¥–µ–Ω—Ç–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω—ñ –≤ –æ—Å—Ç–∞–Ω–Ω—ñ 25 —Ä–æ–∫—ñ–≤
SELECT * FROM Students
WHERE BirthDate >= DATEADD(YEAR, -25, GETDATE());

-- –°—Ç—É–¥–µ–Ω—Ç–∏ –Ω–∞—Ä–æ–¥–∂–µ–Ω—ñ —É –≤—ñ–≤—Ç–æ—Ä–æ–∫
SELECT * FROM Students
WHERE DATENAME(WEEKDAY, BirthDate) = 'Tuesday';

-- –°—Ç—É–¥–µ–Ω—Ç–∏ —É —è–∫–∏—Ö –¥–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —Ü—å–æ–≥–æ –º—ñ—Å—è—Ü—è
SELECT * FROM Students
WHERE MONTH(BirthDate) = MONTH(GETDATE());
```

---

## –†—è–¥–∫–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

SQL Server –º–∞—î –±–∞–≥–∞—Ç–æ —Ñ—É–Ω–∫—Ü—ñ–π –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ç–µ–∫—Å—Ç—É.

### LEN: –î–æ–≤–∂–∏–Ω–∞ —Ä—è–¥–∫–∞

```sql
SELECT
    FirstName,
    LEN(FirstName) AS NameLength,
    LEN(Email) AS EmailLength
FROM Students;
```

::note
`LEN()` **–Ω–µ —Ä–∞—Ö—É—î** trailing –ø—Ä–æ–±—ñ–ª–∏: `LEN(' text ') = 4`, –Ω–µ 6!

–î–ª—è –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –∑ –ø—Ä–æ–±—ñ–ª–∞–º–∏: `DATALENGTH(column)`
::

### SUBSTRING: –í–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –ø—ñ–¥—Ä—è–¥–∫–∞

```sql
-- SUBSTRING(string, start, length)

SELECT
    FirstName,
    SUBSTRING(FirstName, 1, 3) AS First3Chars,
    SUBSTRING(Email, 1, CHARINDEX('@', Email) - 1) AS EmailUsername
FROM Students;
```

**–ü—Ä–∏–∫–ª–∞–¥–∏**:

- `SUBSTRING('–Ü–≤–∞–Ω', 1, 2)` ‚Üí `'–Ü–≤'`
- `SUBSTRING('–ü–µ—Ç—Ä–µ–Ω–∫–æ', 4, 3)` ‚Üí `'—Ä–µ–Ω'`

### LEFT —ñ RIGHT

```sql
SELECT
    FirstName,
    LEFT(FirstName, 2) AS First2,      -- –ü–µ—Ä—à—ñ 2 —Å–∏–º–≤–æ–ª–∏
    RIGHT(FirstName, 2) AS Last2       -- –û—Å—Ç–∞–Ω–Ω—ñ 2 —Å–∏–º–≤–æ–ª–∏
FROM Students;
```

### UPPER, LOWER: –ó–º—ñ–Ω–∞ —Ä–µ–≥—ñ—Å—Ç—Ä—É

```sql
SELECT
    FirstName,
    UPPER(FirstName) AS Uppercase,     -- –Ü–í–ê–ù
    LOWER(FirstName) AS Lowercase,     -- —ñ–≤–∞–Ω
    UPPER(LEFT(FirstName, 1)) + LOWER(SUBSTRING(FirstName, 2, LEN(FirstName))) AS Capitalized
FROM Students;
```

### TRIM, LTRIM, RTRIM: –í–∏–¥–∞–ª–µ–Ω–Ω—è –ø—Ä–æ–±—ñ–ª—ñ–≤

```sql
SELECT
    LTRIM('  text  ') AS LeftTrimmed,    -- 'text  '
    RTRIM('  text  ') AS RightTrimmed,   -- '  text'
    TRIM('  text  ') AS BothTrimmed;     -- 'text'
```

### REPLACE: –ó–∞–º—ñ–Ω–∞ –ø—ñ–¥—Ä—è–¥–∫–∞

```sql
SELECT
    Email,
    REPLACE(Email, '@example.com', '@newdomain.com') AS NewEmail
FROM Students;

-- 'ivan@example.com' ‚Üí 'ivan@newdomain.com'
```

### CHARINDEX: –ü–æ—à—É–∫ –ø—ñ–¥—Ä—è–¥–∫–∞

```sql
-- CHARINDEX(substring, string) - –ø–æ–≤–µ—Ä—Ç–∞—î –ø–æ–∑–∏—Ü—ñ—é –∞–±–æ 0

SELECT
    Email,
    CHARINDEX('@', Email) AS AtPosition,
    CASE
        WHEN CHARINDEX('@gmail', Email) > 0 THEN 'Gmail'
        WHEN CHARINDEX('@example', Email) > 0 THEN 'Example'
        ELSE 'Other'
    END AS EmailProvider
FROM Students;
```

### CONCAT: –û–±'—î–¥–Ω–∞–Ω–Ω—è —Ä—è–¥–∫—ñ–≤

```sql
-- CONCAT —ñ–≥–Ω–æ—Ä—É—î NULL (–Ω–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ +)

SELECT
    CONCAT(FirstName, ' ', LastName) AS FullName,
    CONCAT('Email: ', Email, ' (verified)') AS EmailInfo
FROM Students;
-- –Ø–∫—â–æ Email = NULL, —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 'Email:  (verified)' (–Ω–µ NULL!)
```

### –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ –∑ —Ä—è–¥–∫–∞–º–∏

```sql
-- Email username (–¥–æ @)
SELECT
    Email,
    SUBSTRING(Email, 1, CHARINDEX('@', Email) - 1) AS Username
FROM Students
WHERE Email IS NOT NULL;

-- –ü–µ—Ä—à–∞ –ª—ñ—Ç–µ—Ä–∞ –ø—Ä—ñ–∑–≤–∏—â–∞
SELECT
    FirstName,
    LEFT(LastName, 1) + '.' AS LastInitial
FROM Students;

-- –ü–æ—à—É–∫ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∑ –¥–æ–≤–≥–∏–º–∏ —ñ–º–µ–Ω–∞–º–∏
SELECT * FROM Students
WHERE LEN(FirstName) > 6;

-- –ó–∞–º—ñ–Ω–∞ –¥–æ–º–µ–Ω—É email
SELECT
    FirstName,
    REPLACE(Email, 'example.com', 'university.edu') AS UniversityEmail
FROM Students;
```

---

## –ö–æ–º–±—ñ–Ω—É–≤–∞–Ω–Ω—è —Å–∫–ª–∞–¥–Ω–∏—Ö —É–º–æ–≤

–¢–µ–ø–µ—Ä, –∫–æ–ª–∏ –º–∏ –∑–Ω–∞—î–º–æ –≤—Å—ñ —Ü—ñ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏ —Ç–∞ —Ñ—É–Ω–∫—Ü—ñ—ó, –º–æ–∂–µ–º–æ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –¥—É–∂–µ —Å–∫–ª–∞–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏.

### –ü—Ä–∏–∫–ª–∞–¥ 1: –ú–Ω–æ–∂–∏–Ω–Ω—ñ —É–º–æ–≤–∏

```sql
SELECT
    FirstName,
    LastName,
    BirthDate,
    Grants,
    Email
FROM Students
WHERE
    (
        -- –ì—Ä—É–ø–∞ 1: –ù–∞—Ä–æ–¥–∂–µ–Ω—ñ –≤ 1998 –∑—ñ —Å—Ç–∏–ø–µ–Ω–¥—ñ—î—é
        (YEAR(BirthDate) = 1998 AND Grants > 1300)
        OR
        -- –ì—Ä—É–ø–∞ 2: –ü—Ä—ñ–∑–≤–∏—â–µ –Ω–∞ "–µ–Ω–∫–æ" –∑ Email
        (LastName LIKE '%–µ–Ω–∫–æ' AND Email IS NOT NULL)
    )
    AND
    -- –î–æ–¥–∞—Ç–∫–æ–≤–∞ —É–º–æ–≤–∞ –¥–ª—è –≤—Å—ñ—Ö
    MONTH(BirthDate) NOT IN (1, 12)  -- –ù–µ —Å—ñ—á–µ–Ω—å —ñ –Ω–µ –≥—Ä—É–¥–µ–Ω—å
ORDER BY Grants DESC, LastName ASC;
```

### –ü—Ä–∏–∫–ª–∞–¥ 2: –ü–æ—à—É–∫ –∑ pattern matching

```sql
-- –ó–Ω–∞–π—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤:
-- - –ó Gmail email
-- - –ê–ë–û –ø—Ä—ñ–∑–≤–∏—â–µ –º—ñ—Å—Ç–∏—Ç—å "–æ–≤" –∞–±–æ "–µ–≤"
-- - –ê–ë–û —ñ–º'—è –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –∑ –≥–æ–ª–æ—Å–Ω–æ—ó
SELECT * FROM Students
WHERE
    Email LIKE '%@gmail.com'
    OR LastName LIKE '%[–æ–µ]–≤%'
    OR FirstName LIKE '[–ê–ï–ò–Ü–û–£–∞–µ–∏–æ—É]%';
```

### –ü—Ä–∏–∫–ª–∞–¥ 3: –°–∫–ª–∞–¥–Ω–∞ —Ä–æ–±–æ—Ç–∞ –∑ –¥–∞—Ç–∞–º–∏

```sql
-- –°—Ç—É–¥–µ–Ω—Ç–∏ —É —è–∫–∏—Ö:
-- - –î–µ–Ω—å –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è –≤ –Ω–∞—Å—Ç—É–ø–Ω—ñ 30 –¥–Ω—ñ–≤
SELECT
    FirstName,
    LastName,
    BirthDate,
    DATENAME(MONTH, BirthDate) + ' ' + CAST(DAY(BirthDate) AS NVARCHAR) AS Birthday
FROM Students
WHERE
    (
        -- –¶—å–æ–≥–æ —Ä–æ–∫—É —â–µ –Ω–µ –±—É–ª–æ –î–ù
        MONTH(BirthDate) > MONTH(GETDATE())
        OR (MONTH(BirthDate) = MONTH(GETDATE()) AND DAY(BirthDate) >= DAY(GETDATE()))
    )
    AND
    -- –í –Ω–∞—Å—Ç—É–ø–Ω—ñ 30 –¥–Ω—ñ–≤
    DATEADD(YEAR, YEAR(GETDATE()) - YEAR(BirthDate), BirthDate)
        BETWEEN GETDATE() AND DATEADD(DAY, 30, GETDATE());
```

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è

::accordion

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 1: IN —Ç–∞ BETWEEN" icon="i-lucide-list-filter"}

–ó–Ω–∞–π–¥—ñ—Ç—å —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —è–∫—ñ:

- –ù–∞—Ä–æ–¥–∏–ª–∏—Å—è –≤ –ª—é—Ç–æ–º—É, –±–µ—Ä–µ–∑–Ω—ñ –∞–±–æ –∫–≤—ñ—Ç–Ω—ñ (–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ IN)
- –ê–ë–û —Å—Ç–∏–ø–µ–Ω–¥—ñ—è –≤ –¥—ñ–∞–ø–∞–∑–æ–Ω—ñ 1400-1600

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
SELECT FirstName, LastName, BirthDate, Grants
FROM Students
WHERE MONTH(BirthDate) IN (2, 3, 4)
   OR Grants BETWEEN 1400 AND 1600;
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 2: LIKE wildcards" icon="i-lucide-search"}

–ó–Ω–∞–π–¥—ñ—Ç—å —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —É —è–∫–∏—Ö:

- –ü—Ä—ñ–∑–≤–∏—â–µ –∑–∞–∫—ñ–Ω—á—É—î—Ç—å—Å—è –Ω–∞ "–µ–Ω–∫–æ"
- –Ü Email –ù–ï –º—ñ—Å—Ç–∏—Ç—å —Ü–∏—Ñ—Ä
- –Ü —ñ–º'—è –º—ñ—Å—Ç–∏—Ç—å –ª—ñ—Ç–µ—Ä—É '–∞'

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
SELECT FirstName, LastName, Email
FROM Students
WHERE LastName LIKE '%–µ–Ω–∫–æ'
  AND Email NOT LIKE '%[0-9]%'
  AND FirstName LIKE '%–∞%';
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 3: –§—É–Ω–∫—Ü—ñ—ó –¥–∞—Ç" icon="i-lucide-calendar"}

–ó–Ω–∞–π–¥—ñ—Ç—å —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —Å—Ç–∞—Ä—à–∏—Ö –∑–∞ 25 —Ä–æ–∫—ñ–≤, –≤—ñ–¥—Å–æ—Ä—Ç—É–π—Ç–µ –≤—ñ–¥ —Å—Ç–∞—Ä—à–æ–≥–æ –¥–æ –º–æ–ª–æ–¥—à–æ–≥–æ.

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
SELECT
    FirstName,
    LastName,
    BirthDate,
    DATEDIFF(YEAR, BirthDate, GETDATE()) AS ApproximateAge
FROM Students
WHERE DATEDIFF(YEAR, BirthDate, GETDATE()) > 25
ORDER BY BirthDate ASC;  -- –†–∞–Ω—ñ—à–µ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è = —Å—Ç–∞—Ä—à–∏–π
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 4: –†—è–¥–∫–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó" icon="i-lucide-type"}

–°—Ç–≤–æ—Ä—ñ—Ç—å –∑–≤—ñ—Ç —è–∫–∏–π –ø–æ–∫–∞–∑—É—î:

- –ü–æ–≤–Ω–µ —ñ–º'—è (–ü—Ä—ñ–∑–≤–∏—â–µ –Ü.)
- Email username (—á–∞—Å—Ç–∏–Ω–∞ –¥–æ @)
- –î–æ–≤–∂–∏–Ω—É —ñ–º–µ–Ω—ñ

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
SELECT
    LastName + ' ' + LEFT(FirstName, 1) + '.' AS ShortName,
    SUBSTRING(Email, 1, CHARINDEX('@', Email) - 1) AS EmailUsername,
    LEN(FirstName) AS NameLength
FROM Students
WHERE Email IS NOT NULL;
```

</details>

::

::

---

## –†–µ–∑—é–º–µ

::tip
**–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏ —Ä–æ–∑—à–∏—Ä–µ–Ω–∏—Ö SELECT**:

1. **IN** ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ —Å–ø–∏—Å–æ–∫ –∑–Ω–∞—á–µ–Ω—å (–∑–∞–º—ñ—Å—Ç—å –º–Ω–æ–∂–∏–Ω–Ω–∏—Ö OR)
2. **BETWEEN** ‚Äî –¥—ñ–∞–ø–∞–∑–æ–Ω–∏ (–≤–∫–ª—é—á–∞—î –æ–±–∏–¥–≤—ñ –º–µ–∂—ñ)
3. **LIKE** –∑ wildcards:
    - `%` ‚Äî –±—É–¥—å-—è–∫–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å–∏–º–≤–æ–ª—ñ–≤
    - `_` ‚Äî —Ä—ñ–≤–Ω–æ 1 —Å–∏–º–≤–æ–ª
    - `[]` ‚Äî —Å–∏–º–≤–æ–ª –∑—ñ —Å–ø–∏—Å–∫—É
    - `[^]` ‚Äî —Å–∏–º–≤–æ–ª –ù–ï –∑—ñ —Å–ø–∏—Å–∫—É
4. **–§—É–Ω–∫—Ü—ñ—ó –¥–∞—Ç**:
    - `YEAR`, `MONTH`, `DAY` ‚Äî –≤–∏—Ç—è–≥—É–≤–∞–Ω–Ω—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
    - `GETDATE()` ‚Äî –ø–æ—Ç–æ—á–Ω–∞ –¥–∞—Ç–∞/—á–∞—Å
    - `DATEADD` ‚Äî –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–æ –¥–∞—Ç–∏
    - `DATEDIFF` ‚Äî —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ –¥–∞—Ç–∞–º–∏
5. **–†—è–¥–∫–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó**:
    - `LEN`, `SUBSTRING`, `LEFT`, `RIGHT`
    - `UPPER`, `LOWER`, `TRIM`
    - `REPLACE`, `CHARINDEX`, `CONCAT`
6. **–ö–æ–º–±—ñ–Ω—É–≤–∞–Ω–Ω—è** ‚Äî –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –¥—É–∂–∫–∏ –¥–ª—è —Å–∫–ª–∞–¥–Ω–∏—Ö —É–º–æ–≤

**–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫**: –ù–∞–≤—á—ñ—Ç—å—Å—è –¥–æ–¥–∞–≤–∞—Ç–∏ –¥–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é INSERT –∑–∞–ø–∏—Ç—ñ–≤.
::

---

**–ü–æ–≤'—è–∑–∞–Ω—ñ —Ç–µ–º–∏**:

- [–ü–æ–ø–µ—Ä–µ–¥–Ω—è: SELECT - –û—Å–Ω–æ–≤–∏](./03.select-queries-fundamentals.md)
- [–ù–∞—Å—Ç—É–ø–Ω–∞: INSERT –∑–∞–ø–∏—Ç–∏](./05.insert-queries.md)
- [UPDATE —Ç–∞ DELETE](./06.update-delete-queries.md)
