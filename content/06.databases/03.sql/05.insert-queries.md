---
title: INSERT –∑–∞–ø–∏—Ç–∏ - –î–æ–¥–∞–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
description: –î–µ—Ç–∞–ª—å–Ω–∏–π —Ä–æ–∑–±—ñ—Ä INSERT –∑–∞–ø–∏—Ç—ñ–≤ - –¥–æ–¥–∞–≤–∞–Ω–Ω—è –æ–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞, –º–Ω–æ–∂–∏–Ω–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤, INSERT SELECT, —Ä–æ–±–æ—Ç–∞ –∑ IDENTITY —Ç–∞ DEFAULT
---

# INSERT –∑–∞–ø–∏—Ç–∏ - –î–æ–¥–∞–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö

## –ü—Ä–æ–±–ª–µ–º–∞: –Ø–∫ –¥–æ–¥–∞—Ç–∏ –¥–∞–Ω—ñ –≤ —Ç–∞–±–ª–∏—Ü—é?

–ú–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏ —Ç–∞–±–ª–∏—Ü—é `Students`, –≤–∏–∑–Ω–∞—á–∏–ª–∏ —ó—ó —Å—Ç—Ä—É–∫—Ç—É—Ä—É. –¢–µ–ø–µ—Ä –ø–æ—Ç—Ä—ñ–±–Ω–æ **–Ω–∞–ø–æ–≤–Ω–∏—Ç–∏** —ó—ó –¥–∞–Ω–∏–º–∏. –Ø–∫ —Ü–µ –∑—Ä–æ–±–∏—Ç–∏?

::mermaid

```mermaid
sequenceDiagram
participant App as –î–æ–¥–∞—Ç–æ–∫
participant SQL as SQL Server
participant Table as –¢–∞–±–ª–∏—Ü—è Students

    App->>SQL: INSERT INTO Students...
    SQL->>SQL: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ constraints
    alt –î–∞–Ω—ñ –≤–∞–ª—ñ–¥–Ω—ñ
        SQL->>Table: –î–æ–¥–∞—Ç–∏ new —Ä—è–¥–æ–∫
        Table-->>SQL: ‚úÖ –£—Å–ø—ñ—Ö (ID –ø–æ–≤–µ—Ä–Ω—É—Ç–æ)
        SQL-->>App: 1 row affected
    else –ü–æ—Ä—É—à–µ–Ω–Ω—è constraint
        SQL-->>App: ‚ùå –ü–æ–º–∏–ª–∫–∞: Constraint violation
    end

```

::

**INSERT** ‚Äî —Ü–µ DML –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è **–¥–æ–¥–∞–≤–∞–Ω–Ω—è** (–≤—Å—Ç–∞–≤–∫–∏) –Ω–æ–≤–∏—Ö —Ä—è–¥–∫—ñ–≤ –≤ —Ç–∞–±–ª–∏—Ü—é.

---

## –ë–∞–∑–æ–≤–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å INSERT

### –§–æ—Ä–º–∞—Ç 1: –ó —è–≤–Ω–∏–º –≤–∫–∞–∑—É–≤–∞–Ω–Ω—è–º —Å—Ç–æ–≤–ø—Ü—ñ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

```sql
INSERT INTO table_name (column1, column2, column3, ...)
VALUES (value1, value2, value3, ...);
```

### –§–æ—Ä–º–∞—Ç 2: –ë–µ–∑ –≤–∫–∞–∑—É–≤–∞–Ω–Ω—è —Å—Ç–æ–≤–ø—Ü—ñ–≤ (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

```sql
INSERT INTO table_name
VALUES (value1, value2, value3, ...);  -- –î–ª—è –í–°–Ü–• —Å—Ç–æ–≤–ø—Ü—ñ–≤ –ø–æ –ø–æ—Ä—è–¥–∫—É
```

::warning
**–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è**: –Ø–∫—â–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ñ –∑–º—ñ–Ω–∏—Ç—å—Å—è (–¥–æ–¥–∞—Å—Ç—å—Å—è/–≤–∏–¥–∞–ª–∏—Ç—å—Å—è —Å—Ç–æ–≤–ø–µ—Ü—å), –∑–∞–ø–∏—Ç –∑–ª–∞–º–∞—î—Ç—å—Å—è!

**Best Practice**: –ó–∞–≤–∂–¥–∏ –≤–∫–∞–∑—É–π—Ç–µ —Å—Ç–æ–≤–ø—Ü—ñ —è–≤–Ω–æ.
::

---

## –î–æ–¥–∞–≤–∞–Ω–Ω—è –æ–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞

### –ü—Ä–∏–∫–ª–∞–¥ 1: –ë–∞–∑–æ–≤–∏–π INSERT

```sql
INSERT INTO Students (FirstName, LastName, BirthDate, Grants, Email)
VALUES ('–û–ª–µ–∫—Å–∞–Ω–¥—Ä', '–ú–µ–ª—å–Ω–∏–∫', '1999-05-20', 1350.00, 'oleksandr.m@example.com');
```

**–©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è**:

1. SQL Server –ø–µ—Ä–µ–≤—ñ—Ä—è—î constraints (NOT NULL, CHECK, FOREIGN KEY)
2. –ì–µ–Ω–µ—Ä—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π `Id` (IDENTITY)
3. –ó–∞—Å—Ç–æ—Å–æ–≤—É—î DEFAULT –∑–Ω–∞—á–µ–Ω–Ω—è (—è–∫—â–æ —î)
4. –í—Å—Ç–∞–≤–ª—è—î —Ä—è–¥–æ–∫ —É —Ç–∞–±–ª–∏—Ü—é
5. –ü–æ–≤–µ—Ä—Ç–∞—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –≤—Å—Ç–∞–≤–ª–µ–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤: `(1 row affected)`

### –ü—Ä–∏–∫–ª–∞–¥ 2: –ó NULL –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏

```sql
-- Grants —Ç–∞ Email –º–æ–∂—É—Ç—å –±—É—Ç–∏ NULL
INSERT INTO Students (FirstName, LastName, BirthDate, Grants, Email)
VALUES ('–ù–∞—Ç–∞–ª—ñ—è', '–°–∏–¥–æ—Ä–µ–Ω–∫–æ', '1998-08-15', NULL, NULL);
```

### –ü—Ä–∏–∫–ª–∞–¥ 3: –ó DEFAULT –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏

–Ø–∫—â–æ —Å—Ç–æ–≤–ø–µ—Ü—å –º–∞—î DEFAULT —ñ –≤–∏ –ù–ï –≤–∫–∞–∑—É—î—Ç–µ –∑–Ω–∞—á–µ–Ω–Ω—è:

```sql
-- –°—Ç–æ–≤–ø–µ—Ü—å IsActive –º–∞—î DEFAULT 1
INSERT INTO Students (FirstName, LastName, BirthDate)
VALUES ('–°–µ—Ä–≥—ñ–π', '–ë–æ–Ω–¥–∞—Ä–µ–Ω–∫–æ', '1997-12-10');
-- IsActive –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –æ—Ç—Ä–∏–º–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è 1
```

–ê–±–æ —è–≤–Ω–æ –≤–∫–∞–∑–∞—Ç–∏ DEFAULT:

```sql
INSERT INTO Students (FirstName, LastName, BirthDate, IsActive)
VALUES ('–°–µ—Ä–≥—ñ–π', '–ë–æ–Ω–¥–∞—Ä–µ–Ω–∫–æ', '1997-12-10', DEFAULT);
--                                                ^^^^^^
```

---

## IDENTITY: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è ID

**IDENTITY** ‚Äî —Ü–µ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π –∞—Ç—Ä–∏–±—É—Ç —Å—Ç–æ–≤–ø—Ü—è, —è–∫–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≥–µ–Ω–µ—Ä—É—î —É–Ω—ñ–∫–∞–ª—å–Ω—ñ —á–∏—Å–ª–∞.

### –Ø–∫ –ø—Ä–∞—Ü—é—î IDENTITY

```sql
-- Id –º–∞—î IDENTITY(1, 1) - –ø–æ—á–∞—Ç–æ–∫ –∑ 1, –∫—Ä–æ–∫ 1
INSERT INTO Students (FirstName, LastName, BirthDate)
VALUES ('–¢–µ—Å—Ç1', '–¢–µ—Å—Ç–æ–≤', '2000-01-01');
-- Id = 1

INSERT INTO Students (FirstName, LastName, BirthDate)
VALUES ('–¢–µ—Å—Ç2', '–¢–µ—Å—Ç–æ–≤–∞', '2000-01-02');
-- Id = 2

INSERT INTO Students (FirstName, LastName, BirthDate)
VALUES ('–¢–µ—Å—Ç3', '–¢–µ—Å—Ç–æ–≤', '2000-01-03');
-- Id = 3
```

::note
**–ù–ï –º–æ–∂–Ω–∞** –≤—Å—Ç–∞–≤–∏—Ç–∏ –∑–Ω–∞—á–µ–Ω–Ω—è –≤ IDENTITY —Å—Ç–æ–≤–ø–µ—Ü—å:

```sql
INSERT INTO Students (Id, FirstName, LastName, BirthDate)
VALUES (100, '–¢–µ—Å—Ç', '–¢–µ—Å—Ç–æ–≤', '2000-01-01');
-- ‚ùå –ü–æ–º–∏–ª–∫–∞: Cannot insert explicit value for identity column
```

**–í–∏–Ω—è—Ç–æ–∫**: –í–∏–∫–æ—Ä–∏—Å—Ç–µ–Ω–Ω—è `SET IDENTITY_INSERT` (—Ä–æ–∑–≥–ª—è–Ω–µ–º–æ –Ω–∏–∂—á–µ).
::

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è —â–æ–π–Ω–æ –≤—Å—Ç–∞–≤–ª–µ–Ω–æ–≥–æ ID

–ü—ñ—Å–ª—è INSERT —á–∞—Å—Ç–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —è–∫–∏–π ID –±—É–≤ –ø—Ä–∏—Å–≤–æ—î–Ω–∏–π:

::code-group

```sql [SCOPE_IDENTITY() (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)]
INSERT INTO Students (FirstName, LastName, BirthDate)
VALUES ('–Ü–≤–∞–Ω', '–ù–æ–≤–∏–π', '2000-01-01');

SELECT SCOPE_IDENTITY() AS NewId;
-- –ü–æ–≤–µ—Ä—Ç–∞—î: 13 (—è–∫—â–æ —Ü–µ –±—É–≤ 13-–π —Ä—è–¥–æ–∫)
```

```sql [@@IDENTITY (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)]
INSERT INTO Students (FirstName, LastName, BirthDate)
VALUES ('–ú–∞—Ä—ñ—è', '–ù–æ–≤–∞', '2000-01-02');

SELECT @@IDENTITY AS NewId;
-- –ú–æ–∂–µ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π ID —è–∫—â–æ —î triggers!
```

```sql [OUTPUT clause (–Ω–∞–π–∫—Ä–∞—â–∏–π —Å–ø–æ—Å—ñ–±)]
INSERT INTO Students (FirstName, LastName, BirthDate)
OUTPUT INSERTED.Id, INSERTED.FirstName
VALUES ('–û–ª–µ–≥', '–ù–æ–≤–∏–π', '2000-01-03');

-- –†–µ–∑—É–ª—å—Ç–∞—Ç:
-- Id | FirstName
-- 14 | –û–ª–µ–≥
```

::

**–†—ñ–∑–Ω–∏—Ü—è**:

- `SCOPE_IDENTITY()` ‚Äî ID –≤ –ø–æ—Ç–æ—á–Ω–æ–º—É scope (—ñ–≥–Ω–æ—Ä—É—î triggers)
- `@@IDENTITY` ‚Äî –æ—Å—Ç–∞–Ω–Ω—ñ–π –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π ID (–≤–∫–ª—é—á–Ω–æ –∑ triggers)
- `OUTPUT` ‚Äî –Ω–∞–π–ø–æ—Ç—É–∂–Ω—ñ—à–∏–π, –ø–æ–∫–∞–∑—É—î –≤—Å—Ç–∞–≤–ª–µ–Ω—ñ –¥–∞–Ω—ñ

::tip
**Best Practice**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `SCOPE_IDENTITY()` –∞–±–æ `OUTPUT` –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è ID.
::

### SET IDENTITY_INSERT: –í—Å—Ç–∞–≤–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏—Ö ID

–Ü–Ω–æ–¥—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—Å—Ç–∞–≤–∏—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è ID (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö):

```sql
-- –£–≤—ñ–º–∫–Ω—É—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤—Å—Ç–∞–≤–∫–∏ –≤ IDENTITY
SET IDENTITY_INSERT Students ON;

INSERT INTO Students (Id, FirstName, LastName, BirthDate)
VALUES (100, '–°–ø–µ—Ü—ñ–∞–ª—å–Ω–∏–π', '–°—Ç—É–¥–µ–Ω—Ç', '2000-01-01');

-- –í–∏–º–∫–Ω—É—Ç–∏ –Ω–∞–∑–∞–¥
SET IDENTITY_INSERT Students OFF;
```

::caution
**–û–±–º–µ–∂–µ–Ω–Ω—è**:

- –ú–æ–∂–Ω–∞ —É–≤—ñ–º–∫–Ω—É—Ç–∏ —Ç—ñ–ª—å–∫–∏ –¥–ª—è **–æ–¥–Ω—ñ—î—ó** —Ç–∞–±–ª–∏—Ü—ñ –∑–∞ —Ä–∞–∑
- –ü—ñ—Å–ª—è –≤–∏–º–∫–Ω–µ–Ω–Ω—è IDENTITY –ø—Ä–æ–¥–æ–≤–∂–∏—Ç—å –∑ –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–Ω—è
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ–±–µ—Ä–µ–∂–Ω–æ (–º–æ–∂–µ –ø–æ—Ä—É—à–∏—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å)

::

---

## –ú–Ω–æ–∂–∏–Ω–Ω—ñ INSERT: –î–æ–¥–∞–≤–∞–Ω–Ω—è –±–∞–≥–∞—Ç—å–æ—Ö —Ä—è–¥–∫—ñ–≤

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å (SQL Server 2008+)

```sql
INSERT INTO table_name (column1, column2, ...)
VALUES
    (value1_1, value1_2, ...),
    (value2_1, value2_2, ...),
    (value3_1, value3_2, ...);
```

### –ü—Ä–∏–∫–ª–∞–¥: 3 —Å—Ç—É–¥–µ–Ω—Ç–∏ –∑–∞ –æ–¥–∏–Ω –∑–∞–ø–∏—Ç

```sql
INSERT INTO Students (FirstName, LastName, BirthDate, Grants, Email)
VALUES
    ('–ê–Ω–¥—Ä—ñ–π', '–ö–æ–≤–∞–ª—å—á—É–∫', '1998-03-22', 1450.00, 'andriy.k@example.com'),
    ('–í—ñ–∫—Ç–æ—Ä—ñ—è', '–õ–∏—Ç–≤–∏–Ω', '1999-07-11', 1500.00, 'viktoria.l@example.com'),
    ('–ë–æ–≥–¥–∞–Ω', '–ì—Ä–∏—Ü–µ–Ω–∫–æ', '1997-11-30', 1380.00, NULL);

-- –†–µ–∑—É–ª—å—Ç–∞—Ç: (3 rows affected)
```

::tip
**Performance**: –ú–Ω–æ–∂–∏–Ω–Ω–∏–π INSERT **–∑–Ω–∞—á–Ω–æ —à–≤–∏–¥—à–∏–π** –∑–∞ –æ–∫—Ä–µ–º—ñ –∑–∞–ø–∏—Ç–∏:

```sql
-- ‚ùå –ü–æ–≤—ñ–ª—å–Ω–æ (3 –æ–∫—Ä–µ–º—ñ –∑–∞–ø–∏—Ç–∏)
INSERT INTO Students (...) VALUES (...);
INSERT INTO Students (...) VALUES (...);
INSERT INTO Students (...) VALUES (...);

-- ‚úÖ –®–≤–∏–¥–∫–æ (1 –∑–∞–ø–∏—Ç –¥–ª—è 3 —Ä—è–¥–∫—ñ–≤)
INSERT INTO Students (...)
VALUES (...), (...), (...);
```

–ï–∫–æ–Ω–æ–º—ñ—è –æ—Å–æ–±–ª–∏–≤–æ –≤—ñ–¥—á—É—Ç–Ω–∞ –ø—Ä–∏ –≤—Å—Ç–∞–≤—Ü—ñ —Å–æ—Ç–µ–Ω—å/—Ç–∏—Å—è—á —Ä—è–¥–∫—ñ–≤!
::

### –û–±–º–µ–∂–µ–Ω–Ω—è

SQL Server –¥–æ–∑–≤–æ–ª—è—î –¥–æ **1000 —Ä—è–¥–∫—ñ–≤** –≤ –æ–¥–Ω–æ–º—É VALUES:

```sql
INSERT INTO Students (...)
VALUES
    (...),  -- —Ä—è–¥–æ–∫ 1
    (...),  -- —Ä—è–¥–æ–∫ 2
    ...
    (...);  -- —Ä—è–¥–æ–∫ 1000 - –º–∞–∫—Å–∏–º—É–º
```

–î–ª—è –±—ñ–ª—å—à–µ —Ä—è–¥–∫—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∫—ñ–ª—å–∫–∞ INSERT –∞–±–æ BULK INSERT.

---

## INSERT SELECT: –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö

**INSERT SELECT** –¥–æ–∑–≤–æ–ª—è—î –≤—Å—Ç–∞–≤–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç SELECT –∑–∞–ø–∏—Ç—É –≤ —Ç–∞–±–ª–∏—Ü—é.

### –ë–∞–∑–æ–≤–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```sql
INSERT INTO target_table (column1, column2, ...)
SELECT column1, column2, ...
FROM source_table
WHERE condition;
```

### –ü—Ä–∏–∫–ª–∞–¥ 1: –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤

```sql
-- –°—Ç–≤–æ—Ä–∏–º–æ –∞—Ä—Ö—ñ–≤–Ω—É —Ç–∞–±–ª–∏—Ü—é
CREATE TABLE StudentsArchive (
    Id INT PRIMARY KEY IDENTITY(1, 1),
    FirstName NVARCHAR(50) NOT NULL,
    LastName NVARCHAR(50) NOT NULL,
    BirthDate DATE NOT NULL,
    ArchivedDate DATE DEFAULT GETDATE()
);

-- –°–∫–æ–ø—ñ—é—î–º–æ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –Ω–∞—Ä–æ–¥–∂–µ–Ω–∏—Ö –¥–æ 1998
INSERT INTO StudentsArchive (FirstName, LastName, BirthDate)
SELECT FirstName, LastName, BirthDate
FROM Students
WHERE YEAR(BirthDate) < 1998;

-- –†–µ–∑—É–ª—å—Ç–∞—Ç: (N rows affected) - —Å–∫—ñ–ª—å–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω–æ
```

### –ü—Ä–∏–∫–ª–∞–¥ 2: –í—Å—Ç–∞–≤–∫–∞ –∑ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è–º–∏

```sql
-- –¢–∞–±–ª–∏—Ü—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
CREATE TABLE StudentStats (
    StudentId INT,
    FullName NVARCHAR(100),
    ApproximateAge INT,
    HasScholarship BIT
);

-- –ó–∞–ø–æ–≤–Ω–∏—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
INSERT INTO StudentStats (StudentId, FullName, ApproximateAge, HasScholarship)
SELECT
    Id,
    FirstName + ' ' + LastName,
    DATEDIFF(YEAR, BirthDate, GETDATE()),
    CASE WHEN Grants IS NOT NULL THEN 1 ELSE 0 END
FROM Students;
```

### –ü—Ä–∏–∫–ª–∞–¥ 3: –í—Å—Ç–∞–≤–∫–∞ –≤—Å—ñ—Ö —Å—Ç–æ–≤–ø—Ü—ñ–≤

```sql
-- –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–æ—á–Ω—É –∫–æ–ø—ñ—é —Ç–∞–±–ª–∏—Ü—ñ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ + –¥–∞–Ω—ñ)
SELECT * INTO Students_Backup FROM Students;  -- –°—Ç–≤–æ—Ä–∏—Ç—å –Ω–æ–≤—É —Ç–∞–±–ª–∏—Ü—é

-- –ê–ë–û –≤—Å—Ç–∞–≤–∏—Ç–∏ –≤ —ñ—Å–Ω—É—é—á—É —Ç–∞–±–ª–∏—Ü—é
INSERT INTO Students_Backup
SELECT * FROM Students;  -- –¢–∞–±–ª–∏—Ü—è –≤–∂–µ –º–∞—î —ñ—Å–Ω—É–≤–∞—Ç–∏
```

::warning
–ë—É–¥—å—Ç–µ –æ–±–µ—Ä–µ–∂–Ω—ñ –∑ SELECT \* ‚Äî –≤—Å—Ç–∞–≤–∫–∞ –≤—ñ–¥–±—É–¥–µ—Ç—å—Å—è —É –ø–æ—Ä—è–¥–∫—É —Å—Ç–æ–≤–ø—Ü—ñ–≤ –≤ source —Ç–∞–±–ª–∏—Ü—ñ. –Ø–∫—â–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –≤—ñ–¥—Ä—ñ–∑–Ω—è—é—Ç—å—Å—è - –±—É–¥—É—Ç—å –ø–æ–º–∏–ª–∫–∏!
::

---

## –†–æ–±–æ—Ç–∞ –∑ Constraints –ø—Ä–∏ INSERT

### NOT NULL –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞

```sql
-- ‚ùå –ü–æ–º–∏–ª–∫–∞ - LastName —î NOT NULL
INSERT INTO Students (FirstName, BirthDate)
VALUES ('–¢–µ—Å—Ç', '2000-01-01');
-- Msg 515: Cannot insert NULL into column 'LastName'
```

### CHECK constraint –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞

```sql
-- –Ø–∫—â–æ —î CHECK (Grants >= 0)
INSERT INTO Students (FirstName, LastName, BirthDate, Grants)
VALUES ('–¢–µ—Å—Ç', '–¢–µ—Å—Ç–æ–≤', '2000-01-01', -100);
-- ‚ùå Msg 547: The INSERT statement conflicted with the CHECK constraint
```

### UNIQUE constraint –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞

```sql
-- –Ø–∫—â–æ Email –º–∞—î UNIQUE constraint
INSERT INTO Students (FirstName, LastName, BirthDate, Email)
VALUES ('–Ü–≤–∞–Ω', '–ü–µ—Ç—Ä–æ–≤', '2000-01-01', 'existing@example.com');
-- ‚ùå Msg 2627: Violation of UNIQUE KEY constraint (—è–∫—â–æ email –≤–∂–µ —ñ—Å–Ω—É—î)
```

### FOREIGN KEY –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞

```sql
-- –Ø–∫—â–æ DepartmentId –º–∞—î FK –Ω–∞ Departments.DepartmentId
INSERT INTO Students (FirstName, LastName, BirthDate, DepartmentId)
VALUES ('–¢–µ—Å—Ç', '–¢–µ—Å—Ç–æ–≤', '2000-01-01', 999);
-- ‚ùå Msg 547: The INSERT statement conflicted with the FOREIGN KEY constraint
-- (—è–∫—â–æ Departments –∑ Id=999 –Ω–µ —ñ—Å–Ω—É—î)
```

---

## OUTPUT Clause: –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –≤—Å—Ç–∞–≤–ª–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö

**OUTPUT** –¥–æ–∑–≤–æ–ª—è—î –ø–æ–±–∞—á–∏—Ç–∏, —è–∫—ñ –¥–∞–Ω—ñ –±—É–ª–∏ –≤—Å—Ç–∞–≤–ª–µ–Ω—ñ.

### –ë–∞–∑–æ–≤–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å

```sql
INSERT INTO table_name (columns)
OUTPUT INSERTED.column1, INSERTED.column2, ...
VALUES (...);
```

### –ü—Ä–∏–∫–ª–∞–¥ 1: –ü–æ–≤–µ—Ä–Ω—É—Ç–∏ ID —Ç–∞ —ñ–º'—è

```sql
INSERT INTO Students (FirstName, LastName, BirthDate)
OUTPUT INSERTED.Id, INSERTED.FirstName, INSERTED.LastName
VALUES
    ('–û–ª–µ–Ω–∞', '–¢–∫–∞—á', '1999-04-15'),
    ('–ú–∏—Ö–∞–π–ª–æ', '–°–æ–ª–æ–≤–µ–π', '1998-09-22');

-- –†–µ–∑—É–ª—å—Ç–∞—Ç:
-- Id | FirstName | LastName
-- 20 | –û–ª–µ–Ω–∞     | –¢–∫–∞—á
-- 21 | –ú–∏—Ö–∞–π–ª–æ   | –°–æ–ª–æ–≤–µ–π
```

### –ü—Ä–∏–∫–ª–∞–¥ 2: –ó–±–µ—Ä–µ–≥—Ç–∏ OUTPUT –≤ —Ç–∞–±–ª–∏—Ü—é

```sql
-- –¢–∏–º—á–∞—Å–æ–≤–∞ —Ç–∞–±–ª–∏—Ü—è –¥–ª—è ID
DECLARE @InsertedIds TABLE (NewId INT, StudentName NVARCHAR(100));

INSERT INTO Students (FirstName, LastName, BirthDate)
OUTPUT INSERTED.Id, INSERTED.FirstName + ' ' + INSERTED.LastName
INTO @InsertedIds
VALUES
    ('–ê–Ω–Ω–∞', '–ú–æ—Ä–æ–∑', '1999-01-20'),
    ('–î–º–∏—Ç—Ä–æ', '–ö–æ–≤–∞–ª—å', '1998-06-30');

-- –¢–µ–ø–µ—Ä –º–æ–∂–µ–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ ID
SELECT * FROM @InsertedIds;
```

::tip
**–ü—Ä–∞–∫—Ç–∏—á–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è OUTPUT**:

- –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏—Ö IDENTITY –∑–Ω–∞—á–µ–Ω—å
- –õ–æ–≥—É–≤–∞–Ω–Ω—è –≤—Å—Ç–∞–≤–ª–µ–Ω–∏—Ö –∑–∞–ø–∏—Å—ñ–≤
- –ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –≤ –¥–æ–¥–∞—Ç–æ–∫ –ø—ñ—Å–ª—è INSERT

::

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó

### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞

```sql
-- –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∑ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è–º ID
DECLARE @NewStudentId INT;

INSERT INTO Students (FirstName, LastName, BirthDate, Email)
VALUES ('–ö–∞—Ç–µ—Ä–∏–Ω–∞', '–ü–µ—Ç—Ä–æ–≤–∞', '1999-03-15', 'kateryna.p@university.edu');

SET @NewStudentId = SCOPE_IDENTITY();

PRINT 'New student registered with ID: ' + CAST(@NewStudentId AS NVARCHAR);
-- New student registered with ID: 22
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –Ü–º–ø–æ—Ä—Ç –¥–∞–Ω–∏—Ö –∑ —ñ–Ω—à–æ—ó —Ç–∞–±–ª–∏—Ü—ñ

```sql
-- –Ü–º–ø–æ—Ä—Ç —Ç—ñ–ª—å–∫–∏ –∞–∫—Ç–∏–≤–Ω–∏—Ö —é–∑–µ—Ä—ñ–≤ –∑ oldusers —Ç–∞–±–ª–∏—Ü—ñ
INSERT INTO Students (FirstName, LastName, BirthDate, Email)
SELECT
    Name AS FirstName,
    Surname AS LastName,
    DateOfBirth,
    ContactEmail
FROM ImportedUsers
WHERE IsActive = 1 AND Type = 'Student';
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 3: Batch INSERT

```sql
-- –ü–∞–∫–µ—Ç–Ω–∞ –≤—Å—Ç–∞–≤–∫–∞ 5 —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
BEGIN TRANSACTION;

INSERT INTO Students (FirstName, LastName, BirthDate, Grants)
VALUES
    ('–°1', '–ü—Ä—ñ–∑–≤–∏—â–µ1', '1998-01-01', 1200),
    ('–°2', '–ü—Ä—ñ–∑–≤–∏—â–µ2', '1998-01-02', 1300),
    ('–°3', '–ü—Ä—ñ–∑–≤–∏—â–µ3', '1998-01-03', 1400),
    ('–°4', '–ü—Ä—ñ–∑–≤–∏—â–µ4', '1998-01-04', 1500),
    ('–°5', '–ü—Ä—ñ–∑–≤–∏—â–µ5', '1998-01-05', 1600);

-- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
IF @@ROWCOUNT = 5
BEGIN
    COMMIT;
    PRINT '–í—Å—ñ 5 —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –¥–æ–¥–∞–Ω—ñ —É—Å–ø—ñ—à–Ω–æ';
END
ELSE
BEGIN
    ROLLBACK;
    PRINT '–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤—Å—Ç–∞–≤—Ü—ñ';
END
```

---

## Best Practices

::card-group

::card{title="1. –ó–∞–≤–∂–¥–∏ –≤–∫–∞–∑—É–π—Ç–µ —Å—Ç–æ–≤–ø—Ü—ñ" icon="i-lucide-list"}

```sql
-- ‚úÖ –î–æ–±—Ä–µ
INSERT INTO Students (FirstName, LastName, BirthDate)
VALUES ('–Ü–≤–∞–Ω', '–Ü–≤–∞–Ω–æ–≤', '2000-01-01');

-- ‚ùå –ü–æ–≥–∞–Ω–æ
INSERT INTO Students VALUES ('–Ü–≤–∞–Ω', '–Ü–≤–∞–Ω–æ–≤', '2000-01-01', NULL, NULL);
```

::

::card{title="2. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –º–Ω–æ–∂–∏–Ω–Ω—ñ VALUES" icon="i-lucide-zap"}

–î–ª—è –∫—ñ–ª—å–∫–æ—Ö —Ä—è–¥–∫—ñ–≤ - –æ–¥–∏–Ω INSERT:

```sql
-- ‚úÖ –®–≤–∏–¥–∫–æ
INSERT INTO Students (...)
VALUES (...), (...), (...);

-- ‚ùå –ü–æ–≤—ñ–ª—å–Ω–æ
INSERT INTO Students (...) VALUES (...);
INSERT INTO Students (...) VALUES (...);
INSERT INTO Students (...) VALUES (...);
```

::

::card{title="3. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó" icon="i-lucide-shield"}

–î–ª—è –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π:

```sql
BEGIN TRANSACTION;
    INSERT INTO Students (...) VALUES (...);
    INSERT INTO Enrollments (...) VALUES (...);
COMMIT;
```

::

::card{title="4. –ü–µ—Ä–µ–≤—ñ—Ä—è–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç" icon="i-lucide-check-circle"}

```sql
INSERT INTO Students (...) VALUES (...);

IF @@ROWCOUNT = 0
BEGIN
    PRINT '–ù—ñ—á–æ–≥–æ –Ω–µ –≤—Å—Ç–∞–≤–ª–µ–Ω–æ!';
END
```

::

::

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è

::accordion

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 1: –ë–∞–∑–æ–≤–∏–π INSERT" icon="i-lucide-plus-circle"}

–î–æ–¥–∞–π—Ç–µ –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞:

- FirstName: –í–∞—à–µ —ñ–º'—è
- LastName: –í–∞—à–µ –ø—Ä—ñ–∑–≤–∏—â–µ
- BirthDate: 2000-06-15
- Grants: 1550
- Email: –≤–∞—à email

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
INSERT INTO Students (FirstName, LastName, BirthDate, Grants, Email)
VALUES ('–í–∞—à–µ', '–ü—Ä—ñ–∑–≤–∏—â–µ', '2000-06-15', 1550, 'yourname@example.com');

-- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞
SELECT * FROM Students WHERE LastName = '–ü—Ä—ñ–∑–≤–∏—â–µ';
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 2: –ú–Ω–æ–∂–∏–Ω–Ω–∏–π INSERT" icon="i-lucide-users"}

–î–æ–¥–∞–π—Ç–µ 3 —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∑–∞ –æ–¥–∏–Ω –∑–∞–ø–∏—Ç –∑ —Ä—ñ–∑–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏.

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
INSERT INTO Students (FirstName, LastName, BirthDate, Grants, Email)
VALUES
    ('–¢–∞—Ä–∞—Å', '–®–µ–≤—á–µ–Ω–∫–æ', '1999-03-09', 1700, 'taras.sh@example.com'),
    ('–õ–µ—Å—è', '–£–∫—Ä–∞—ó–Ω–∫–∞', '1998-02-25', 1800, 'lesya.u@example.com'),
    ('–Ü–≤–∞–Ω', '–§—Ä–∞–Ω–∫–æ', '1997-08-27', 1600, NULL);

SELECT * FROM Students WHERE LastName IN ('–®–µ–≤—á–µ–Ω–∫–æ', '–£–∫—Ä–∞—ó–Ω–∫–∞', '–§—Ä–∞–Ω–∫–æ');
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 3: INSERT SELECT" icon="i-lucide-copy"}

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ç–∞–±–ª–∏—Ü—é `TopStudents` —Ç–∞ —Å–∫–æ–ø—ñ—é–π—Ç–µ —Ç—É–¥–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∑—ñ —Å—Ç–∏–ø–µ–Ω–¥—ñ—î—é –±—ñ–ª—å—à–µ 1500.

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
-- –ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—é
CREATE TABLE TopStudents (
    Id INT PRIMARY KEY IDENTITY(1, 1),
    FullName NVARCHAR(100),
    Scholarship DECIMAL(10, 2),
    Year INT
);

-- –ö—Ä–æ–∫ 2: –í—Å—Ç–∞–≤–∏—Ç–∏ —Ç–æ–ø —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
INSERT INTO TopStudents (FullName, Scholarship, Year)
SELECT
    FirstName + ' ' + LastName,
    Grants,
    YEAR(BirthDate)
FROM Students
WHERE Grants > 1500;

-- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞
SELECT * FROM TopStudents;
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 4: OUTPUT clause" icon="i-lucide-arrow-right"}

–î–æ–¥–∞–π—Ç–µ 2 —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —ñ –ø–æ–≤–µ—Ä–Ω—ñ—Ç—å —ó—Ö–Ω—ñ ID —Ç–∞ –ø–æ–≤–Ω—ñ —ñ–º–µ–Ω–∞.

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
INSERT INTO Students (FirstName, LastName, BirthDate, Grants)
OUTPUT
    INSERTED.Id,
    INSERTED.FirstName + ' ' + INSERTED.LastName AS FullName,
    INSERTED.Grants
VALUES
    ('–û–ª–µ–≥', '–°–∞–≤—á–µ–Ω–∫–æ', '1999-05-10', 1450),
    ('–Ü—Ä–∏–Ω–∞', '–ö–æ–≤–∞–ª—å–æ–≤–∞', '1998-11-22', 1520);
```

</details>

::

::

---

## –†–µ–∑—é–º–µ

::tip
**–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏ INSERT –∑–∞–ø–∏—Ç—ñ–≤**:

1. **–ë–∞–∑–æ–≤–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å**: `INSERT INTO table (columns) VALUES (values)`
2. **–ó–∞–≤–∂–¥–∏ –≤–∫–∞–∑—É–π—Ç–µ —Å—Ç–æ–≤–ø—Ü—ñ** –¥–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–æ—Å—Ç—ñ –∫–æ–¥—É
3. **IDENTITY** –≥–µ–Ω–µ—Ä—É—î ID –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (–Ω–µ –≤–∫–∞–∑—É–π—Ç–µ –≤ INSERT)
4. **–ú–Ω–æ–∂–∏–Ω–Ω—ñ VALUES** ‚Äî —à–≤–∏–¥—à–µ –∑–∞ –æ–∫—Ä–µ–º—ñ INSERT
5. **INSERT SELECT** ‚Äî –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ —ñ–Ω—à–∏—Ö —Ç–∞–±–ª–∏—Ü—å
6. **OUTPUT** ‚Äî –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –≤—Å—Ç–∞–≤–ª–µ–Ω–∏—Ö –¥–∞–Ω–∏—Ö
7. **SCOPE_IDENTITY()** ‚Äî –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–æ–≥–æ ID
8. **Constraints** –ø–µ—Ä–µ–≤—ñ—Ä—è—é—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ (NOT NULL, CHECK, UNIQUE, FK)
9. **–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó** ‚Äî –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π
10. **@@ROWCOUNT** ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –≤—Å—Ç–∞–≤–ª–µ–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤

**–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫**: –ù–∞–≤—á—ñ—Ç—å—Å—è –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ —Ç–∞ –≤–∏–¥–∞–ª—è—Ç–∏ –¥–∞–Ω—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é UPDATE —Ç–∞ DELETE.
::

---

**–ü–æ–≤'—è–∑–∞–Ω—ñ —Ç–µ–º–∏**:

- [–ü–æ–ø–µ—Ä–µ–¥–Ω—è: SELECT - –†–æ–∑—à–∏—Ä–µ–Ω—ñ](./04.select-queries-advanced.md)
- [–ù–∞—Å—Ç—É–ø–Ω–∞: UPDATE —Ç–∞ DELETE –∑–∞–ø–∏—Ç–∏](./06.update-delete-queries.md)
- [–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó](./07.transactions.md)
- [CREATE TABLE —Ç–∞ Constraints](./01.ddl-create-table.md)
