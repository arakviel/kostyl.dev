---
title: –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –≤ SQL
description: –î–µ—Ç–∞–ª—å–Ω–∏–π —Ä–æ–∑–±—ñ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π - ACID –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ, BEGIN/COMMIT/ROLLBACK, savepoints, —Ä—ñ–≤–Ω—ñ —ñ–∑–æ–ª—è—Ü—ñ—ó, –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó
---

# –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó –≤ SQL

## –ü—Ä–æ–±–ª–µ–º–∞: –ö—É–ø—ñ–≤–ª—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –∫–≤–∏—Ç–∫–∞

–£—è–≤—ñ—Ç—å, —â–æ –≤–∏ –∫—É–ø—É—î—Ç–µ **–æ—Å—Ç–∞–Ω–Ω—ñ–π –∫–≤–∏—Ç–æ–∫** –Ω–∞ –∫–æ–Ω—Ü–µ—Ä—Ç —É–ª—é–±–ª–µ–Ω–æ–≥–æ –≥—É—Ä—Ç—É. –í–∞—à–∞ –ø–æ–∫—É–ø–∫–∞ —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –¥–≤–æ—Ö –∫—Ä–æ–∫—ñ–≤:

1.  üí∏ **–°–ø–∏—Å–∞—Ç–∏ –≥—Ä–æ—à—ñ** –∑ –≤–∞—à–æ–≥–æ –±–∞–ª–∞–Ω—Å—É.
2.  üéüÔ∏è **–ó–∞–±—Ä–æ–Ω—é–≤–∞—Ç–∏ –º—ñ—Å—Ü–µ** –≤ –∑–∞–ª—ñ.

**–°—Ü–µ–Ω–∞—Ä—ñ–π –∂–∞—Ö—É**: –ì—Ä–æ—à—ñ —Å–ø–∏—Å–∞–ª–∏—Å—è, –∞–ª–µ –ø–µ—Ä–µ–¥ –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è–º –º—ñ—Å—Ü—è **—Å–µ—Ä–≤–µ—Ä –≤–∏–º–∫–Ω—É–≤—Å—è** (–∑–Ω–∏–∫–ª–æ —Å–≤—ñ—Ç–ª–æ, –ø–æ–º–∏–ª–∫–∞ –º–µ—Ä–µ–∂—ñ).
**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í–∏ –±–µ–∑ –≥—Ä–æ—à–µ–π —ñ –±–µ–∑ –∫–≤–∏—Ç–∫–∞. üò±

::mermaid

```mermaid
sequenceDiagram
participant User as –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á
participant DB as –ë–∞–∑–∞ –î–∞–Ω–∏—Ö
participant Wallet as –ì–∞–º–∞–Ω–µ—Ü—å
participant Seats as –ú—ñ—Å—Ü—è

    User->>DB: BEGIN TRANSACTION
    DB->>Wallet: UPDATE: -2000‚Ç¥
    Wallet-->>DB: ‚úÖ OK

    critical üí• –ê–í–ê–†–Ü–Ø –¢–£–¢!
        DB->>DB: –°–∏—Å—Ç–µ–º–∞ –≤–ø–∞–ª–∞!
        DB->>DB: ROLLBACK (–ê–í–¢–û–ú–ê–¢–ò–ß–ù–û)
        DB->>Wallet: üîô –ü–æ–≤–µ—Ä–Ω—É—Ç–∏ –≥—Ä–æ—à—ñ
    end

    DB->>Seats: UPDATE: –ó–∞–π–Ω—è—Ç–∏ –º—ñ—Å—Ü–µ 1A
    Seats-->>DB: ‚úÖ OK
    DB->>User: COMMIT - –£—Å–ø—ñ—à–Ω–∞ –ø–æ–∫—É–ø–∫–∞!
```

::

**–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è** ‚Äî —Ü–µ **–≥—Ä—É–ø–∞ –æ–ø–µ—Ä–∞—Ü—ñ–π**, —è–∫—ñ –≤–∏–∫–æ–Ω—É—é—Ç—å—Å—è —è–∫ **–æ–¥–Ω–µ —Ü—ñ–ª–µ**: –∞–±–æ **–≤—Å—ñ —É—Å–ø—ñ—à–Ω–æ**, –∞–±–æ **–∂–æ–¥–Ω–∞**.

::tip
**–†–µ–∞–ª—å–Ω—ñ –ø—Ä–∏–∫–ª–∞–¥–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π**:

- –ü–µ—Ä–µ–∫–∞–∑ –≥—Ä–æ—à–µ–π –º—ñ–∂ —Ä–∞—Ö—É–Ω–∫–∞–º–∏
- –û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è (—Å—Ç–≤–æ—Ä–∏—Ç–∏ Order + OrderItems + –∑–º–µ–Ω—à–∏—Ç–∏ Stock)
- –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (—Å—Ç–≤–æ—Ä–∏—Ç–∏ User + Profile + –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ Email)

::

---

## ACID –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

## ACID –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ

–©–æ–± –≥–∞—Ä–∞–Ω—Ç—É–≤–∞—Ç–∏ –Ω–∞–¥—ñ–π–Ω—ñ—Å—Ç—å, –∫–æ–∂–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –ø–æ–≤–∏–Ω–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ 4 –ø—Ä–∏–Ω—Ü–∏–ø–∞–º (**ACID**).

–£—è–≤—ñ—Ç—å, —â–æ –≤–∏ –∑–∞–º–æ–≤–ª—è—î—Ç–µ **–ª–∞—Ç–µ –≤ –∫–∞–≤'—è—Ä–Ω—ñ**:

::card-group

::card{title="A - Atomicity (–ê—Ç–æ–º–∞—Ä–Ω—ñ—Å—Ç—å)" icon="i-lucide-atom"}

**–ü—Ä–∏–Ω—Ü–∏–ø**: "–í—Å–µ –∞–±–æ –Ω—ñ—á–æ–≥–æ".

**–ê–Ω–∞–ª–æ–≥—ñ—è**: –ù–µ –º–æ–∂–Ω–∞ "—Ç—Ä–æ—à–∫–∏ –∫—É–ø–∏—Ç–∏ –∫–∞–≤—É". –ê–±–æ –≤–∏ –ø–ª–∞—Ç–∏—Ç–µ —ñ –æ—Ç—Ä–∏–º—É—î—Ç–µ –Ω–∞–ø—ñ–π, –∞–±–æ –≤–∏ –Ω–µ –ø–ª–∞—Ç–∏—Ç–µ —ñ –Ω–µ –æ—Ç—Ä–∏–º—É—î—Ç–µ –Ω—ñ—á–æ–≥–æ. –Ø–∫—â–æ –∫–∞–≤–æ–º–∞—à–∏–Ω–∞ –∑–ª–∞–º–∞–ª–∞—Å—è –ø–æ—Å–µ—Ä–µ–¥ –ø—Ä–∏–≥–æ—Ç—É–≤–∞–Ω–Ω—è, –±–∞—Ä–∏—Å—Ç–∞ –ø–æ–≤–µ—Ä—Ç–∞—î –≥—Ä–æ—à—ñ.

**–í SQL**:

```sql
BEGIN TRANSACTION;
    -- –°–ø—Ä–æ–±–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞
    INSERT INTO Students (LastName) VALUES ('Test'); -- –ü–æ–º–∏–ª–∫–∞! (NOT NULL)
    -- –Ø–∫—â–æ –æ–¥–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ –≤–ø–∞–ª–∞, —Å–∫–∞—Å–æ–≤—É—î—Ç—å—Å—è –í–°–ï
ROLLBACK;
```

::

::card{title="C - Consistency (–£–∑–≥–æ–¥–∂–µ–Ω—ñ—Å—Ç—å)" icon="i-lucide-check-circle"}

**–ü—Ä–∏–Ω—Ü–∏–ø**: "–¢—ñ–ª—å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ —Å—Ç–∞–Ω–∏".

**–ê–Ω–∞–ª–æ–≥—ñ—è**: –ö–∞–≤–∞ –Ω–µ –º–æ–∂–µ –∫–æ—à—Ç—É–≤–∞—Ç–∏ -50 –≥—Ä–Ω. –ö—ñ–ª—å–∫—ñ—Å—Ç—å –º–æ–ª–æ–∫–∞ –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ "—Å–∏–Ω—ñ–º". –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –∑ –æ–¥–Ω–æ–≥–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å—Ç–∞–Ω—É –≤ —ñ–Ω—à–∏–π.

**–í SQL**:

```sql
-- `Grants` (–°—Ç–∏–ø–µ–Ω–¥—ñ—è) –Ω–µ –º–æ–∂–µ –±—É—Ç–∏ –≤—ñ–¥'—î–º–Ω–æ—é (CHECK constraint)
BEGIN TRANSACTION;
    UPDATE Students SET Grants = -100 WHERE Id = 1; -- ‚ùå –ü–æ–º–∏–ª–∫–∞ –ë–î!
    -- –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –Ω–µ –¥–æ–∑–≤–æ–ª–∏—Ç—å –ø–æ—Ä—É—à–∏—Ç–∏ –ø—Ä–∞–≤–∏–ª–∞
ROLLBACK;
```

::

::card{title="I - Isolation (–Ü–∑–æ–ª—è—Ü—ñ—è)" icon="i-lucide-shield"}

**–ü—Ä–∏–Ω—Ü–∏–ø**: "–ù—ñ—Ö—Ç–æ –Ω–µ –ø—ñ–¥–≥–ª—è–¥–∞—î".

**–ê–Ω–∞–ª–æ–≥—ñ—è**: –ü–æ–∫–∏ –±–∞—Ä–∏—Å—Ç–∞ –≥–æ—Ç—É—î –≤–∞—à–µ –ª–∞—Ç–µ, —ñ–Ω—à–∏–π –∫–ª—ñ—î–Ω—Ç –Ω–µ –º–æ–∂–µ –∑–∞–±—Ä–∞—Ç–∏ –≤–∞—à–µ –º–æ–ª–æ–∫–æ —á–∏ –≤–∏–ø–∏—Ç–∏ –ø–æ–ª–æ–≤–∏–Ω—É –Ω–∞–ø–æ—é. –ö–æ–∂–Ω–µ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è –æ–±—Ä–æ–±–ª—è—î—Ç—å—Å—è —Ç–∞–∫, –Ω—ñ–±–∏ –≤–æ–Ω–æ —î–¥–∏–Ω–µ –≤ —Å–≤—ñ—Ç—ñ.

**–í SQL**:

```sql
-- –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è 1 –∑–º—ñ–Ω—é—î –ø—Ä—ñ–∑–≤–∏—â–µ —Å—Ç—É–¥–µ–Ω—Ç–∞
UPDATE Students SET LastName = '–ù–æ–≤–µ' WHERE Id = 1;

-- –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è 2 (–ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ) —á–∏—Ç–∞—î Id = 1
-- –í–æ–Ω–∞ –ù–ï –ø–æ–±–∞—á–∏—Ç—å '–ù–æ–≤–µ', –ø–æ–∫–∏ –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è 1 –Ω–µ —Å–∫–∞–∂–µ COMMIT
```

::

::card{title="D - Durability (–î–æ–≤–≥–æ–≤—ñ—á–Ω—ñ—Å—Ç—å)" icon="i-lucide-database"}

**–ü—Ä–∏–Ω—Ü–∏–ø**: "–ó–∞–ø–∏—Å–∞–Ω–æ ‚Äî –∑–Ω–∞—á–∏—Ç—å –∑–∞–ø–∏—Å–∞–Ω–æ".

**–ê–Ω–∞–ª–æ–≥—ñ—è**: –Ø–∫—â–æ —á–µ–∫ –Ω–∞–¥—Ä—É–∫–æ–≤–∞–Ω–æ (COMMIT), —Ç–æ –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤ –∫–∞–≤'—è—Ä–Ω—ñ –≤–∏–º–∫–Ω–µ—Ç—å—Å—è —Å–≤—ñ—Ç–ª–æ —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É, –≤–∞—à–∞ –ø–æ–∫—É–ø–∫–∞ –∑–∞—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∞. –ö–æ–ª–∏ —Å–≤—ñ—Ç–ª–æ —É–≤—ñ–º–∫–Ω—É—Ç—å, –∑–∞–ø–∏—Å –ø—Ä–æ –ø—Ä–æ–¥–∞–∂ –≤—Å–µ –æ–¥–Ω–æ –±—É–¥–µ –≤ —Å–∏—Å—Ç–µ–º—ñ.

**–í SQL**:

```sql
COMMIT;
-- ‚úÖ –í—Å–µ. –ù–∞–≤—ñ—Ç—å —è–∫—â–æ —Å–µ—Ä–≤–µ—Ä –∑–≥–æ—Ä–∏—Ç—å, –¥–∞–Ω—ñ –Ω–∞ –¥–∏—Å–∫—É.
```

::

::

---

## –ë–∞–∑–æ–≤–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó

```sql
BEGIN TRANSACTION;  -- –ê–±–æ –ø—Ä–æ—Å—Ç–æ BEGIN TRAN

    -- SQL –æ–ø–µ—Ä–∞—Ü—ñ—ó (INSERT, UPDATE, DELETE)

    IF <—É–º–æ–≤–∞_—É—Å–ø—ñ—Ö—É>
        COMMIT;  -- –ó–±–µ—Ä–µ–≥—Ç–∏ –≤—Å—ñ –∑–º—ñ–Ω–∏
    ELSE
        ROLLBACK;  -- –°–∫–∞—Å—É–≤–∞—Ç–∏ –≤—Å—ñ –∑–º—ñ–Ω–∏
```

### –ü—Ä–∏–∫–ª–∞–¥ 1: –£—Å–ø—ñ—à–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è

```sql
BEGIN TRANSACTION;

    INSERT INTO Students (FirstName, LastName, BirthDate)
    VALUES ('–¢–µ—Å—Ç', '–¢–µ—Å—Ç–æ–≤', '2000-01-01');

    UPDATE Students SET Grants = Grants * 1.1
    WHERE LastName = '–ü–µ—Ç—Ä–µ–Ω–∫–æ';

COMMIT;  -- ‚úÖ –û–±–∏–¥–≤—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó –∑–±–µ—Ä–µ–∂–µ–Ω–æ
```

### –ü—Ä–∏–∫–ª–∞–¥ 2: –°–∫–∞—Å—É–≤–∞–Ω–Ω—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó

```sql
BEGIN TRANSACTION;

    DELETE FROM Students WHERE Id = 1;

    -- –ü–æ–º–∏–ª–∫–∞! –ü–µ—Ä–µ–¥—É–º–∞–ª–∏

ROLLBACK;  -- ‚ùå DELETE —Å–∫–∞—Å–æ–≤–∞–Ω–æ, —Å—Ç—É–¥–µ–Ω—Ç –∑–∞–ª–∏—à–∏–≤—Å—è
```

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥: –Ü–Ω–¥–µ–∫—Å–∞—Ü—ñ—è —Å—Ç–∏–ø–µ–Ω–¥—ñ–π

–£—è–≤—ñ—Ç—å —Å–∏—Ç—É–∞—Ü—ñ—é: —Ä–µ–∫—Ç–æ—Ä –Ω–∞–∫–∞–∑–∞–≤ **–ø—ñ–¥–Ω—è—Ç–∏ –≤—Å—ñ–º —Å—Ç–∏–ø–µ–Ω–¥—ñ—é –Ω–∞ 10%**.
–ê–ª–µ —î —É–º–æ–≤–∞: **–º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ —Å—Ç–∏–ø–µ–Ω–¥—ñ—è –Ω–µ –º–æ–∂–µ –ø–µ—Ä–µ–≤–∏—â—É–≤–∞—Ç–∏ 3000‚Ç¥**.

–Ø–∫—â–æ —Ö–æ—á–∞ –± –æ–¥–∏–Ω —Å—Ç—É–¥–µ–Ω—Ç –ø—ñ—Å–ª—è –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –æ—Ç—Ä–∏–º–∞—î > 3000‚Ç¥ ‚Äî **—Å–∫–∞—Å—É–≤–∞—Ç–∏ –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è –¥–ª—è –í–°–Ü–•**.

```sql
use University;

-- –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ –ø–æ—Ç–æ—á–Ω—ñ –¥–∞–Ω—ñ
SELECT * FROM Students;

BEGIN TRANSACTION;

    DECLARE @MaxGrantAllowed DECIMAL(10, 2) = 3000.00;

    -- –ö—Ä–æ–∫ 1: –ü—ñ–¥–Ω—ñ–º–∞—î–º–æ —Å—Ç–∏–ø–µ–Ω–¥—ñ—é –≤—Å—ñ–º –Ω–∞ 10%
    UPDATE Students
    SET Grants = Grants * 1.10
    WHERE Grants IS NOT NULL;

    -- –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ "–ß–∏ –Ω–µ –ø–æ—Ä—É—à–∏–ª–∏ –º–∏ –ª—ñ–º—ñ—Ç?"
    IF EXISTS (SELECT 1 FROM Students WHERE Grants > @MaxGrantAllowed)
    BEGIN
        -- –û –Ω—ñ! –•—Ç–æ—Å—å –æ—Ç—Ä–∏–º–∞–≤ –∑–∞–±–∞–≥–∞—Ç–æ.
        ROLLBACK;
        PRINT '‚ùå –ü–æ–º–∏–ª–∫–∞: –Ü–Ω–¥–µ–∫—Å–∞—Ü—ñ—é —Å–∫–∞—Å–æ–≤–∞–Ω–æ. –ü–µ—Ä–µ–≤–∏—â–µ–Ω–æ –ª—ñ–º—ñ—Ç –±—é–¥–∂–µ—Ç—É.';
    END
    ELSE
    BEGIN
        -- –í—Å–µ, –¥–æ–±—Ä–µ, –ª—ñ–º—ñ—Ç –Ω–µ –ø–æ—Ä—É—à–µ–Ω–æ
        COMMIT;
        PRINT '‚úÖ –£—Å–ø—ñ—Ö: –°—Ç–∏–ø–µ–Ω–¥—ñ—ó –ø—Ä–æ—ñ–Ω–¥–µ–∫—Å–æ–≤–∞–Ω–æ.';
    END

-- –ü–µ—Ä–µ–≤—ñ—Ä–∏–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç (–∑–º—ñ–Ω–∏–ª–æ—Å—å –∞–±–æ –Ω—ñ)
SELECT * FROM Students;
```

---

## TRY...CATCH –∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è–º–∏

**Best Practice**: –ó–∞–≤–∂–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ TRY...CATCH –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è—Ö.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å

```sql
BEGIN TRY
    BEGIN TRANSACTION;

        -- SQL –æ–ø–µ—Ä–∞—Ü—ñ—ó

    COMMIT;
END TRY
BEGIN CATCH
    -- –Ø–∫—â–æ —Å—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞
    IF @@TRANCOUNT > 0
        ROLLBACK;  -- –°–∫–∞—Å—É–≤–∞—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é

    -- –ü–æ–∫–∞–∑–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É
    PRINT ERROR_MESSAGE();
END CATCH
```

### –ü—Ä–∏–∫–ª–∞–¥: –ë–µ–∑–ø–µ—á–Ω–∞ –≤—Å—Ç–∞–≤–∫–∞

```sql
BEGIN TRY
    BEGIN TRANSACTION;

        -- –î–æ–¥–∞—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞
        INSERT INTO Students (FirstName, LastName, BirthDate, Email)
        VALUES ('–ù–æ–≤–∏–π', '–°—Ç—É–¥–µ–Ω—Ç', '2000-01-01', 'test@example.com');

        -- –î–æ–¥–∞—Ç–∏ –∑–∞—Ä–∞—Ö—É–≤–∞–Ω–Ω—è
        INSERT INTO Enrollments (StudentId, CourseId, EnrollmentDate)
        VALUES (SCOPE_IDENTITY(), 1, GETDATE());

        -- –Ø–∫—â–æ –æ–±–∏–¥–≤—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó —É—Å–ø—ñ—à–Ω—ñ
    COMMIT;
    PRINT '–°—Ç—É–¥–µ–Ω—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–∏–π';
END TRY
BEGIN CATCH
    -- –Ø–∫—â–æ —â–æ—Å—å –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫ (duplicate email, –Ω–µ—ñ—Å–Ω—É—é—á–∏–π CourseId —Ç–æ—â–æ)
    IF @@TRANCOUNT > 0
        ROLLBACK;

    PRINT '–ü–æ–º–∏–ª–∫–∞: ' + ERROR_MESSAGE();
END CATCH
```

### –ö–æ—Ä–∏—Å–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –ø–æ–º–∏–ª–æ–∫

```sql
BEGIN CATCH
    SELECT
        ERROR_NUMBER() AS ErrorNumber,
        ERROR_MESSAGE() AS ErrorMessage,
        ERROR_LINE() AS ErrorLine,
        ERROR_PROCEDURE() AS ErrorProcedure,
        ERROR_SEVERITY() AS ErrorSeverity,
        ERROR_STATE() AS ErrorState;

    ROLLBACK;
END CATCH
```

---

## SAVEPOINT: –ß–∞—Å—Ç–∫–æ–≤–µ –≤—ñ–¥–∫–æ—á—É–≤–∞–Ω–Ω—è

**SAVEPOINT** (–∞–±–æ **SAVE TRANSACTION**) –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä–∏—Ç–∏ "checkpoint" –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å

```sql
BEGIN TRANSACTION;

    -- –û–ø–µ—Ä–∞—Ü—ñ—è 1
    INSERT INTO Table1 VALUES (...);

    SAVE TRANSACTION SavePoint1;  -- Checkpoint

    -- –û–ø–µ—Ä–∞—Ü—ñ—è 2
    UPDATE Table2 SET ...;

    -- –©–æ—Å—å –ø—ñ—à–ª–æ –Ω–µ —Ç–∞–∫ –∑ –û–ø–µ—Ä–∞—Ü—ñ—î—é 2
    ROLLBACK TRANSACTION SavePoint1;  -- –í—ñ–¥–∫–æ—Ç–∏—Ç–∏ –¥–æ checkpoint
    -- –û–ø–µ—Ä–∞—Ü—ñ—è 1 –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è, –û–ø–µ—Ä–∞—Ü—ñ—è 2 —Å–∫–∞—Å–æ–≤–∞–Ω–∞

COMMIT;
```

### –ü—Ä–∏–∫–ª–∞–¥: –ü–∞–∫–µ—Ç–Ω–∞ –≤—Å—Ç–∞–≤–∫–∞ –∑ —á–∞—Å—Ç–∫–æ–≤–∏–º –æ—Ç–∫–∞—Ç–æ–º

```sql
BEGIN TRANSACTION;

    -- –í—Å—Ç–∞–≤–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–∞ 1
    INSERT INTO Students (FirstName, LastName, BirthDate)
    VALUES ('–°—Ç—É–¥–µ–Ω—Ç1', '–ü—Ä—ñ–∑–≤–∏—â–µ1', '1998-01-01');

    SAVE TRANSACTION AfterStudent1;

    -- –°–ø—Ä–æ–±–∞ –≤—Å—Ç–∞–≤–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ 2
    BEGIN TRY
        INSERT INTO Students (FirstName, LastName, BirthDate)
        VALUES ('–°—Ç—É–¥–µ–Ω—Ç2', '–ü—Ä—ñ–∑–≤–∏—â–µ2', 'INVALID_DATE');  -- –ü–æ–º–∏–ª–∫–∞!
    END TRY
    BEGIN CATCH
        -- –í—ñ–¥–∫–æ—Ç–∏—Ç–∏ —Ç—ñ–ª—å–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ 2
        ROLLBACK TRANSACTION AfterStudent1;
        PRINT '–°—Ç—É–¥–µ–Ω—Ç 2 –Ω–µ –¥–æ–¥–∞–Ω–æ —á–µ—Ä–µ–∑ –ø–æ–º–∏–ª–∫—É';
    END CATCH

    -- –í—Å—Ç–∞–≤–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–∞ 3
    INSERT INTO Students (FirstName, LastName, BirthDate)
    VALUES ('–°—Ç—É–¥–µ–Ω—Ç3', '–ü—Ä—ñ–∑–≤–∏—â–µ3', '1999-03-03');

COMMIT;

-- –†–µ–∑—É–ª—å—Ç–∞—Ç: –°—Ç—É–¥–µ–Ω—Ç–∏ 1 —Ç–∞ 3 –¥–æ–¥–∞–Ω—ñ, —Å—Ç—É–¥–µ–Ω—Ç 2 - –Ω—ñ
```

---

## –†—ñ–≤–Ω—ñ —ñ–∑–æ–ª—è—Ü—ñ—ó (Isolation Levels)

–†—ñ–≤–µ–Ω—å —ñ–∑–æ–ª—è—Ü—ñ—ó –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è: **"–ù–∞—Å–∫—ñ–ª—å–∫–∏ –º–∏ –¥–æ–∑–≤–æ–ª—è—î–º–æ —ñ–Ω—à–∏–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è–º –∑–∞–≤–∞–∂–∞—Ç–∏ –Ω–∞–º?"**

–£—è–≤—ñ—Ç—å, —â–æ –≤–∏ —á–∏—Ç–∞—î—Ç–µ –∫–Ω–∏–≥—É —É –±—ñ–±–ª—ñ–æ—Ç–µ—Ü—ñ, –∞ —Ö—Ç–æ—Å—å —ñ–Ω—à–∏–π –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤–∏–ø—Ä–∞–≤–∏—Ç–∏ –≤ –Ω—ñ–π —Ç–µ–∫—Å—Ç –æ–ª—ñ–≤—Ü–µ–º.

### 4 —Ä—ñ–≤–Ω—ñ —ñ–∑–æ–ª—è—Ü—ñ—ó (–≤—ñ–¥ —Ö–∞–æ—Å—É –¥–æ –ø–æ—Ä—è–¥–∫—É)

::tabs

::tabs-item{label="1. READ UNCOMMITTED (–ß–µ—Ä–Ω–µ—Ç–∫–∞)"}

**–ê–Ω–∞–ª–æ–≥—ñ—è**: –í–∏ —á–∏—Ç–∞—î—Ç–µ —Å—Ç–∞—Ç—Ç—é –≤ –±–ª–æ–∑—ñ, —è–∫—É –∞–≤—Ç–æ—Ä **–ø—Ä—è–º–æ –∑–∞—Ä–∞–∑ –ø–∏—à–µ**. –í–∏ –±–∞—á–∏—Ç–µ –ø–æ–º–∏–ª–∫–∏, –Ω–µ–¥–æ–ø–∏—Å–∞–Ω—ñ —Ä–µ—á–µ–Ω–Ω—è. –ê–≤—Ç–æ—Ä –º–æ–∂–µ –≤—Å–µ —Å—Ç–µ—Ä—Ç–∏ (ROLLBACK), –∞ –≤–∏ –≤–∂–µ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ —ñ –ø–æ–≤—ñ—Ä–∏–ª–∏.

**–í SQL**: –î–æ–∑–≤–æ–ª—è—î "–±—Ä—É–¥–Ω–µ —á–∏—Ç–∞–Ω–Ω—è" (Dirty Read). –ù–∞–π—à–≤–∏–¥—à–∏–π, –∞–ª–µ –Ω–∞–π–Ω–µ–±–µ–∑–ø–µ—á–Ω—ñ—à–∏–π.

```sql
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

BEGIN TRANSACTION;
    -- –ú–∏ –±–∞—á–∏–º–æ –∑–º—ñ–Ω–∏ —ñ–Ω—à–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–æ–Ω–∏ —â–µ –Ω–µ COMMIT!
    -- –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —Ö—Ç–æ—Å—å –∑–º—ñ–Ω–∏–≤ —Å—Ç–∏–ø–µ–Ω–¥—ñ—é –Ω–∞ 99999, –∞–ª–µ —â–µ –Ω–µ –∑–±–µ—Ä—ñ–≥.
    SELECT * FROM Students;
COMMIT;
```

**–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏**: –î–ª—è –ø—Ä–∏–±–ª–∏–∑–Ω–æ—ó –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "–°–∫—ñ–ª—å–∫–∏ –ø—Ä–∏–±–ª–∏–∑–Ω–æ –ª—é–¥–µ–π –∑–∞—Ä–∞–∑ –Ω–∞ —Å–∞–π—Ç—ñ?"), –¥–µ —Ç–æ—á–Ω—ñ—Å—Ç—å 100% –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞.

::

::tabs-item{label="2. READ COMMITTED (–û–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω–µ)"}

**–ê–Ω–∞–ª–æ–≥—ñ—è**: –í–∏ —á–∏—Ç–∞—î—Ç–µ —Ç—ñ–ª—å–∫–∏ **–æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω—ñ** —Å—Ç–∞—Ç—Ç—ñ. –Ø–∫—â–æ –∞–≤—Ç–æ—Ä –ø–∏—à–µ –Ω–æ–≤—É –≤–µ—Ä—Å—ñ—é, –≤–∏ –±–∞—á–∏—Ç–µ —Å—Ç–∞—Ä—É, –ø–æ–∫–∏ –≤—ñ–Ω –Ω–µ –Ω–∞—Ç–∏—Å–Ω–µ "–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏" (COMMIT). –¶–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –ø–æ–≤–µ–¥—ñ–Ω–∫–∏ —É –±—ñ–ª—å—à–æ—Å—Ç—ñ –ë–î.

**–í SQL**: –í–∏ –Ω–µ –±–∞—á–∏—Ç–µ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π. –ê–ª–µ —è–∫—â–æ –≤–∏ –ø—Ä–æ—á–∏—Ç–∞—î—Ç–µ —Ä—è–¥–æ–∫ –¥–≤—ñ—á—ñ, –≤—ñ–Ω –º–æ–∂–µ –∑–º—ñ–Ω–∏—Ç–∏—Å—è –º—ñ–∂ —á–∏—Ç–∞–Ω–Ω—è–º–∏ (–±–æ —Ö—Ç–æ—Å—å –≤—Å—Ç–∏–≥ –∑—Ä–æ–±–∏—Ç–∏ COMMIT).

```sql
SET TRANSACTION ISOLATION LEVEL READ COMMITTED; -- Default

BEGIN TRANSACTION;
    -- –ß–∏—Ç–∞–Ω–Ω—è 1: –°—Ç–∏–ø–µ–Ω–¥—ñ—è = 1000
    SELECT Grants FROM Students WHERE Id = 1;

    -- ... —Ç—É—Ç —Ö—Ç–æ—Å—å —ñ–Ω—à–∏–π –≤—Å—Ç–∏–≥ –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞ 2000 —ñ –∑—Ä–æ–±–∏—Ç–∏ COMMIT ...

    -- –ß–∏—Ç–∞–Ω–Ω—è 2: –°—Ç–∏–ø–µ–Ω–¥—ñ—è = 2000 (–¥–∞–Ω—ñ –∑–º—ñ–Ω–∏–ª–∏—Å—è –ø—Ä—è–º–æ –ø—ñ–¥ —á–∞—Å –Ω–∞—à–æ—ó —Ä–æ–±–æ—Ç–∏!)
    SELECT Grants FROM Students WHERE Id = 1;
COMMIT;
```

::

::tabs-item{label="3. REPEATABLE READ (–ó–∞–º–æ—Ä–æ–∂–µ–Ω–µ)"}

**–ê–Ω–∞–ª–æ–≥—ñ—è**: –í–∏ –±–µ—Ä–µ—Ç–µ –∫–Ω–∏–≥—É —ñ **—Ç—Ä–∏–º–∞—î—Ç–µ —ó—ó –≤ —Ä—É–∫–∞—Ö**. –ù—ñ—Ö—Ç–æ –Ω–µ –º–æ–∂–µ –≤–∏—Ä–≤–∞—Ç–∏ —ó—ó —É –≤–∞—Å —á–∏ –¥–æ–ø–∏—Å–∞—Ç–∏ —â–æ—Å—å, –ø–æ–∫–∏ –≤–∏ –Ω–µ –ø–æ–∫–ª–∞–¥–µ—Ç–µ —ó—ó –Ω–∞–∑–∞–¥ (COMMIT).

**–í SQL**: –ì–∞—Ä–∞–Ω—Ç—É—î, —â–æ —è–∫—â–æ –≤–∏ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ —Ä—è–¥–æ–∫, –≤—ñ–Ω **–Ω–µ –∑–º—ñ–Ω–∏—Ç—å—Å—è** –¥–æ –∫—ñ–Ω—Ü—è –≤–∞—à–æ—ó —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó. –Ü–Ω—à—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó, —è–∫—ñ —Ö–æ—á—É—Ç—å –∑–º—ñ–Ω–∏—Ç–∏ —Ü–µ–π —Ä—è–¥–æ–∫, –±—É–¥—É—Ç—å **—á–µ–∫–∞—Ç–∏** (–≤–∏—Å—ñ—Ç–∏), –ø–æ–∫–∏ –≤–∏ –Ω–µ –∑–∞–∫—ñ–Ω—á–∏—Ç–µ.

```sql
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;

BEGIN TRANSACTION;
    SELECT * FROM Students WHERE Id = 1;
    -- –¢–µ–ø–µ—Ä —Ä—è–¥–æ–∫ Id=1 "–∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∏–π" –¥–ª—è –∑–º—ñ–Ω —ñ–Ω—à–∏–º–∏.
    -- –ù—ñ—Ö—Ç–æ –Ω–µ –º–æ–∂–µ –∑—Ä–æ–±–∏—Ç–∏ UPDATE/DELETE –¥–ª—è Id=1.

    -- ... —Ä–æ–±–∏–º–æ –¥–æ–≤–≥—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è ...

    SELECT * FROM Students WHERE Id = 1; -- –ì–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–æ —Ç—ñ –∂ –¥–∞–Ω—ñ
COMMIT;
```

::

::tabs-item{label="4. SERIALIZABLE (–ü–æ–≤–Ω–∞ –±–ª–æ–∫–∞–¥–∞)"}

**–ê–Ω–∞–ª–æ–≥—ñ—è**: –í–∏ –∑–∞—á–∏–Ω—è—î—Ç–µ –±—ñ–±–ª—ñ–æ—Ç–µ–∫—É –Ω–∞ –∫–ª—é—á. –í–∏ —Ç–∞–º –æ–¥–∏–Ω. –ù—ñ—Ö—Ç–æ –Ω–µ –º–æ–∂–µ —É–≤—ñ–π—Ç–∏, –Ω—ñ—Ö—Ç–æ –Ω–µ –º–æ–∂–µ –Ω—ñ—á–æ–≥–æ –∑–º—ñ–Ω–∏—Ç–∏ —á–∏ –¥–æ–¥–∞—Ç–∏, –ø–æ–∫–∏ –≤–∏ –Ω–µ –≤–∏–π–¥–µ—Ç–µ.

**–í SQL**: –ù–∞–π—Å—É–≤–æ—Ä—ñ—à–∏–π —Ä—ñ–≤–µ–Ω—å. –ó–∞–ø–æ–±—ñ–≥–∞—î –Ω–∞–≤—ñ—Ç—å –ø–æ—è–≤—ñ _–Ω–æ–≤–∏—Ö_ —Ä—è–¥–∫—ñ–≤ (Phantom Reads), —è–∫—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—é—Ç—å –≤–∞—à—ñ–π —É–º–æ–≤—ñ.

```sql
SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;

BEGIN TRANSACTION;
    SELECT * FROM Students WHERE Grants > 1000;
    -- –ù—ñ—Ö—Ç–æ –Ω–µ –º–æ–∂–µ –Ω–∞–≤—ñ—Ç—å –î–û–î–ê–¢–ò (INSERT) –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ –∑—ñ —Å—Ç–∏–ø–µ–Ω–¥—ñ—î—é > 1000,
    -- –ø–æ–∫–∏ –º–∏ –Ω–µ –∑–∞–∫—ñ–Ω—á–∏–º–æ.
COMMIT;
```

::

::

### –ü—ñ–¥—Å—É–º–æ–∫ —Ä–∏–∑–∏–∫—ñ–≤

| –†—ñ–≤–µ–Ω—å               | Dirty Read<br/>(–ß–∏—Ç–∞–Ω–Ω—è —Å–º—ñ—Ç—Ç—è) | Non-Repeatable Read<br/>(–ó–º—ñ–Ω–∞ –¥–∞–Ω–∏—Ö –ø—ñ–¥ –ø–æ–ø–æ—é) | Phantom Read<br/>(–ü–æ—è–≤–∞ –Ω–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö) | –®–≤–∏–¥–∫—ñ—Å—Ç—å        |
| :------------------- | :-----------------------------: | :---------------------------------------------: | :----------------------------------: | :--------------- |
| **READ UNCOMMITTED** |             üî¥ –¢–∞–∫              |                     üî¥ –¢–∞–∫                      |                üî¥ –¢–∞–∫                | üöÄ –ú–∞–∫—Å          |
| **READ COMMITTED**   |              üü¢ –ù—ñ              |                     üî¥ –¢–∞–∫                      |                üî¥ –¢–∞–∫                | ‚ö° –®–≤–∏–¥–∫–æ        |
| **REPEATABLE READ**  |              üü¢ –ù—ñ              |                      üü¢ –ù—ñ                      |                üî¥ –¢–∞–∫                | üê¢ –ü–æ–≤—ñ–ª—å–Ω—ñ—à–µ    |
| **SERIALIZABLE**     |              üü¢ –ù—ñ              |                      üü¢ –ù—ñ                      |                üü¢ –ù—ñ                 | üêå –î—É–∂–µ –ø–æ–≤—ñ–ª—å–Ω–æ |

---

## @@TRANCOUNT: –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π

**@@TRANCOUNT** –ø–æ–∫–∞–∑—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∏—Ö (–Ω–µ–∑–∞–∫—Ä–∏—Ç–∏—Ö) —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.

```sql
PRINT @@TRANCOUNT;  -- 0 (–Ω–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–∏—Ö)

BEGIN TRANSACTION;
PRINT @@TRANCOUNT;  -- 1

    BEGIN TRANSACTION;  -- –í–∫–ª–∞–¥–µ–Ω–∞
    PRINT @@TRANCOUNT;  -- 2

    COMMIT;
    PRINT @@TRANCOUNT;  -- 1

COMMIT;
PRINT @@TRANCOUNT;  -- 0
```

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –ø–æ–º–∏–ª–∫–∞—Ö

```sql
BEGIN TRY
    BEGIN TRANSACTION;
        -- –û–ø–µ—Ä–∞—Ü—ñ—ó
    COMMIT;
END TRY
BEGIN CATCH
    -- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ —î –∞–∫—Ç–∏–≤–Ω–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è
    IF @@TRANCOUNT > 0
        ROLLBACK;

    PRINT ERROR_MESSAGE();
END CATCH
```

---

## Deadlocks (–í–∑–∞—î–º–Ω—ñ –±–ª–æ–∫—É–≤–∞–Ω–Ω—è)

**Deadlock** ‚Äî —Ü–µ —Å–∏—Ç—É–∞—Ü—ñ—è "–∫–ª—ñ–Ω—á", –∫–æ–ª–∏ –¥–≤—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó —á–µ–∫–∞—é—Ç—å –æ–¥–Ω–∞ –Ω–∞ –æ–¥–Ω—É —ñ –∂–æ–¥–Ω–∞ –Ω–µ –º–æ–∂–µ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏.

### –ü—Ä–∏–∫–ª–∞–¥ —ñ–∑ –∂–∏—Ç—Ç—è

–î–≤–∞ —Å—Ç—É–¥–µ–Ω—Ç–∏ —Ö–æ—á—É—Ç—å –æ–±–º—ñ–Ω—è—Ç–∏—Å—è –º—ñ—Å—Ü—è–º–∏ –≤ –≥—É—Ä—Ç–æ–∂–∏—Ç–∫—É:

- –°—Ç—É–¥–µ–Ω—Ç –ê –∑–∞–π–Ω—è–≤ –∫—ñ–º–Ω–∞—Ç—É 101 —ñ —á–µ–∫–∞—î, –ø–æ–∫–∏ –∑–≤—ñ–ª—å–Ω–∏—Ç—å—Å—è 102.
- –°—Ç—É–¥–µ–Ω—Ç –ë –∑–∞–π–Ω—è–≤ –∫—ñ–º–Ω–∞—Ç—É 102 —ñ —á–µ–∫–∞—î, –ø–æ–∫–∏ –∑–≤—ñ–ª—å–Ω–∏—Ç—å—Å—è 101.
  **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í–æ–Ω–∏ —á–µ–∫–∞—Ç–∏–º—É—Ç—å –≤—ñ—á–Ω–æ.

### –ü—Ä–∏–∫–ª–∞–¥ –≤ SQL (–∑ —Ç–∞–±–ª–∏—Ü–µ—é Students)

::code-group

```sql [–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è 1]
BEGIN TRANSACTION;
    -- 1. –ë–ª–æ–∫—É—î–º–æ –°—Ç—É–¥–µ–Ω—Ç–∞ 1
    UPDATE Students SET Grants = 2000 WHERE Id = 1;

    WAITFOR DELAY '00:00:05'; -- –Ü–º—ñ—Ç–∞—Ü—ñ—è –¥—É–º–∫–∏...

    -- 2. –•–æ—á–µ–º–æ –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –°—Ç—É–¥–µ–Ω—Ç–∞ 2 (–∞–ª–µ –≤—ñ–Ω –∑–∞–π–Ω—è—Ç–∏–π –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—î—é 2!)
    UPDATE Students SET Grants = 2000 WHERE Id = 2;
COMMIT;
```

```sql [–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è 2]
BEGIN TRANSACTION;
    -- 1. –ë–ª–æ–∫—É—î–º–æ –°—Ç—É–¥–µ–Ω—Ç–∞ 2
    UPDATE Students SET Grants = 3000 WHERE Id = 2;

    WAITFOR DELAY '00:00:05'; -- –Ü–º—ñ—Ç–∞—Ü—ñ—è –¥—É–º–∫–∏...

    -- 2. –•–æ—á–µ–º–æ –∑–∞–±–ª–æ–∫—É–≤–∞—Ç–∏ –°—Ç—É–¥–µ–Ω—Ç–∞ 1 (–∞–ª–µ –≤—ñ–Ω –∑–∞–π–Ω—è—Ç–∏–π –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—î—é 1!)
    UPDATE Students SET Grants = 3000 WHERE Id = 1;
COMMIT;

-- ‚ùå Deadlock! SQL Server –≤–±'—î –æ–¥–Ω—É –∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π (–∂–µ—Ä—Ç–≤—É).
```

::

### –Ø–∫ —É–Ω–∏–∫–Ω—É—Ç–∏ deadlocks

::card-group

::card{title="1. –û–¥–Ω–∞–∫–æ–≤–∏–π –ø–æ—Ä—è–¥–æ–∫" icon="i-lucide-arrow-right"}
**–ü—Ä–∞–≤–∏–ª–æ**: –ó–∞–≤–∂–¥–∏ –±–ª–æ–∫—É–π—Ç–µ —Ä–µ—Å—É—Ä—Å–∏ –≤ –æ–¥–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è–º ID).

```sql
-- ‚úÖ –ó–∞–≤–∂–¥–∏ —Å–ø–æ—á–∞—Ç–∫—É Id=1, –ø–æ—Ç—ñ–º Id=2
BEGIN TRANSACTION;
    UPDATE Students ... WHERE Id = 1;
    UPDATE Students ... WHERE Id = 2;
COMMIT;
```

::

::card{title="2. –ö–æ—Ä–æ—Ç—à—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó" icon="i-lucide-clock"}
–ß–∏–º —à–≤–∏–¥—à–µ –≤–∏ –∑—Ä–æ–±–∏—Ç–µ COMMIT, —Ç–∏–º –º–µ–Ω—à–µ —à–∞–Ω—Å—ñ–≤, —â–æ —Ö—Ç–æ—Å—å —ñ–Ω—à–∏–π –≤–∫–ª–∏–Ω–∏—Ç—å—Å—è.
::

::card{title="3. NOLOCK (—á–∏—Ç–∞–Ω–Ω—è –±–µ–∑ –±–ª–æ–∫—É–≤–∞–Ω—å)" icon="i-lucide-unlock"}
–Ø–∫—â–æ –≤–∞–º –ª–∏—à–µ _–ø–æ—á–∏—Ç–∞—Ç–∏_ —ñ –Ω–µ –≤–∞–∂–ª–∏–≤–∞ —Å—É–ø–µ—Ä-—Ç–æ—á–Ω—ñ—Å—Ç—å:

```sql
SELECT * FROM Students WITH (NOLOCK);
```

::

::

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó

### –°—Ü–µ–Ω–∞—Ä—ñ–π 1: –ë–µ–∑–ø–µ—á–Ω–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è —Å—Ç—É–¥–µ–Ω—Ç–∞

–ó–∞–¥–∞—á–∞: –ó–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞. –Ø–∫—â–æ —Ç–∞–∫–∏–π Email –≤–∂–µ —î ‚Äî –Ω–µ –≤—Å—Ç–∞–≤–ª—è—Ç–∏, –∞ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –ø–æ–º–∏–ª–∫—É. –Ø–∫—â–æ —Å—Ç—É–¥–µ–Ω—Ç—É < 16 —Ä–æ–∫—ñ–≤ ‚Äî –Ω–µ —Ä–µ—î—Å—Ç—Ä—É–≤–∞—Ç–∏.

```sql
BEGIN TRY
    BEGIN TRANSACTION;

        DECLARE @Email NVARCHAR(100) = 'new.student@example.com';
        DECLARE @BirthDate DATE = '2010-01-01';

        -- 1. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ Email
        IF EXISTS (SELECT 1 FROM Students WHERE Email = @Email)
        BEGIN
            THROW 51000, '–¢–∞–∫–∏–π Email –≤–∂–µ —ñ—Å–Ω—É—î!', 1;
        END

        -- 2. –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—ñ–∫—É
        IF DATEDIFF(YEAR, @BirthDate, GETDATE()) < 16
        BEGIN
             THROW 51000, '–°—Ç—É–¥–µ–Ω—Ç –∑–∞–Ω–∞–¥—Ç–æ –º–æ–ª–æ–¥–∏–π!', 1;
        END

        -- 3. –í—Å—Ç–∞–≤–∫–∞
        INSERT INTO Students (LastName, FirstName, BirthDate, Email)
        VALUES ('–ù–æ–≤–∏–π', '–°—Ç—É–¥–µ–Ω—Ç', @BirthDate, @Email);

    COMMIT;
    PRINT '–°—Ç—É–¥–µ–Ω—Ç —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–∏–π!';
END TRY
BEGIN CATCH
    IF @@TRANCOUNT > 0
        ROLLBACK;
    PRINT '–ü–æ–º–∏–ª–∫–∞: ' + ERROR_MESSAGE();
END CATCH
```

### –°—Ü–µ–Ω–∞—Ä—ñ–π 2: –ü–∞–∫–µ—Ç–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑ –ª–æ–≥—É–≤–∞–Ω–Ω—è–º

```sql
BEGIN TRY
    BEGIN TRANSACTION;

        -- –¢–∞–±–ª–∏—Ü—è –¥–ª—è –ª–æ–≥—É (—Ç–∏–º—á–∞—Å–æ–≤–∞ –∑–º—ñ–Ω–Ω–∞)
        DECLARE @UpdateLog TABLE (
            StudentId INT,
            OldGrants DECIMAL(10, 2),
            NewGrants DECIMAL(10, 2)
        );

        -- –û–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∏–ø–µ–Ω–¥—ñ—ó –∑ –ª–æ–≥—É–≤–∞–Ω–Ω—è–º
        UPDATE Students
        SET Grants = Grants * 1.15
        OUTPUT
            INSERTED.Id,
            DELETED.Grants,
            INSERTED.Grants
        INTO @UpdateLog
        WHERE YEAR(BirthDate) = 1998;

        -- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–Ω–æ–≤–ª–µ–Ω–∏—Ö
        DECLARE @UpdatedCount INT = (SELECT COUNT(*) FROM @UpdateLog);

        IF @UpdatedCount = 0
        BEGIN
            -- –Ø–∫—â–æ –Ω—ñ–∫–æ–≥–æ –Ω–µ –æ–Ω–æ–≤–∏–ª–∏ - –º–æ–∂–Ω–∞ —ñ –∑–∞–∫–æ–º–º—ñ—Ç–∏—Ç–∏ (–Ω—ñ—á–æ–≥–æ –Ω–µ –∑–º—ñ–Ω–∏–ª–æ—Å—å),
            -- –∞–±–æ –≤—ñ–¥–∫–æ—Ç–∏—Ç–∏, —è–∫—â–æ —Ü–µ –≤–≤–∞–∂–∞—î—Ç—å—Å—è –ø–æ–º–∏–ª–∫–æ—é –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏.
            PRINT '–ñ–æ–¥–µ–Ω —Å—Ç—É–¥–µ–Ω—Ç –Ω–µ –ø—ñ–¥–ø–∞–≤ –ø—ñ–¥ –∫—Ä–∏—Ç–µ—Ä—ñ—ó.';
            COMMIT;
        END
        ELSE
        BEGIN
            COMMIT;
            PRINT CAST(@UpdatedCount AS NVARCHAR) + ' —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –æ–Ω–æ–≤–ª–µ–Ω–æ';

            -- –ü–æ–∫–∞–∑–∞—Ç–∏ –ª–æ–≥
            SELECT * FROM @UpdateLog;
        END

END TRY
BEGIN CATCH
    IF @@TRANCOUNT > 0
        ROLLBACK;
    PRINT ERROR_MESSAGE();
END CATCH
```

---

## Best Practices

::card-group

::card{title="1. –ö–æ—Ä–æ—Ç—à—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó" icon="i-lucide-zap"}

```sql
-- ‚ùå –ü–æ–≥–∞–Ω–æ - –¥–æ–≤–≥–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è
BEGIN TRANSACTION;
    -- –î–æ–≤–≥–∏–π –∑–≤—ñ—Ç, —è–∫–∏–π –±–ª–æ–∫—É—î —Ç–∞–±–ª–∏—Ü—é
    SELECT * FROM Students WHERE Grants > 0;
    -- –û–Ω–æ–≤–ª–µ–Ω–Ω—è
    UPDATE Students SET Grants = 0 WHERE Id = 1;
COMMIT;

-- ‚úÖ –î–æ–±—Ä–µ - –∫–æ—Ä–æ—Ç–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è
-- –ó–≤—ñ—Ç —Ä–æ–±–∏–º–æ –ë–ï–ó —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó (–∞–±–æ –∑ NOLOCK)
SELECT * FROM Students WITH(NOLOCK) WHERE Grants > 0;

-- –ê –æ–Ω–æ–≤–ª–µ–Ω–Ω—è - —à–≤–∏–¥–∫–æ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
BEGIN TRANSACTION;
    UPDATE Students SET Grants = 0 WHERE Id = 1;
COMMIT;
```

::

::card{title="2. –ó–∞–≤–∂–¥–∏ TRY...CATCH" icon="i-lucide-shield"}

```sql
BEGIN TRY
    BEGIN TRANSACTION;
        -- –û–ø–µ—Ä–∞—Ü—ñ—ó
    COMMIT;
END TRY
BEGIN CATCH
    IF @@TRANCOUNT > 0
        ROLLBACK;
    -- –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–∫–∏
END CATCH
```

::

::card{title="3. –Ø–≤–Ω–∏–π COMMIT/ROLLBACK" icon="i-lucide-check"}

```sql
-- ‚úÖ –î–æ–±—Ä–µ - —è–≤–Ω–∏–π COMMIT
BEGIN TRANSACTION;
    UPDATE Students ...;
COMMIT;

-- ‚ùå –ü–æ–≥–∞–Ω–æ - –∑–∞–±—É–ª–∏ COMMIT
BEGIN TRANSACTION;
    UPDATE Students ...;
-- –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –≤–∏—Å–∏—Ç—å —ñ –±–ª–æ–∫—É—î —Ç–∞–±–ª–∏—Ü—é!
```

::

::card{title="4. –ú—ñ–Ω—ñ–º—É–º –æ–ø–µ—Ä–∞—Ü—ñ–π" icon="i-lucide-minimize-2"}

–¢—Ä–∏–º–∞–π—Ç–µ –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó **—Ç—ñ–ª—å–∫–∏** —Ç–µ, —â–æ **–º–∞—î** –±—É—Ç–∏ –∞—Ç–æ–º–∞—Ä–Ω–∏–º:

```sql
-- ‚úÖ –î–æ–±—Ä–µ
BEGIN TRANSACTION;
    INSERT INTO Students ...;
    INSERT INTO StudentLog ...;
COMMIT;

-- ‚ùå –ü–æ–≥–∞–Ω–æ
BEGIN TRANSACTION;
    INSERT INTO Students ...;
    -- –í—ñ–¥–ø—Ä–∞–≤–∫–∞ email (—Ü–µ –ø–æ–≤—ñ–ª—å–Ω–æ —ñ –Ω–µ —Å—Ç–æ—Å—É—î—Ç—å—Å—è –ë–î!)
    -- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è PDF –∑–≤—ñ—Ç—É
    INSERT INTO StudentLog ...;
COMMIT;
```

::

::

::

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è

::accordion

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 1: –ë–∞–∑–æ–≤–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è" icon="i-lucide-database"}

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é —â–æ:

1. –î–æ–¥–∞—î –Ω–æ–≤–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞
2. –í—Å—Ç–∞–Ω–æ–≤–ª—é—î –π–æ–º—É —Å—Ç–∏–ø–µ–Ω–¥—ñ—é 1500
3. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î TRY...CATCH

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
BEGIN TRY
    BEGIN TRANSACTION;

        INSERT INTO Students (FirstName, LastName, BirthDate, Grants)
        VALUES ('–ù–æ–≤–∏–π', '–°—Ç—É–¥–µ–Ω—Ç', '2000-05-15', 1500);

        PRINT '–°—Ç—É–¥–µ–Ω—Ç —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–∏–π –∑ ID: ' + CAST(SCOPE_IDENTITY() AS NVARCHAR);

    COMMIT;
END TRY
BEGIN CATCH
    IF @@TRANCOUNT > 0
        ROLLBACK;
    PRINT '–ü–æ–º–∏–ª–∫–∞: ' + ERROR_MESSAGE();
END CATCH
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 2: –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é" icon="i-lucide-check-circle"}

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é —â–æ –∑–±—ñ–ª—å—à—É—î —Å—Ç–∏–ø–µ–Ω–¥—ñ—é –Ω–∞ 20%, –∞–ª–µ —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∑ Email –±—ñ–ª—å—à–µ 5. –Ü–Ω–∞–∫—à–µ - ROLLBACK.

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
BEGIN TRY
    BEGIN TRANSACTION;

        DECLARE @StudentCount INT = (SELECT COUNT(*) FROM Students WHERE Email IS NOT NULL);

        IF @StudentCount < 5
        BEGIN
            ROLLBACK;
            PRINT '–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∑ email (' + CAST(@StudentCount AS NVARCHAR) + ')';
        END
        ELSE
        BEGIN
            UPDATE Students
            SET Grants = Grants * 1.2
            WHERE Email IS NOT NULL;

            COMMIT;
            PRINT CAST(@@ROWCOUNT AS NVARCHAR) + ' —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –æ–Ω–æ–≤–ª–µ–Ω–æ';
        END

END TRY
BEGIN CATCH
    IF @@TRANCOUNT > 0
        ROLLBACK;
    PRINT ERROR_MESSAGE();
END CATCH
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 3: SAVEPOINT" icon="i-lucide-bookmark"}

–°—Ç–≤–æ—Ä—ñ—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é –∑ SAVEPOINT:

1. –î–æ–¥–∞—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ 1
2. SAVEPOINT
3. –°–ø—Ä–æ–±–∞ –¥–æ–¥–∞—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ 2 (–º–æ–∂–µ –±—É—Ç–∏ –ø–æ–º–∏–ª–∫–∞)
4. –Ø–∫—â–æ –ø–æ–º–∏–ª–∫–∞ - ROLLBACK –¥–æ SAVEPOINT
5. –î–æ–¥–∞—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç–∞ 3
6. COMMIT

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
BEGIN TRANSACTION;

    -- –°—Ç—É–¥–µ–Ω—Ç 1
    INSERT INTO Students (FirstName, LastName, BirthDate)
    VALUES ('–°—Ç—É–¥–µ–Ω—Ç1', '–¢–µ—Å—Ç', '1998-01-01');
    PRINT '–°—Ç—É–¥–µ–Ω—Ç 1 –¥–æ–¥–∞–Ω–æ';

    SAVE TRANSACTION SP1;

    -- –°—Ç—É–¥–µ–Ω—Ç 2 (–º–æ–∂–µ –±—É—Ç–∏ –ø–æ–º–∏–ª–∫–∞)
    BEGIN TRY
        INSERT INTO Students (FirstName, LastName, BirthDate)
        VALUES ('–°—Ç—É–¥–µ–Ω—Ç2', '–¢–µ—Å—Ç', 'INVALID');  -- –ü–æ–º–∏–ª–∫–∞!
        PRINT '–°—Ç—É–¥–µ–Ω—Ç 2 –¥–æ–¥–∞–Ω–æ';
    END TRY
    BEGIN CATCH
        ROLLBACK TRANSACTION SP1;
        PRINT '–°—Ç—É–¥–µ–Ω—Ç 2 –ù–ï –¥–æ–¥–∞–Ω–æ: ' + ERROR_MESSAGE();
    END CATCH

    -- –°—Ç—É–¥–µ–Ω—Ç 3
    INSERT INTO Students (FirstName, LastName, BirthDate)
    VALUES ('–°—Ç—É–¥–µ–Ω—Ç3', '–¢–µ—Å—Ç', '1999-03-03');
    PRINT '–°—Ç—É–¥–µ–Ω—Ç 3 –¥–æ–¥–∞–Ω–æ';

COMMIT;
PRINT '–¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞';
```

</details>

::

::

---

## –†–µ–∑—é–º–µ

::tip
**–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π**:

1. **ACID –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ**: Atomicity, Consistency, Isolation, Durability
2. **–°–∏–Ω—Ç–∞–∫—Å–∏—Å**: `BEGIN TRANSACTION` ‚Üí –æ–ø–µ—Ä–∞—Ü—ñ—ó ‚Üí `COMMIT` –∞–±–æ `ROLLBACK`
3. **TRY...CATCH** ‚Äî –æ–±–æ–≤'—è–∑–∫–æ–≤–æ –¥–ª—è production –∫–æ–¥—É
4. **@@TRANCOUNT** ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π
5. **SAVEPOINT** ‚Äî —á–∞—Å—Ç–∫–æ–≤–µ –≤—ñ–¥–∫–æ—á—É–≤–∞–Ω–Ω—è –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
6. **–†—ñ–≤–Ω—ñ —ñ–∑–æ–ª—è—Ü—ñ—ó**:
    - READ UNCOMMITTED (–Ω–∞–π—à–≤–∏–¥—à–∏–π, –Ω–∞–π–º–µ–Ω—à –±–µ–∑–ø–µ—á–Ω–∏–π)
    - READ COMMITTED (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
    - REPEATABLE READ
    - SERIALIZABLE (–Ω–∞–π–ø–æ–≤—ñ–ª—å–Ω—ñ—à–∏–π, –Ω–∞–π–±–µ–∑–ø–µ—á–Ω—ñ—à–∏–π)
7. **Deadlocks** ‚Äî —É–Ω–∏–∫–∞–π—Ç–µ –æ–¥–Ω–∞–∫–æ–≤–∏–º –ø–æ—Ä—è–¥–∫–æ–º –¥–æ—Å—Ç—É–ø—É –¥–æ —Ç–∞–±–ª–∏—Ü—å
8. **Best Practices**:
    - –ö–æ—Ä–æ—Ç—à—ñ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
    - –ú—ñ–Ω—ñ–º—É–º –æ–ø–µ—Ä–∞—Ü—ñ–π –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó
    - –ó–∞–≤–∂–¥–∏ —è–≤–Ω–∏–π COMMIT/ROLLBACK
    - –û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫ —á–µ—Ä–µ–∑ TRY...CATCH

**–í—ñ—Ç–∞—î–º–æ!** –í–∏ –∑–∞–≤–µ—Ä—à–∏–ª–∏ –≤–∏–≤—á–µ–Ω–Ω—è –æ—Å–Ω–æ–≤ SQL!
::

---

**–ü–æ–≤'—è–∑–∞–Ω—ñ —Ç–µ–º–∏**:

- [–ü–æ–ø–µ—Ä–µ–¥–Ω—è: UPDATE —Ç–∞ DELETE](./06.update-delete-queries.md)
- [–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ –ø–æ—á–∞—Ç–∫—É: Sample Database Setup](./00.sample-database-setup.md)
- [CREATE TABLE](./01.ddl-create-table.md)
- [INSERT –∑–∞–ø–∏—Ç–∏](./05.insert-queries.md)
