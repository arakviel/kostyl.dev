---
title: CROSS —Ç–∞ SELF JOINs
description: –î–µ—Ç–∞–ª—å–Ω–∏–π —Ä–æ–∑–±—ñ—Ä CROSS JOIN (–î–µ–∫–∞—Ä—Ç–æ–≤–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è) —Ç–∞ SELF JOIN (—Ç–∞–±–ª–∏—Ü—è –∑ —Å–æ–±–æ—é) –∑ –ø—Ä–∞–∫—Ç–∏—á–Ω–∏–º–∏ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏
---

# CROSS —Ç–∞ SELF JOINs

## 1. CROSS JOIN - –î–µ–∫–∞—Ä—Ç–æ–≤–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è

### 1.1. –©–æ —Ç–∞–∫–µ CROSS JOIN?

**CROSS JOIN** ‚Äî –∑'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å –±–µ–∑ —É–º–æ–≤–∏ ON, —â–æ –ø–æ–≤–µ—Ä—Ç–∞—î **–≤—Å—ñ –º–æ–∂–ª–∏–≤—ñ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó** —Ä—è–¥–∫—ñ–≤ –∑ –æ–±–æ—Ö —Ç–∞–±–ª–∏—Ü—å.

::warning
**–î–µ–∫–∞—Ä—Ç–æ–≤–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è** = –ö–æ–∂–µ–Ω —Ä—è–¥–æ–∫ –∑ —Ç–∞–±–ª–∏—Ü—ñ A √ó –ö–æ–∂–µ–Ω —Ä—è–¥–æ–∫ –∑ —Ç–∞–±–ª–∏—Ü—ñ B
::

**–§–æ—Ä–º—É–ª–∞**: `–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤ = Rows(A) √ó Rows(B)`

–ü—Ä–∏–∫–ª–∞–¥:

- –¢–∞–±–ª–∏—Ü—è A: 3 —Ä—è–¥–∫–∏
- –¢–∞–±–ª–∏—Ü—è B: 4 —Ä—è–¥–∫–∏
- CROSS JOIN: **3 √ó 4 = 12 —Ä—è–¥–∫—ñ–≤**

### 1.2. –°–∏–Ω—Ç–∞–∫—Å–∏—Å

::code-group

```sql [Explicit CROSS JOIN]
SELECT columns
FROM table1
CROSS JOIN table2;
```

```sql [Implicit (—Å—Ç–∞—Ä–∏–π —Å—Ç–∏–ª—å)]
SELECT columns
FROM table1, table2;
-- –ë–µ–∑ WHERE - –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ CROSS JOIN!
```

::

### 1.3. –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è

```
Table A         Table B
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Id ‚îÇ X ‚îÇ     ‚îÇ Id ‚îÇ Y ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚î§     ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1  ‚îÇ A ‚îÇ     ‚îÇ 1  ‚îÇ P ‚îÇ
‚îÇ 2  ‚îÇ B ‚îÇ     ‚îÇ 2  ‚îÇ Q ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îò

    ‚Üì CROSS JOIN ‚Üì

–†–µ–∑—É–ª—å—Ç–∞—Ç (2 √ó 2 = 4 —Ä—è–¥–∫–∏)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îê
‚îÇA.Id‚îÇ X ‚îÇB.Id‚îÇ Y ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1  ‚îÇ A ‚îÇ 1  ‚îÇ P ‚îÇ
‚îÇ 1  ‚îÇ A ‚îÇ 2  ‚îÇ Q ‚îÇ ‚Üê –í—Å—ñ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó
‚îÇ 2  ‚îÇ B ‚îÇ 1  ‚îÇ P ‚îÇ
‚îÇ 2  ‚îÇ B ‚îÇ 2  ‚îÇ Q ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îò
```

::mermaid

```mermaid
graph TD
    A[Table A<br/>N —Ä—è–¥–∫—ñ–≤] -->|√ó| C[CROSS JOIN<br/>N √ó M —Ä—è–¥–∫—ñ–≤]
    B[Table B<br/>M —Ä—è–¥–∫—ñ–≤] -->|√ó| C

    style C fill:#ef4444,color:#fff
```

::

---

### 1.4. –ü—Ä–∏–∫–ª–∞–¥ 1: –ü—Ä–æ—Å—Ç–µ –¥–µ–∫–∞—Ä—Ç–æ–≤–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è

```sql
-- –ö–æ–ª—å–æ—Ä–∏
CREATE TABLE Colors (Id INT, Name NVARCHAR(20));
INSERT INTO Colors VALUES (1, '–ß–µ—Ä–≤–æ–Ω–∏–π'), (2, '–°–∏–Ω—ñ–π'), (3, '–ó–µ–ª–µ–Ω–∏–π');

-- –†–æ–∑–º—ñ—Ä–∏
CREATE TABLE Sizes (Id INT, Name NVARCHAR(10));
INSERT INTO Sizes VALUES (1, 'S'), (2, 'M'), (3, 'L');

-- CROSS JOIN - –≤—Å—ñ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó
SELECT
    C.Name AS Color,
    S.Name AS Size
FROM Colors AS C
CROSS JOIN Sizes AS S
ORDER BY C.Name, S.Name;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç** (3 √ó 3 = 9 —Ä—è–¥–∫—ñ–≤):

| Color    | Size |
| :------- | :--- |
| –ó–µ–ª–µ–Ω–∏–π  | L    |
| –ó–µ–ª–µ–Ω–∏–π  | M    |
| –ó–µ–ª–µ–Ω–∏–π  | S    |
| –°–∏–Ω—ñ–π    | L    |
| –°–∏–Ω—ñ–π    | M    |
| –°–∏–Ω—ñ–π    | S    |
| –ß–µ—Ä–≤–æ–Ω–∏–π | L    |
| –ß–µ—Ä–≤–æ–Ω–∏–π | M    |
| –ß–µ—Ä–≤–æ–Ω–∏–π | S    |

::tip
**Use Case**: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≤—Å—ñ—Ö –º–æ–∂–ª–∏–≤–∏—Ö –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤ —Ç–æ–≤–∞—Ä—ñ–≤ (–∫–æ–ª—ñ—Ä √ó —Ä–æ–∑–º—ñ—Ä).
::

---

### 1.5. –ü—Ä–∏–∫–ª–∞–¥ 2: –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è

```sql
-- –î–Ω—ñ —Ç–∏–∂–Ω—è
CREATE TABLE Weekdays (DayNum INT, DayName NVARCHAR(20));
INSERT INTO Weekdays VALUES
(1, '–ü–æ–Ω–µ–¥—ñ–ª–æ–∫'), (2, '–í—ñ–≤—Ç–æ—Ä–æ–∫'), (3, '–°–µ—Ä–µ–¥–∞'),
(4, '–ß–µ—Ç–≤–µ—Ä'), (5, '–ü''—è—Ç–Ω–∏—Ü—è');

-- –ì–æ–¥–∏–Ω–∏
CREATE TABLE Hours (Hour INT);
INSERT INTO Hours VALUES (9), (10), (11), (12), (13), (14), (15), (16);

-- –í—Å—ñ –º–æ–∂–ª–∏–≤—ñ —Å–ª–æ—Ç–∏ (–¥–µ–Ω—å √ó –≥–æ–¥–∏–Ω–∞)
SELECT
    W.DayName,
    H.Hour,
    CAST(H.Hour AS NVARCHAR) + ':00' AS TimeSlot
FROM Weekdays AS W
CROSS JOIN Hours AS H
ORDER BY W.DayNum, H.Hour;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç** (5 –¥–Ω—ñ–≤ √ó 8 –≥–æ–¥–∏–Ω = 40 —Å–ª–æ—Ç—ñ–≤):

| DayName   | Hour | TimeSlot |
| :-------- | :--- | :------- |
| –ü–æ–Ω–µ–¥—ñ–ª–æ–∫ | 9    | 9:00     |
| –ü–æ–Ω–µ–¥—ñ–ª–æ–∫ | 10   | 10:00    |
| ...       | ...  | ...      |
| –ü'—è—Ç–Ω–∏—Ü—è  | 16   | 16:00    |

**Use Case**: –†–æ–∑–∫–ª–∞–¥ –∑–∞–Ω—è—Ç—å, –±—Ä–æ–Ω—é–≤–∞–Ω–Ω—è —Å–ª–æ—Ç—ñ–≤, –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω–µ –ø–ª–∞–Ω—É–≤–∞–Ω–Ω—è.

---

### 1.6. –ü—Ä–∏–∫–ª–∞–¥ 3: –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ

```sql
-- –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–æ–º–±—ñ–Ω–∞—Ü—ñ–π –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
SELECT
    T.Type,
    C.Category,
    P.Priority
FROM
    (VALUES ('Bug'), ('Feature'), ('Task')) AS T(Type)
CROSS JOIN
    (VALUES ('Frontend'), ('Backend'), ('Database')) AS C(Category)
CROSS JOIN
    (VALUES ('Low'), ('Medium'), ('High')) AS P(Priority);

-- 3 √ó 3 √ó 3 = 27 –∫–æ–º–±—ñ–Ω–∞—Ü—ñ–π!
```

---

### 1.7. Performance Warning

::caution
**–ù–ï–ë–ï–ó–ü–ï–ö–ê**: CROSS JOIN —Å—Ç–≤–æ—Ä—é—î –í–ï–õ–ò–ß–ï–ó–ù–Ü —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏!

```
100 —Ä—è–¥–∫—ñ–≤ √ó 100 —Ä—è–¥–∫—ñ–≤ = 10,000 —Ä—è–¥–∫—ñ–≤
1,000 √ó 1,000 = 1,000,000 —Ä—è–¥–∫—ñ–≤
10,000 √ó 10,000 = 100,000,000 —Ä—è–¥–∫—ñ–≤ ‚ö†Ô∏è
```

**–ó–∞–≤–∂–¥–∏ –æ–±–º–µ–∂—É–π—Ç–µ —Ä–æ–∑–º—ñ—Ä —Ç–∞–±–ª–∏—Ü—å –ø—Ä–∏ CROSS JOIN!**
::

::warning
**–ù–∞–π—á–∞—Å—Ç—ñ—à–∞ –ø–æ–º–∏–ª–∫–∞**: –ó–∞–±—É—Ç–∏ ON –≤ INNER JOIN ‚Üí –≤–∏–ø–∞–¥–∫–æ–≤–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ CROSS JOIN!

```sql
-- ‚ùå –ü–û–ú–ò–õ–ö–ê! –ó–∞–±—É–ª–∏ ON
SELECT *
FROM BigTable1  -- 10,000 —Ä—è–¥–∫—ñ–≤
INNER JOIN BigTable2;  -- 10,000 —Ä—è–¥–∫—ñ–≤
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 100,000,000 —Ä—è–¥–∫—ñ–≤!!! üî•
```

::

---

### 1.8. –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ CROSS JOIN?

::card-group

::card{title="‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–æ–º–±—ñ–Ω–∞—Ü—ñ–π" icon="i-lucide-grid"}
–¢–æ–≤–∞—Ä–∏ (–∫–æ–ª—ñ—Ä √ó —Ä–æ–∑–º—ñ—Ä √ó –º–∞—Ç–µ—Ä—ñ–∞–ª)
::

::card{title="‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—ñ —Ç–∞ —Ä–æ–∑–∫–ª–∞–¥—ñ" icon="i-lucide-calendar"}
–î–Ω—ñ √ó –≥–æ–¥–∏–Ω–∏ –¥–ª—è –±—Ä–æ–Ω—é–≤–∞–Ω—å
::

::card{title="‚úÖ –¢–µ—Å—Ç–æ–≤—ñ –¥–∞–Ω—ñ" icon="i-lucide-flask"}
–í—Å—ñ –º–æ–∂–ª–∏–≤—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó –¥–ª—è —Ç–µ—Å—Ç—ñ–≤
::

::card{title="‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏—á–Ω—ñ –∑–≤—ñ—Ç–∏" icon="i-lucide-bar-chart"}
–í—Å—ñ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó –¥–ª—è –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è
::

::

---

## 2. SELF JOIN - –¢–∞–±–ª–∏—Ü—è –∑ —Å–æ–±–æ—é

### 2.1. –©–æ —Ç–∞–∫–µ SELF JOIN?

**SELF JOIN** ‚Äî –∑'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ **—Å–∞–º–æ—ó –∑ —Å–æ–±–æ—é** –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Ä—è–¥–∫—ñ–≤ –º—ñ–∂ —Å–æ–±–æ—é.

::tip
**–ö–ª—é—á–æ–≤–∞ —ñ–¥–µ—è**: –û–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è **–¥–≤—ñ—á—ñ** –∑ —Ä—ñ–∑–Ω–∏–º–∏ –ø—Å–µ–≤–¥–æ–Ω—ñ–º–∞–º–∏.
::

::note
SELF JOIN ‚Äî —Ü–µ **–Ω–µ –æ–∫—Ä–µ–º–∏–π —Ç–∏–ø** JOIN! –¶–µ INNER/LEFT/RIGHT JOIN, –¥–µ –æ–±–∏–¥–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ –æ–¥–Ω–∞–∫–æ–≤—ñ.
::

### 2.2. –°–∏–Ω—Ç–∞–∫—Å–∏—Å

```sql
SELECT columns
FROM TableName AS Alias1
INNER JOIN TableName AS Alias2  -- –¢–∞ —Å–∞–º–∞ —Ç–∞–±–ª–∏—Ü—è!
    ON Alias1.column = Alias2.column
WHERE Alias1.Id <> Alias2.Id;  -- –£–Ω–∏–∫–Ω—É—Ç–∏ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ —Å–æ–±–æ—é
```

::warning
**–û–±–æ–≤'—è–∑–∫–æ–≤–æ**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **—Ä—ñ–∑–Ω—ñ –ø—Å–µ–≤–¥–æ–Ω—ñ–º–∏** (Alias1, Alias2)!
::

---

### 2.3. –ü—Ä–∏–∫–ª–∞–¥ 1: –Ü—î—Ä–∞—Ä—Ö—ñ—è (Manager-Employee)

```sql
CREATE TABLE Employees (
    Id INT PRIMARY KEY,
    Name NVARCHAR(50),
    ManagerId INT NULL,  -- FK –Ω–∞ —Ç–æ–≥–æ –∂ Employees.Id
    FOREIGN KEY (ManagerId) REFERENCES Employees(Id)
);

INSERT INTO Employees VALUES
(1, 'CEO Alice', NULL),      -- –¢–æ–ø –º–µ–Ω–µ–¥–∂–µ—Ä
(2, 'Manager Bob', 1),        -- –ü—ñ–¥–ª–µ–≥–ª–∏–π Alice
(3, 'Manager Charlie', 1),    -- –ü—ñ–¥–ª–µ–≥–ª–∏–π Alice
(4, 'Employee David', 2),     -- –ü—ñ–¥–ª–µ–≥–ª–∏–π Bob
(5, 'Employee Emma', 2),      -- –ü—ñ–¥–ª–µ–≥–ª–∏–π Bob
(6, 'Employee Frank', 3);     -- –ü—ñ–¥–ª–µ–≥–ª–∏–π Charlie

-- SELF JOIN: –ø–æ–∫–∞–∑–∞—Ç–∏ —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ –∑ —ó—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏
SELECT
    E.Name AS Employee,
    M.Name AS Manager
FROM Employees AS E            -- E = Employee
LEFT JOIN Employees AS M       -- M = Manager (—Ç–∞ —Å–∞–º–∞ —Ç–∞–±–ª–∏—Ü—è!)
    ON E.ManagerId = M.Id
ORDER BY M.Name, E.Name;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| Employee        | Manager         |
| :-------------- | :-------------- |
| CEO Alice       | NULL            |
| Manager Bob     | CEO Alice       |
| Manager Charlie | CEO Alice       |
| Employee David  | Manager Bob     |
| Employee Emma   | Manager Bob     |
| Employee Frank  | Manager Charlie |

**–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è**:

```
Employees (—è–∫ E)         Employees (—è–∫ M)
‚îå‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇId ‚îÇ Name    ‚îÇMgr_Id  ‚îÇ ‚îÇId ‚îÇ Name     ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚îú‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ1  ‚îÇAlice    ‚îÇ NULL   ‚îÇ ‚îÇ1  ‚îÇAlice     ‚îÇ
‚îÇ2  ‚îÇBob      ‚îÇ  1     ‚îÇ‚îÄ‚îÇ2  ‚îÇBob       ‚îÇ
‚îÇ3  ‚îÇCharlie  ‚îÇ  1     ‚îÇ‚îÄ‚îÇ3  ‚îÇCharlie   ‚îÇ
‚îÇ4  ‚îÇDavid    ‚îÇ  2     ‚îÇ‚îÄ‚îÇ...‚îÇ...       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚Üì SELF JOIN ‚Üì
```

::plant-uml

```plantuml
@startuml
skinparam defaultTextAlignment center

object "Alice (CEO)" as Alice
object "Bob (Manager)" as Bob
object "Charlie (Manager)" as Charlie
object "David" as David
object "Emma" as Emma
object "Frank" as Frank

Alice --> Bob : manages
Alice --> Charlie : manages
Bob --> David : manages
Bob --> Emma : manages
Charlie --> Frank : manages

@enduml
```

::

---

### 2.4. –ü—Ä–∏–∫–ª–∞–¥ 2: –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ (–æ–¥–Ω–æ–∫–ª–∞—Å–Ω–∏–∫–∏)

```sql
CREATE TABLE Students (
    Id INT PRIMARY KEY,
    FirstName NVARCHAR(50),
    LastName NVARCHAR(50),
    GroupId INT,
    BirthDate DATE
);

INSERT INTO Students VALUES
(1, 'John', 'Doe', 1, '1998-05-15'),
(2, 'Jane', 'Smith', 1, '1998-08-20'),
(3, 'Bob', 'Johnson', 1, '1997-12-10'),
(4, 'Alice', 'Williams', 2, '1998-03-25');

-- –ó–Ω–∞–π—Ç–∏ –ø–∞—Ä–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∑ –û–î–ù–Ü–Ñ–á –≥—Ä—É–ø–∏
SELECT
    S1.FirstName + ' ' + S1.LastName AS Student1,
    S2.FirstName + ' ' + S2.LastName AS Student2,
    'Group ' + CAST(S1.GroupId AS NVARCHAR) AS SharedGroup
FROM Students AS S1
INNER JOIN Students AS S2
    ON S1.GroupId = S2.GroupId  -- –û–¥–Ω–∞ –≥—Ä—É–ø–∞
    AND S1.Id < S2.Id           -- –£–Ω–∏–∫–Ω—É—Ç–∏ –¥—É–±–ª—é–≤–∞–Ω–Ω—è (John-Jane = Jane-John)
ORDER BY S1.GroupId, S1.LastName;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| Student1    | Student2    | SharedGroup |
| :---------- | :---------- | :---------- |
| John Doe    | Bob Johnson | Group 1     |
| John Doe    | Jane Smith  | Group 1     |
| Bob Johnson | Jane Smith  | Group 1     |

::tip
**`S1.Id < S2.Id`** - –∫—Ä–∏—Ç–∏—á–Ω–æ! –ë–µ–∑ —Ü—å–æ–≥–æ –æ—Ç—Ä–∏–º–∞—î–º–æ –¥—É–±–ª—ñ:

- John-Jane ‚úÖ
- Jane-John ‚ùå (–¥—É–±–ª—ñ–∫–∞—Ç)
  ::

---

### 2.5. –ü—Ä–∏–∫–ª–∞–¥ 3: –ó–Ω–∞–π—Ç–∏ —Å—Ç–∞—Ä—à–∏—Ö –∑–∞ –≤—ñ–∫–æ–º

```sql
-- –ó–Ω–∞–π—Ç–∏ –ø–∞—Ä–∏ (–º–æ–ª–æ–¥—à–∏–π, —Å—Ç–∞—Ä—à–∏–π) –≤ –æ–¥–Ω—ñ–π –≥—Ä—É–ø—ñ
SELECT
    Younger.FirstName AS YoungerStudent,
    Older.FirstName AS OlderStudent,
    DATEDIFF(YEAR, Older.BirthDate, Younger.BirthDate) AS AgeDifference
FROM Students AS Younger
INNER JOIN Students AS Older
    ON Younger.GroupId = Older.GroupId
    AND Younger.BirthDate > Older.BirthDate  -- Younger –Ω–∞—Ä–æ–¥–∏–≤—Å—è –ü–Ü–°–õ–Ø
ORDER BY YoungerStudent, AgeDifference DESC;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| YoungerStudent | OlderStudent | AgeDifference |
| :------------- | :----------- | :------------ |
| Jane           | Bob          | 1             |
| John           | Bob          | 1             |

---

### 2.6. –ü—Ä–∏–∫–ª–∞–¥ 4: –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó (—Å—Ö–æ–∂—ñ –∑–∞–ø–∏—Å–∏)

```sql
-- –ó–Ω–∞–π—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∑ —Å—Ö–æ–∂–∏–º–∏ —ñ–º–µ–Ω–∞–º–∏ (–º–æ–∂–ª–∏–≤—ñ –ø–æ–º–∏–ª–∫–∏ –≤–≤–æ–¥—É)
SELECT
    S1.FirstName AS Name1,
    S1.LastName AS LastName1,
    S2.FirstName AS Name2,
    S2.LastName AS LastName2,
    '–ú–æ–∂–ª–∏–≤–∏–π –¥—É–±–ª—ñ–∫–∞—Ç?' AS Warning
FROM Students AS S1
INNER JOIN Students AS S2
    ON S1.Id <> S2.Id
    AND S1.FirstName = S2.FirstName  -- –û–¥–Ω–∞–∫–æ–≤—ñ —ñ–º–µ–Ω–∞
    AND S1.GroupId = S2.GroupId      -- –í –æ–¥–Ω—ñ–π –≥—Ä—É–ø—ñ
ORDER BY S1.FirstName;
```

---

### 2.7. –ü—Ä–∏–∫–ª–∞–¥ 5: Transitive relationships

```sql
-- –¢–∞–±–ª–∏—Ü—è –¥—Ä—É–∂–±–∏ (—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∞!)
CREATE TABLE Friendships (
    StudentId1 INT,
    StudentId2 INT,
    PRIMARY KEY (StudentId1, StudentId2)
);

INSERT INTO Friendships VALUES
(1, 2),  -- John ‚Üî Jane
(1, 3),  -- John ‚Üî Bob
(2, 4);  -- Jane ‚Üî Alice

-- –ó–Ω–∞–π—Ç–∏ "–¥—Ä—É–∑—ñ–≤ –¥—Ä—É–∑—ñ–≤" (—Ö—Ç–æ –º–æ–∂–µ –ø–æ–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—å)
SELECT DISTINCT
    S1.FirstName AS Person,
    S3.FirstName AS PotentialFriend,
    S2.FirstName AS MutualFriend
FROM Friendships AS F1
INNER JOIN Friendships AS F2
    ON F1.StudentId2 = F2.StudentId1  -- –î—Ä—É–≥ –¥—Ä—É–≥–∞
INNER JOIN Students AS S1 ON F1.StudentId1 = S1.Id
INNER JOIN Students AS S2 ON F1.StudentId2 = S2.Id
INNER JOIN Students AS S3 ON F2.StudentId2 = S3.Id
WHERE F1.StudentId1 <> F2.StudentId2  -- –£–Ω–∏–∫–Ω—É—Ç–∏ —Å–µ–±–µ
ORDER BY Person, PotentialFriend;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: John –º–æ–∂–µ –ø–æ–∑–Ω–∞–π–æ–º–∏—Ç–∏—Å—å –∑ Alice —á–µ—Ä–µ–∑ Jane.

---

## 3. –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è CROSS vs SELF JOIN

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞  | CROSS JOIN                    | SELF JOIN              |
| :-------------- | :---------------------------- | :--------------------- |
| **–¢–∞–±–ª–∏—Ü—ñ**     | –î–≤—ñ **—Ä—ñ–∑–Ω—ñ** —Ç–∞–±–ª–∏—Ü—ñ         | –û–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü—è **–¥–≤—ñ—á—ñ** |
| **–£–º–æ–≤–∞ ON**    | ‚ùå –ù–µ–º–∞—î                      | ‚úÖ –û–±–æ–≤'—è–∑–∫–æ–≤–∞         |
| **–ü—Å–µ–≤–¥–æ–Ω—ñ–º–∏**  | –û–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ                   | **–û–±–æ–≤'—è–∑–∫–æ–≤–æ**        |
| **–†–µ–∑—É–ª—å—Ç–∞—Ç**   | –í—Å—ñ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó                | –ó–≤'—è–∑–∞–Ω—ñ —Ä—è–¥–∫–∏         |
| **Use Case**    | –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤           | –Ü—î—Ä–∞—Ä—Ö—ñ—ó, –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è   |
| **Performance** | ‚ö†Ô∏è –ù–µ–±–µ–∑–ø–µ—á–Ω–æ (–±–∞–≥–∞—Ç–æ —Ä—è–¥–∫—ñ–≤) | ‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω–æ (–∑ ON)    |

---

## 4. Best Practices

::card-group

::card{title="CROSS JOIN: –û–±–º–µ–∂–µ–Ω–Ω—è!" icon="i-lucide-alert-triangle"}

```sql
-- –ó–∞–≤–∂–¥–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é–π—Ç–µ —Ä–æ–∑–º—ñ—Ä
SELECT COUNT(*)
FROM Table1
CROSS JOIN Table2;
-- –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–µ—Ä–µ–¥ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è–º!
```

::

::card{title="SELF JOIN: –£–Ω—ñ–∫–∞–ª—å–Ω—ñ aliases" icon="i-lucide-type"}

```sql
-- ‚úÖ –ß—ñ—Ç–∫—ñ –Ω–∞–∑–≤–∏
FROM Employees AS Manager
JOIN Employees AS Employee

-- ‚ùå –ó–∞–ø–ª—É—Ç–∞–Ω–æ
FROM Employees AS E1
JOIN Employees AS E2
```

::

::card{title="SELF JOIN: –£–Ω–∏–∫–Ω—É—Ç–∏ –¥—É–±–ª—ñ–≤" icon="i-lucide-copy"}

```sql
-- –î–æ–¥–∞—Ç–∏ —É–º–æ–≤—É
WHERE S1.Id < S2.Id
-- –ê–±–æ
WHERE S1.Id <> S2.Id
```

::

::card{title="–Ü–Ω–¥–µ–∫—Å–∏ –≤–∞–∂–ª–∏–≤—ñ!" icon="i-lucide-zap"}

```sql
-- –î–ª—è SELF JOIN –ø–æ FK
CREATE INDEX IX_Employees_ManagerId
ON Employees(ManagerId);
```

::

::

---

## 5. –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è

::accordion

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 1: –ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä—ñ–≤" icon="i-lucide-shopping-cart"}

–°—Ç–≤–æ—Ä—ñ—Ç—å –≤—Å—ñ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó —Ç–æ–≤–∞—Ä—ñ–≤ (–ö–∞—Ç–µ–≥–æ—Ä—ñ—è √ó –ö–æ–ª—ñ—Ä √ó –†–æ–∑–º—ñ—Ä) –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ CROSS JOIN.

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
SELECT
    Cat.Name AS Category,
    Col.Name AS Color,
    Siz.Name AS Size
FROM Categories AS Cat
CROSS JOIN Colors AS Col
CROSS JOIN Sizes AS Siz
ORDER BY Category, Color, Size;
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 2: –û—Ä–≥–∞–Ω—ñ–∑–∞—Ü—ñ–π–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞" icon="i-lucide-sitemap"}

–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ—Ö —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ –∑ —ó—Ö –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏ (3 —Ä—ñ–≤–Ω—ñ: Employee ‚Üí Manager ‚Üí TopManager).

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
SELECT
    E.Name AS Employee,
    M.Name AS Manager,
    TM.Name AS TopManager
FROM Employees AS E
LEFT JOIN Employees AS M
    ON E.ManagerId = M.Id
LEFT JOIN Employees AS TM
    ON M.ManagerId = TM.Id
ORDER BY TM.Name, M.Name, E.Name;
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 3: –ó–Ω–∞–π—Ç–∏ –æ–¥–Ω–æ–ª—ñ—Ç–∫—ñ–≤" icon="i-lucide-users"}

–ó–Ω–∞–π—Ç–∏ –ø–∞—Ä–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –æ–¥–Ω–∞–∫–æ–≤–æ–≥–æ –≤—ñ–∫—É –≤ –æ–¥–Ω—ñ–π –≥—Ä—É–ø—ñ.

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
SELECT
    S1.FirstName AS Student1,
    S2.FirstName AS Student2,
    YEAR(S1.BirthDate) AS BirthYear
FROM Students AS S1
INNER JOIN Students AS S2
    ON S1.GroupId = S2.GroupId
    AND YEAR(S1.BirthDate) = YEAR(S2.BirthDate)
    AND S1.Id < S2.Id
ORDER BY BirthYear, Student1;
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 4: –ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å" icon="i-lucide-arrow-right"}

–ó–Ω–∞–π—Ç–∏ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ –ø–∞—Ä–∏ (–ø–æ–ø–µ—Ä–µ–¥–Ω—ñ–π ‚Üí –ø–æ—Ç–æ—á–Ω–∏–π) –ø–æ –¥–∞—Ç—ñ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó.

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
SELECT
    S1.FirstName AS Previous,
    S1.EnrollmentDate AS PrevDate,
    S2.FirstName AS Current,
    S2.EnrollmentDate AS CurrDate,
    DATEDIFF(DAY, S1.EnrollmentDate, S2.EnrollmentDate) AS DaysDiff
FROM Students AS S1
INNER JOIN Students AS S2
    ON S2.EnrollmentDate > S1.EnrollmentDate
WHERE NOT EXISTS (
    SELECT 1 FROM Students AS S3
    WHERE S3.EnrollmentDate > S1.EnrollmentDate
    AND S3.EnrollmentDate < S2.EnrollmentDate
)
ORDER BY S1.EnrollmentDate;
```

</details>

::

::

---

## –†–µ–∑—é–º–µ

::tip
**–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏**:

**CROSS JOIN**:

1. –í—Å—ñ –º–æ–∂–ª–∏–≤—ñ **–∫–æ–º–±—ñ–Ω–∞—Ü—ñ—ó** —Ä—è–¥–∫—ñ–≤
2. **–ù–µ–º–∞—î** —É–º–æ–≤–∏ ON
3. –†–µ–∑—É–ª—å—Ç–∞—Ç: `Rows(A) √ó Rows(B)`
4. Use cases: –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤, –∫–∞–ª–µ–Ω–¥–∞—Ä—ñ, —Ç–µ—Å—Ç–∏
5. ‚ö†Ô∏è **–ù–ï–ë–ï–ó–ü–ï–ß–ù–û** –¥–ª—è –≤–µ–ª–∏–∫–∏—Ö —Ç–∞–±–ª–∏—Ü—å!

**SELF JOIN**:

1. –¢–∞–±–ª–∏—Ü—è –∑'—î–¥–Ω—É—î—Ç—å—Å—è **—Å–∞–º–∞ –∑ —Å–æ–±–æ—é**
2. **–û–±–æ–≤'—è–∑–∫–æ–≤—ñ** —Ä—ñ–∑–Ω—ñ –ø—Å–µ–≤–¥–æ–Ω—ñ–º–∏
3. –£–º–æ–≤–∞ ON - —è–∫ —É –∑–≤–∏—á–∞–π–Ω–æ–º—É JOIN
4. Use cases: —ñ—î—Ä–∞—Ä—Ö—ñ—ó (manager-employee), –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó
5. –£–Ω–∏–∫–∞–π—Ç–µ –¥—É–±–ª—ñ–≤: `WHERE T1.Id < T2.Id`

**Performance**:

- CROSS JOIN: –∫–æ–Ω—Ç—Ä–æ–ª—é–π—Ç–µ —Ä–æ–∑–º—ñ—Ä!
- SELF JOIN: —ñ–Ω–¥–µ–∫—Å–∏ –Ω–∞ FK –∫—Ä–∏—Ç–∏—á–Ω—ñ
  ::

---

**–ü–æ–ø–µ—Ä–µ–¥–Ω—è —Ç–µ–º–∞**: [OUTER JOINs](./02.outer-joins.md)  
**–ù–∞—Å—Ç—É–ø–Ω–∞ —Ç–µ–º–∞**: [–ü—ñ–¥–∑–∞–ø–∏—Ç–∏ (Subqueries)](./04.subqueries.md)
