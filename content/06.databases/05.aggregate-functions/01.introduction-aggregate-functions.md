---
title: –§—É–Ω–∫—Ü—ñ—ó –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è –≤ MS SQL Server
description: –î–µ—Ç–∞–ª—å–Ω–µ –¥–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –∞–≥—Ä–µ–≥–∞—Ç–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π SQL Server - COUNT, SUM, AVG, MIN, MAX –∑ –ø—Ä–∞–∫—Ç–∏—á–Ω–∏–º–∏ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏ —Ç–∞ best practices
---

# –§—É–Ω–∫—Ü—ñ—ó –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è –≤ MS SQL Server

## –í—Å—Ç—É–ø: –ù–∞–≤—ñ—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ –±–∞–∑–∞—Ö –¥–∞–Ω–∏—Ö?

–£—è–≤—ñ—Ç—å, —â–æ –≤–∏ –∫–µ—Ä—É—î—Ç–µ –≤–µ–ª–∏–∫–∏–º —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–æ–º –∑ –º—ñ–ª—å–π–æ–Ω–∞–º–∏ —Ç–æ–≤–∞—Ä—ñ–≤ —Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π. –©–æ–¥–Ω—è –≤–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è:

- –°–∫—ñ–ª—å–∫–∏ —Ç–æ–≤–∞—Ä—ñ–≤ –ø—Ä–æ–¥–∞–Ω–æ —Å—å–æ–≥–æ–¥–Ω—ñ?
- –Ø–∫–∏–π —Å–µ—Ä–µ–¥–Ω—ñ–π —á–µ–∫ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è?
- –•—Ç–æ –∑ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –≤–∏—Ç—Ä–∞—Ç–∏–≤ –Ω–∞–π–±—ñ–ª—å—à–µ –≥—Ä–æ—à–µ–π?
- –Ø–∫–∞ –∑–∞–≥–∞–ª—å–Ω–∞ —Å—É–º–∞ –≤–∏—Ä—É—á–∫–∏ –∑–∞ –º—ñ—Å—è—Ü—å?

**–ü–æ–≥–∞–Ω–∞ –Ω–æ–≤–∏–Ω–∞**: –Ø–∫–±–∏ –≤–∏ –æ—Ç—Ä–∏–º—É–≤–∞–ª–∏ –≤—Å—ñ –∑–∞–ø–∏—Å–∏ –∑ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö —Ç–∞ —Ä–∞—Ö—É–≤–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —É –¥–æ–¥–∞—Ç–∫—É (Python, C#, Java), —Ü–µ –±—É–ª–æ –± **–∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ñ—á–Ω–æ –ø–æ–≤—ñ–ª—å–Ω–æ**:

```python
# ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –û—Ç—Ä–∏–º—É—î–º–æ –º—ñ–ª—å–π–æ–Ω –∑–∞–ø–∏—Å—ñ–≤ —É –¥–æ–¥–∞—Ç–æ–∫
orders = db.query("SELECT price FROM orders")  # 1,000,000 —Ä—è–¥–∫—ñ–≤!
total = sum([order.price for order in orders])  # –û–±—á–∏—Å–ª–µ–Ω–Ω—è —É Python
# –ü—Ä–æ–±–ª–µ–º–∏:
# - –ü–µ—Ä–µ–¥–∞—á–∞ 1 –º–ª–Ω —Ä—è–¥–∫—ñ–≤ —á–µ—Ä–µ–∑ –º–µ—Ä–µ–∂—É (100+ –ú–ë)
# - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø–∞–º'—è—Ç—ñ –¥–æ–¥–∞—Ç–∫—É
# - –ü–æ–≤—ñ–ª—å–Ω–æ (—Å–µ–∫—É–Ω–¥–∏ –∑–∞–º—ñ—Å—Ç—å –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥)
```

**–•–æ—Ä–æ—à–∞ –Ω–æ–≤–∏–Ω–∞**: SQL Server –º–æ–∂–µ –∑—Ä–æ–±–∏—Ç–∏ –≤—Å–µ —Ü–µ **–Ω–∞ —Å—Ç–æ—Ä–æ–Ω—ñ –ë–î** –∑–∞ –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥–∏:

```sql
-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –û–±—á–∏—Å–ª—é—î–º–æ –≤ –ë–î
SELECT SUM(price) AS total_revenue FROM orders;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: –æ–¥–Ω–µ —á–∏—Å–ª–æ, –≤–∏–∫–æ–Ω–∞–Ω–Ω—è ~50ms –Ω–∞ 1 –º–ª–Ω –∑–∞–ø–∏—Å—ñ–≤
```

::note
**–ö–ª—é—á–æ–≤–∞ —ñ–¥–µ—è**: –§—É–Ω–∫—Ü—ñ—ó –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è (Aggregate Functions) –¥–æ–∑–≤–æ–ª—è—é—Ç—å –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ **–º–Ω–æ–∂–∏–Ω—É —Ä—è–¥–∫—ñ–≤** —É **—î–¥–∏–Ω–µ –ø—ñ–¥—Å—É–º–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è** –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö, —â–æ –Ω–∞–±–∞–≥–∞—Ç–æ —à–≤–∏–¥—à–µ —Ç–∞ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–µ.
::

---

## –†–µ–∞–ª—å–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π: Dashboard –¥–ª—è E-commerce

–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, —É –Ω–∞—Å —î –±–∞–∑–∞ –¥–∞–Ω–∏—Ö –∑ —Ç–∞–±–ª–∏—Ü–µ—é –∑–∞–º–æ–≤–ª–µ–Ω—å:

```sql
CREATE TABLE Orders (
    order_id INT PRIMARY KEY,
    customer_id INT,
    product_name NVARCHAR(100),
    price DECIMAL(10, 2),
    quantity INT,
    order_date DATETIME2
);
```

–ú–µ–Ω–µ–¥–∂–µ—Ä—É –ø–æ—Ç—Ä—ñ–±–µ–Ω –¥–∞—à–±–æ—Ä–¥ –∑ —Ç–∞–∫–∏–º–∏ –º–µ—Ç—Ä–∏–∫–∞–º–∏:

| –ú–µ—Ç—Ä–∏–∫–∞                     | –ë–µ–∑ –∞–≥—Ä–µ–≥–∞—Ç—ñ–≤                   | –ó –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏            |
| :-------------------------- | :------------------------------ | :---------------------- |
| –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∑–∞–º–æ–≤–ª–µ–Ω—å         | –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Å–µ + —Ä–∞—Ö—É–≤–∞—Ç–∏ –≤ C# | `COUNT(*)`              |
| –°–µ—Ä–µ–¥–Ω—ñ–π —á–µ–∫                | –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Å–µ + AVG —É Python  | `AVG(price)`            |
| –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ —Å—É–º–∞ –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è | –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Å–µ + MAX —É Java    | `MAX(price)`            |
| –ó–∞–≥–∞–ª—å–Ω–∞ –≤–∏—Ä—É—á–∫–∞            | –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –≤—Å–µ + SUM —É PHP     | `SUM(price * quantity)` |

::tip
**Performance gain**: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–≥—Ä–µ–≥–∞—Ç–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π –º–æ–∂–µ –ø—Ä–∏—Å–∫–æ—Ä–∏—Ç–∏ –∑–∞–ø–∏—Ç–∏ —É **100-1000 —Ä–∞–∑—ñ–≤** –ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è–º–∏ —É –¥–æ–¥–∞—Ç–∫—É!
::

---

## –Ü—Å—Ç–æ—Ä–∏—á–Ω–∞ –µ–≤–æ–ª—é—Ü—ñ—è –∞–≥—Ä–µ–≥–∞—Ç–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π

–§—É–Ω–∫—Ü—ñ—ó –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è ‚Äî —Ü–µ –Ω–µ –Ω–æ–≤–∞ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—è. –í–æ–Ω–∏ –∑'—è–≤–∏–ª–∏—Å—è —Ä–∞–∑–æ–º –∑ –ø–µ—Ä—à–∏–º–∏ —Ä–µ–ª—è—Ü—ñ–π–Ω–∏–º–∏ –±–∞–∑–∞–º–∏ –¥–∞–Ω–∏—Ö:

::mermaid

```mermaid
timeline
    title –ï–≤–æ–ª—é—Ü—ñ—è –∞–≥—Ä–µ–≥–∞—Ç–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π —É SQL
    section 1970s
        1974 : SQL —Å—Ç–≤–æ—Ä–µ–Ω–æ –≤ IBM<br/>–ë–∞–∑–æ–≤—ñ COUNT, SUM, AVG, MIN, MAX
    section 1980s
        1986 : SQL-86 —Å—Ç–∞–Ω–¥–∞—Ä—Ç<br/>GROUP BY —Ç–∞ HAVING
    section 1990s
        1992 : SQL-92<br/>UNION, –∫–æ—Ä–µ–ª—å–æ–≤–∞–Ω—ñ –ø—ñ–¥–∑–∞–ø–∏—Ç–∏
        1999 : SQL:1999<br/>Window Functions, ROLLUP, CUBE
    section 2000s
        2003 : SQL:2003<br/>GROUPING SETS
        2008 : SQL Server 2008<br/>MERGE, –†–æ–∑—à–∏—Ä–µ–Ω—ñ –∞–Ω–∞–ª—ñ—Ç–∏—á–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
    section 2010s-2020s
        2012+ : SQL Server 2012+<br/>LAG, LEAD, FIRST_VALUE, LAST_VALUE<br/>STRING_AGG (2017)
```

::

::note
**–¶—ñ–∫–∞–≤–∏–π —Ñ–∞–∫—Ç**: –£ SQL Server 2017 –∑'—è–≤–∏–ª–∞—Å—è —Ñ—É–Ω–∫—Ü—ñ—è `STRING_AGG()`, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –∞–≥—Ä–µ–≥—É–≤–∞—Ç–∏ —Ä—è–¥–∫–∏ —Ç–µ–∫—Å—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –æ–±'—î–¥–Ω–∞—Ç–∏ –≤—Å—ñ —ñ–º–µ–Ω–∞ –∫–ª—ñ—î–Ω—Ç—ñ–≤ —É –æ–¥–∏–Ω —Å–ø–∏—Å–æ–∫).
::

---

## –§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω—ñ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—ó

### –©–æ —Ç–∞–∫–µ –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è?

**–ê–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è** (Aggregation) ‚Äî —Ü–µ –ø—Ä–æ—Ü–µ—Å –ø–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è –º–Ω–æ–∂–∏–Ω–∏ –∑–Ω–∞—á–µ–Ω—å —É —î–¥–∏–Ω–µ –ø—ñ–¥—Å—É–º–∫–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è.

::mermaid

```mermaid
graph LR
    subgraph –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ
        A1[–ó–∞–ø–∏—Å 1: 100 –≥—Ä–Ω]
        A2[–ó–∞–ø–∏—Å 2: 200 –≥—Ä–Ω]
        A3[–ó–∞–ø–∏—Å 3: 150 –≥—Ä–Ω]
        A4[–ó–∞–ø–∏—Å 4: 300 –≥—Ä–Ω]
    end

    subgraph –§—É–Ω–∫—Ü—ñ—è –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è
        B[SUM]
    end

    subgraph –†–µ–∑—É–ª—å—Ç–∞—Ç
        C[750 –≥—Ä–Ω]
    end

    A1 --> B
    A2 --> B
    A3 --> B
    A4 --> B
    B --> C

    style B fill:#f59e0b,color:#000
    style C fill:#10b981,color:#fff
```

::

### –í—ñ–¥–º—ñ–Ω–Ω—ñ—Å—Ç—å –≤—ñ–¥ —Å–∫–∞–ª—è—Ä–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | –°–∫–∞–ª—è—Ä–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è         | –ê–≥—Ä–µ–≥–∞—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è             |
| :------------- | :----------------------- | :---------------------------- |
| –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ    | **–û–¥–∏–Ω** —Ä—è–¥–æ–∫           | **–ú–Ω–æ–∂–∏–Ω–∞** —Ä—è–¥–∫—ñ–≤            |
| –í–∏—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ   | –û–¥–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è            | –û–¥–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è                 |
| –ü—Ä–∏–∫–ª–∞–¥        | `UPPER('text')`          | `COUNT(*)`                    |
| –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è   | –î–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞ –æ–∫—Ä–µ–º–æ | –î–ª—è –≤—Å—ñ—Ö —Ä—è–¥–∫—ñ–≤ —Ä–∞–∑–æ–º         |
| WHERE clause   | ‚úÖ –ú–æ–∂–Ω–∞                 | ‚ùå –ù–µ –º–æ–∂–Ω–∞ (—Ç—ñ–ª—å–∫–∏ –≤ HAVING) |

**–ü—Ä–∏–∫–ª–∞–¥ —Ä—ñ–∑–Ω–∏—Ü—ñ**:

```sql
-- –°–∫–∞–ª—è—Ä–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è: –∑–∞—Å—Ç–æ—Å–æ–≤—É—î—Ç—å—Å—è –¥–æ –ö–û–ñ–ù–û–ì–û —Ä—è–¥–∫–∞ –æ–∫—Ä–µ–º–æ
SELECT
    first_name,
    UPPER(first_name) AS uppercase_name  -- –í–∏–∫–æ–Ω—É—î—Ç—å—Å—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞
FROM Students;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 10 —Ä—è–¥–∫—ñ–≤ ‚Üí 10 —Ä—è–¥–∫—ñ–≤

-- –ê–≥—Ä–µ–≥–∞—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è: –æ–±'—î–¥–Ω—É—î –í–°–Ü —Ä—è–¥–∫–∏ –≤ –æ–¥–∏–Ω
SELECT
    COUNT(*) AS total_students  -- –û–¥–Ω–µ —á–∏—Å–ª–æ –¥–ª—è –≤—Å—ñ—Ö —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
FROM Students;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 10 —Ä—è–¥–∫—ñ–≤ ‚Üí 1 —Ä—è–¥–æ–∫
```

---

## –ü'—è—Ç—å –±–∞–∑–æ–≤–∏—Ö –∞–≥—Ä–µ–≥–∞—Ç–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π

SQL Server –Ω–∞–¥–∞—î **5 –æ—Å–Ω–æ–≤–Ω–∏—Ö** –∞–≥—Ä–µ–≥–∞—Ç–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π:

::mermaid

```mermaid
graph TD
    A[–ê–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó] --> B[COUNT - –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫]
    A --> C[SUM - –°—É–º–∞]
    A --> D[AVG - –°–µ—Ä–µ–¥–Ω—î]
    A --> E[MIN - –ú—ñ–Ω—ñ–º—É–º]
    A --> F[MAX - –ú–∞–∫—Å–∏–º—É–º]

    B --> B1[–ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤/–∑–Ω–∞—á–µ–Ω—å]
    C --> C1[–¢—ñ–ª—å–∫–∏ —á–∏—Å–ª–æ–≤—ñ —Ç–∏–ø–∏]
    D --> D1[–¢—ñ–ª—å–∫–∏ —á–∏—Å–ª–æ–≤—ñ —Ç–∏–ø–∏]
    E --> E1[–ë—É–¥—å-—è–∫—ñ –ø–æ—Ä—ñ–≤–Ω—é–≤–∞–Ω—ñ —Ç–∏–ø–∏]
    F --> F1[–ë—É–¥—å-—è–∫—ñ –ø–æ—Ä—ñ–≤–Ω—é–≤–∞–Ω—ñ —Ç–∏–ø–∏]

    style A fill:#3b82f6,color:#fff
    style B fill:#10b981,color:#fff
    style C fill:#f59e0b,color:#000
    style D fill:#ef4444,color:#fff
    style E fill:#8b5cf6,color:#fff
    style F fill:#ec4899,color:#fff
```

::

::warning
**–í–∞–∂–ª–∏–≤–µ –æ–±–º–µ–∂–µ–Ω–Ω—è**: –§—É–Ω–∫—Ü—ñ—ó `SUM()` —Ç–∞ `AVG()` –ø—Ä–∞—Ü—é—é—Ç—å **—Ç—ñ–ª—å–∫–∏ –∑ —á–∏—Å–ª–æ–≤–∏–º–∏** —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–∏—Ö (`INT`, `DECIMAL`, `FLOAT` —Ç–æ—â–æ). –°–ø—Ä–æ–±–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ —ó—Ö –∑ `VARCHAR` –ø—Ä–∏–∑–≤–µ–¥–µ –¥–æ –ø–æ–º–∏–ª–∫–∏!
::

---

## COUNT(): –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–ø–∏—Å—ñ–≤

### –ù–∞–≤—ñ—â–æ —Ä–∞—Ö—É–≤–∞—Ç–∏ –∑–∞–ø–∏—Å–∏?

–ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–µ –ø–∏—Ç–∞–Ω–Ω—è: "–°–∫—ñ–ª—å–∫–∏?" ‚Äî –Ω–∞–π–ø–æ—à–∏—Ä–µ–Ω—ñ—à–µ —É –±—ñ–∑–Ω–µ—Å-–∞–Ω–∞–ª—ñ—Ç–∏—Ü—ñ:

- –°–∫—ñ–ª—å–∫–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –∑–∞—Ä–µ—î—Å—Ç—Ä—É–≤–∞–ª–æ—Å—è?
- –°–∫—ñ–ª—å–∫–∏ –∑–∞–º–æ–≤–ª–µ–Ω—å –æ–±—Ä–æ–±–ª–µ–Ω–æ?
- –°–∫—ñ–ª—å–∫–∏ —Ç–æ–≤–∞—Ä—ñ–≤ –Ω–∞ —Å–∫–ª–∞–¥—ñ?

### –¢—Ä–∏ –≤–∞—Ä—ñ–∞—Ü—ñ—ó COUNT()

–§—É–Ω–∫—Ü—ñ—è `COUNT()` –º–∞—î **—Ç—Ä–∏ —Ä—ñ–∑–Ω—ñ —Ñ–æ—Ä–º–∏** –∑ —Ä—ñ–∑–Ω–æ—é –ø–æ–≤–µ–¥—ñ–Ω–∫–æ—é:

::tabs

::tab{label="COUNT(\*) - –£—Å—ñ —Ä—è–¥–∫–∏"}

```sql
SELECT COUNT(*) AS total_students
FROM Students;
```

**–©–æ —Ä–∞—Ö—É—î**: –ê–±—Å–æ–ª—é—Ç–Ω–æ –í–°–Ü —Ä—è–¥–∫–∏, **–≤–∫–ª—é—á–∞—é—á–∏ NULL**

**–†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ —Ç–µ—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö** (10 —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤, –∑ –Ω–∏—Ö 2 –º–∞—é—Ç—å `Grants = NULL`):

```
total_students
--------------
10
```

**–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏**: –ö–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–∞ **–∑–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤** —É —Ç–∞–±–ª–∏—Ü—ñ –∞–±–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –∑–∞–ø–∏—Ç—É.

::

::tab{label="COUNT(column) - –ù–µ–ø—É—Å—Ç—ñ –∑–Ω–∞—á–µ–Ω–Ω—è"}

```sql
SELECT COUNT(Grants) AS students_with_grants
FROM Students;
```

**–©–æ —Ä–∞—Ö—É—î**: –¢—ñ–ª—å–∫–∏ —Ä—è–¥–∫–∏, –¥–µ —Å—Ç–æ–≤–ø–µ—Ü—å `Grants` **–ù–ï NULL**

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

```
students_with_grants
--------------------
8
```

**–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏**: –ö–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —É —Å–∫—ñ–ª—å–∫–æ—Ö –∑–∞–ø–∏—Å–∞—Ö **–∑–∞–ø–æ–≤–Ω–µ–Ω–æ** –∫–æ–Ω–∫—Ä–µ—Ç–Ω–µ –ø–æ–ª–µ.

::

::tab{label="COUNT(DISTINCT column) - –£–Ω—ñ–∫–∞–ª—å–Ω—ñ –∑–Ω–∞—á–µ–Ω–Ω—è"}

```sql
SELECT COUNT(DISTINCT Grants) AS unique_grant_amounts
FROM Students;
```

**–©–æ —Ä–∞—Ö—É—î**: –ö—ñ–ª—å–∫—ñ—Å—Ç—å **—É–Ω—ñ–∫–∞–ª—å–Ω–∏—Ö** –∑–Ω–∞—á–µ–Ω—å (–±–µ–∑ –ø–æ–≤—Ç–æ—Ä—ñ–≤ —Ç–∞ NULL)

**–ü—Ä–∏–∫–ª–∞–¥ –¥–∞–Ω–∏—Ö**:

```
–°—Ç—É–¥–µ–Ω—Ç | –°—Ç–∏–ø–µ–Ω–¥—ñ—è
--------|----------
–Ü–≤–∞–Ω    | 1200
–ú–∞—Ä—ñ—è   | 1200
–ü–µ—Ç—Ä–æ   | 1300
–û–ª—å–≥–∞   | NULL
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

```
unique_grant_amounts
--------------------
2  (1200 —ñ 1300, NULL –Ω–µ –≤—Ä–∞—Ö–æ–≤—É—î—Ç—å—Å—è)
```

**–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏**: –ö–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å **—Ä—ñ–∑–Ω–∏—Ö** –∑–Ω–∞—á–µ–Ω—å.

::

::

### –ê–Ω–∞—Ç–æ–º—ñ—è –∫–æ–¥—É: –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –≤–∞—Ä—ñ–∞–Ω—Ç—ñ–≤

```sql {2-4}
SELECT
    COUNT(*) AS total_rows,           -- 10 (—É—Å—ñ —Å—Ç—É–¥–µ–Ω—Ç–∏)
    COUNT(Grants) AS has_grant,       -- 8 (—Å—Ç—É–¥–µ–Ω—Ç–∏ –∑—ñ —Å—Ç–∏–ø–µ–Ω–¥—ñ—î—é)
    COUNT(DISTINCT Grants) AS unique_grants  -- 5 (—Ä—ñ–∑–Ω—ñ —Ä–æ–∑–º—ñ—Ä–∏ —Å—Ç–∏–ø–µ–Ω–¥—ñ–π)
FROM Students;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤–∏–∫–æ–Ω–∞–Ω–Ω—è**:

| total_rows | has_grant | unique_grants |
| ---------: | --------: | ------------: |
|         10 |         8 |             5 |

**–ü–æ—è—Å–Ω–µ–Ω–Ω—è**:

- **–†—è–¥–æ–∫ 2**: `COUNT(*)` ‚Äî —Ä–∞—Ö—É—î –≤—Å—ñ 10 —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
- **–†—è–¥–æ–∫ 3**: `COUNT(Grants)` ‚Äî —ñ–≥–Ω–æ—Ä—É—î 2 —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∑ `NULL`
- **–†—è–¥–æ–∫ 4**: `COUNT(DISTINCT Grants)` ‚Äî —Ä–∞—Ö—É—î –ª–∏—à–µ —É–Ω—ñ–∫–∞–ª—å–Ω—ñ —Å—É–º–∏: 1000, 1100, 1200, 1256, 1300

---

## SUM(): –û–±—á–∏—Å–ª–µ–Ω–Ω—è —Å—É–º–∏

### –ù–∞–≤—ñ—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ —Å—É–º–∞?

–§—ñ–Ω–∞–Ω—Å–æ–≤—ñ —Ç–∞ –∫—ñ–ª—å–∫—ñ—Å–Ω—ñ –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫–∏ ‚Äî –æ—Å–Ω–æ–≤–∞ –±—ñ–∑–Ω–µ—Å-–∞–Ω–∞–ª—ñ—Ç–∏–∫–∏:

- –Ø–∫–∞ –∑–∞–≥–∞–ª—å–Ω–∞ –≤–∏—Ä—É—á–∫–∞?
- –°–∫—ñ–ª—å–∫–∏ –≥—Ä–æ—à–µ–π –≤–∏—Ç—Ä–∞—á–µ–Ω–æ –Ω–∞ —Å—Ç–∏–ø–µ–Ω–¥—ñ—ó?
- –°–∫—ñ–ª—å–∫–∏ —Ç–æ–≤–∞—Ä—ñ–≤ –ø—Ä–æ–¥–∞–Ω–æ?

### –ë–∞–∑–æ–≤–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

```sql
SELECT SUM(Grants) AS total_grants_budget
FROM Students;
```

**–ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ –≤—Ä—É—á–Ω—É –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏**:

```
1000 + 1100 + 1200 + 1200 + 1256 + 1256 + 1300 + 1300 = 9612 –≥—Ä–Ω
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–ø–∏—Ç—É**:

```
total_grants_budget
-------------------
9612.00
```

::note
**–í–∞–∂–ª–∏–≤–æ**: `SUM()` **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ–≥–Ω–æ—Ä—É—î NULL** –∑–Ω–∞—á–µ–Ω–Ω—è. –Ø–∫—â–æ —É –≤—Å—ñ—Ö —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —Å—Ç–∏–ø–µ–Ω–¥—ñ—è NULL, —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ `NULL` (–∞ –Ω–µ 0!).
::

### –û–±—á–∏—Å–ª—é–≤–∞–Ω—ñ –≤–∏—Ä–∞–∑–∏ –≤ SUM()

–§—É–Ω–∫—Ü—ñ—è `SUM()` –º–æ–∂–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –Ω–µ —Ç—ñ–ª—å–∫–∏ –∑—ñ —Å—Ç–æ–≤–ø—Ü—è–º–∏, –∞–ª–µ –π –∑ **–≤–∏—Ä–∞–∑–∞–º–∏**:

```sql
-- –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –∑–∞–≥–∞–ª—å–Ω–æ—ó –≤–∏—Ä—É—á–∫–∏ (—Ü—ñ–Ω–∞ √ó –∫—ñ–ª—å–∫—ñ—Å—Ç—å)
SELECT
    SUM(price * quantity) AS total_revenue
FROM OrderItems;
```

**–ü—Ä–∏–∫–ª–∞–¥ –¥–∞–Ω–∏—Ö**:

| product_name | price | quantity | price √ó quantity |
| :----------- | ----: | -------: | ---------------: |
| –ù–æ—É—Ç–±—É–∫      | 20000 |        2 |            40000 |
| –ú–∏—à–∞         |   300 |       10 |             3000 |
| –ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞   |  1500 |        5 |             7500 |

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

```
total_revenue
-------------
50500.00
```

**–ü–æ—è—Å–Ω–µ–Ω–Ω—è**: SQL Server **—Å–ø–æ—á–∞—Ç–∫—É –æ–±—á–∏—Å–ª—é—î –≤–∏—Ä–∞–∑** –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞ (20000√ó2, 300√ó10, 1500√ó5), –∞ **–ø–æ—Ç—ñ–º** —Å—É–º—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏.

---

## AVG(): –°–µ—Ä–µ–¥–Ω—î –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–µ

### –ö–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω–µ —Å–µ—Ä–µ–¥–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è?

–°–µ—Ä–µ–¥–Ω—ñ –ø–æ–∫–∞–∑–Ω–∏–∫–∏ –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å –∑—Ä–æ–∑—É–º—ñ—Ç–∏ "—Ç–∏–ø–æ–≤—É" —Å–∏—Ç—É–∞—Ü—ñ—é:

- –Ø–∫–∏–π —Å–µ—Ä–µ–¥–Ω—ñ–π —á–µ–∫?
- –°–∫—ñ–ª—å–∫–∏ –≤ —Å–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–æ–∫—ñ–≤ –∫–ª—ñ—î–Ω—Ç–∞–º?
- –Ø–∫–∞ —Å–µ—Ä–µ–¥–Ω—è –∑–∞—Ä–ø–ª–∞—Ç–∞?

### –ü—Ä–æ—Å—Ç–∞ —Ñ–æ—Ä–º—É–ª–∞

$$
AVG = \frac{\sum values}{COUNT(non-NULL\ values)}
$$

```sql
SELECT AVG(Grants) AS average_grant
FROM Students;
```

**–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≤—Ä—É—á–Ω—É**:

```
(1000 + 1100 + 1200 + 1200 + 1256 + 1256 + 1300 + 1300) √∑ 8 = 1201.50 –≥—Ä–Ω
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

```
average_grant
-------------
1201.50
```

::warning
**–ö—Ä–∏—Ç–∏—á–Ω–∞ –ø–æ–º–∏–ª–∫–∞**: `AVG()` —ñ–≥–Ω–æ—Ä—É—î NULL, —â–æ –º–æ–∂–µ —Å–ø–æ—Ç–≤–æ—Ä–∏—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!

**–ü—Ä–∏–∫–ª–∞–¥ –ø—Ä–æ–±–ª–µ–º–∏**:

```sql
-- –£ –Ω–∞—Å 10 —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤, –∞–ª–µ —Ç—ñ–ª—å–∫–∏ 8 –æ—Ç—Ä–∏–º—É—é—Ç—å —Å—Ç–∏–ø–µ–Ω–¥—ñ—é
SELECT AVG(Grants) FROM Students;  -- 1201.50
-- –¶–µ –ù–ï —Å–µ—Ä–µ–¥–Ω—è —Å—Ç–∏–ø–µ–Ω–¥—ñ—è –Ω–∞ –æ–¥–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞!
-- –ü—Ä–∞–≤–∏–ª—å–Ω–æ: 9612 √∑ 10 = 961.20 –≥—Ä–Ω –Ω–∞ —Å—Ç—É–¥–µ–Ω—Ç–∞
```

**–†—ñ—à–µ–Ω–Ω—è**:

```sql
SELECT SUM(Grants) / COUNT(*) AS true_average_per_student
FROM Students;  -- 961.20
```

::

### –°–∫–ª–∞–¥–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è –∑ AVG()

**–ó–∞–≤–¥–∞–Ω–Ω—è**: –ó–Ω–∞–π—Ç–∏ —Å–µ—Ä–µ–¥–Ω—ñ–π –≤—ñ–∫ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤

```sql
SELECT
    AVG(DATEDIFF(DAY, BirthDate, GETDATE()) / 365.25) AS average_age
FROM Students;
```

**–†–æ–∑–±—ñ—Ä –∞–Ω–∞—Ç–æ–º—ñ—ó**:

1. `GETDATE()` ‚Äî –ø–æ—Ç–æ—á–Ω–∞ –¥–∞—Ç–∞ (2024-02-08)
2. `DATEDIFF(DAY, BirthDate, GETDATE())` ‚Äî —Ä—ñ–∑–Ω–∏—Ü—è –≤ **–¥–Ω—è—Ö** –º—ñ–∂ –¥–∞—Ç–æ—é –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è —Ç–∞ —Å—å–æ–≥–æ–¥–Ω—ñ
3. `... / 365.25` ‚Äî –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –¥–Ω—ñ —É —Ä–æ–∫–∏ (–∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –≤–∏—Å–æ–∫–æ—Å–Ω–∏—Ö —Ä–æ–∫—ñ–≤)
4. `AVG(...)` ‚Äî —Å–µ—Ä–µ–¥–Ω—î –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–Ω–µ –≤—ñ–∫—É –≤—Å—ñ—Ö —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤

**–ß–æ–º—É 365.25?**  
–£ –∑–≤–∏—á–∞–π–Ω–æ–º—É —Ä–æ—Ü—ñ 365 –¥–Ω—ñ–≤, –∞–ª–µ –∫–æ–∂–Ω—ñ 4 —Ä–æ–∫–∏ ‚Äî –≤–∏—Å–æ–∫–æ—Å–Ω–∏–π —Ä—ñ–∫ (366 –¥–Ω—ñ–≤). –°–µ—Ä–µ–¥–Ω—î: (365√ó3 + 366) √∑ 4 = **365.25** –¥–Ω—ñ–≤.

---

## MIN() —Ç–∞ MAX(): –ü–æ—à—É–∫ –µ–∫—Å—Ç—Ä–µ–º—É–º—ñ–≤

### –ö–æ–ª–∏ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –º—ñ–Ω—ñ–º—É–º/–º–∞–∫—Å–∏–º—É–º?

- –•—Ç–æ –Ω–∞–π—Å—Ç–∞—Ä—à–∏–π/–Ω–∞–π–º–æ–ª–æ–¥—à–∏–π –∫–ª—ñ—î–Ω—Ç?
- –Ø–∫–∞ –Ω–∞–π–¥–µ—à–µ–≤—à–∞/–Ω–∞–π–¥–æ—Ä–æ–∂—á–∞ –ø–æ–∫—É–ø–∫–∞?
- –ö–æ–ª–∏ –±—É–ª–æ –æ—Å—Ç–∞–Ω–Ω—î –∑–∞–º–æ–≤–ª–µ–Ω–Ω—è?

### MIN(): –ù–∞–π–º–µ–Ω—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è

```sql
SELECT MIN(BirthDate) AS oldest_student_birthdate
FROM Students;
```

**–ü—Ä–∏–∫–ª–∞–¥ –¥–∞–Ω–∏—Ö**:

```
–°—Ç—É–¥–µ–Ω—Ç | –î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è
--------|----------------
–Ü–≤–∞–Ω    | 2000-05-15
–ú–∞—Ä—ñ—è   | 1999-03-22  ‚Üê MIN (–Ω–∞–π—Å—Ç–∞—Ä—à–∞)
–ü–µ—Ç—Ä–æ   | 2001-11-30
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

```
oldest_student_birthdate
------------------------
1999-03-22
```

::note
**–õ–æ–≥—ñ–∫–∞ –¥–ª—è –¥–∞—Ç**: –î–ª—è —Ç–∏–ø—É `DATE`/`DATETIME2`:

- `MIN()` –ø–æ–≤–µ—Ä—Ç–∞—î **–Ω–∞–π–¥–∞–≤–Ω—ñ—à—É** –¥–∞—Ç—É (–Ω–∞–π—Å—Ç–∞—Ä—ñ—à–∏–π —Å—Ç—É–¥–µ–Ω—Ç)
- `MAX()` –ø–æ–≤–µ—Ä—Ç–∞—î **–Ω–∞–π–Ω–æ–≤—ñ—à—É** –¥–∞—Ç—É (–Ω–∞–π–º–æ–ª–æ–¥—à–∏–π —Å—Ç—É–¥–µ–Ω—Ç)
  ::

### MAX(): –ù–∞–π–±—ñ–ª—å—à–µ –∑–Ω–∞—á–µ–Ω–Ω—è

```sql
SELECT MAX(Grants) AS highest_grant
FROM Students;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

```
highest_grant
-------------
1300.00
```

### –†–æ–±–æ—Ç–∞ –∑ —Ç–µ–∫—Å—Ç–æ–≤–∏–º–∏ –¥–∞–Ω–∏–º–∏

**MIN()** —Ç–∞ **MAX()** –ø—Ä–∞—Ü—é—é—Ç—å –Ω–µ —Ç—ñ–ª—å–∫–∏ –∑ —á–∏—Å–ª–∞–º–∏, –∞–ª–µ –π –∑ **—Ç–µ–∫—Å—Ç–æ–º**!

```sql
SELECT
    MIN(LastName) AS first_alphabetically,
    MAX(LastName) AS last_alphabetically
FROM Students;
```

**–Ø–∫ –ø–æ—Ä—ñ–≤–Ω—é—é—Ç—å—Å—è —Ä—è–¥–∫–∏?**  
SQL Server –ø–æ—Ä—ñ–≤–Ω—é—î —Ä—è–¥–∫–∏ **–ø–æ—Å–∏–º–≤–æ–ª—å–Ω–æ** –∑–∞ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ Unicode:

```
–ê–Ω–¥—Ä—ñ–π  < –ë–æ—Ä–∏—Å  < –í—ñ–∫—Ç–æ—Ä—ñ—è < –Ü—Ä–∏–Ω–∞
A (U+0410) < –ë (U+0411) < –í (U+0412) < –Ü (U+0406)
```

**–ü—Ä–∏–∫–ª–∞–¥ –¥–∞–Ω–∏—Ö**:

```
LastName
---------
–Ü–≤–∞–Ω–æ–≤    ‚Üê MAX (–æ—Å—Ç–∞–Ω–Ω—ñ–π –≤ –∞–ª—Ñ–∞–≤—ñ—Ç—ñ –∑–∞ –∫–∏—Ä–∏–ª–∏—á–Ω–æ—é –Ü)
Doe
Brown
–ö–æ–≤–∞–ª–µ–Ω–∫–æ
Moore
–ü–µ—Ç—Ä–µ–Ω–∫–æ
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

```
first_alphabetically | last_alphabetically
---------------------|--------------------
Brown                | –ü–µ—Ç—Ä–µ–Ω–∫–æ
```

::tip
**Unicode —Å–æ—Ä—Ç—É–≤–∞–Ω–Ω—è**: –ê–Ω–≥–ª—ñ–π—Å—å–∫—ñ –ª—ñ—Ç–µ—Ä–∏ (A-Z, U+0041-U+005A) –π–¥—É—Ç—å **—Ä–∞–Ω—ñ—à–µ** –∑–∞ –∫–∏—Ä–∏–ª–∏—á–Ω—ñ (–ê-–Ø, U+0410-U+042F) –≤ Unicode, —Ç–æ–º—É "Brown" < "–Ü–≤–∞–Ω–æ–≤".
::

---

## –†–æ–±–æ—Ç–∞ –∑ NULL –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏

### NULL ‚Äî —Ü–µ –Ω–µ 0 —ñ –Ω–µ –ø–æ—Ä–æ–∂–Ω—ñ–π —Ä—è–¥–æ–∫!

`NULL` –æ–∑–Ω–∞—á–∞—î **–≤—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–Ω—è** –∞–±–æ **–Ω–µ–≤—ñ–¥–æ–º–µ –∑–Ω–∞—á–µ–Ω–Ω—è**.

::tabs

::tab{label="NULL —É COUNT"}

```sql
SELECT
    COUNT(*) AS all_students,        -- 10
    COUNT(Grants) AS with_grants,    -- 8 (—ñ–≥–Ω–æ—Ä—É—î NULL)
    COUNT(*) - COUNT(Grants) AS without_grants  -- 2
FROM Students;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

```
all_students | with_grants | without_grants
-------------|-------------|---------------
          10 |           8 |              2
```

::

::tab{label="NULL —É SUM/AVG"}

```sql
-- –¢–∞–±–ª–∏—Ü—è Orders
INSERT INTO Orders VALUES (1, 100.00);
INSERT INTO Orders VALUES (2, 200.00);
INSERT INTO Orders VALUES (3, NULL);   -- –ù–µ–º–∞—î —Ü—ñ–Ω–∏

SELECT
    SUM(price) AS total,    -- 300.00 (NULL —ñ–≥–Ω–æ—Ä—É—î—Ç—å—Å—è)
    AVG(price) AS average   -- 150.00 (300 √∑ 2, –∞ –Ω–µ √∑ 3!)
FROM Orders;
```

::

::tab{label="NULL —É MIN/MAX"}

```sql
SELECT
    MIN(Grants) AS min_grant,  -- 1000 (NULL —ñ–≥–Ω–æ—Ä—É—î—Ç—å—Å—è)
    MAX(Grants) AS max_grant   -- 1300
FROM Students;
-- NULL –Ω–µ –±–µ—Ä–µ —É—á–∞—Å—Ç—ñ –≤ –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—ñ
```

::

::

::caution
**–ü—ñ–¥—Å—Ç—É–ø–Ω–æ—Å—Ç—ñ NULL**:

```sql
-- ‚ùå –¶–µ –ù–ï –∑–Ω–∞–π–¥–µ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –±–µ–∑ —Å—Ç–∏–ø–µ–Ω–¥—ñ—ó!
SELECT * FROM Students WHERE Grants = NULL;  -- –ó–∞–≤–∂–¥–∏ 0 —Ä—è–¥–∫—ñ–≤!

-- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ:
SELECT * FROM Students WHERE Grants IS NULL;
```

**–ü—Ä–∏—á–∏–Ω–∞**: NULL –æ–∑–Ω–∞—á–∞—î "–Ω–µ–≤—ñ–¥–æ–º–æ", —Ç–æ–º—É `NULL = NULL` –¥–∞—î `UNKNOWN` (–Ω–µ TRUE —ñ –Ω–µ FALSE).
::

---

## –ö–æ–º–±—ñ–Ω—É–≤–∞–Ω–Ω—è –∞–≥—Ä–µ–≥–∞—Ç–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π

–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **–∫—ñ–ª—å–∫–∞** –∞–≥—Ä–µ–≥–∞—Ç–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π –≤ –æ–¥–Ω–æ–º—É –∑–∞–ø–∏—Ç—ñ:

```sql
SELECT
    COUNT(*) AS total_students,
    COUNT(Grants) AS students_with_grants,
    SUM(Grants) AS total_budget,
    AVG(Grants) AS average_grant,
    MIN(Grants) AS min_grant,
    MAX(Grants) AS max_grant,
    MAX(Grants) - MIN(Grants) AS grant_range
FROM Students;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| total_students | students_with_grants | total_budget | average_grant | min_grant | max_grant | grant_range |
| -------------: | -------------------: | -----------: | ------------: | --------: | --------: | ----------: |
|             10 |                    8 |      9612.00 |       1201.50 |   1000.00 |   1300.00 |      300.00 |

**–ü–æ—è—Å–Ω–µ–Ω–Ω—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ —Å—Ç–æ–≤–ø—Ü—è**:  
`MAX(Grants) - MIN(Grants)` ‚Äî —Ü–µ **–¥—ñ–∞–ø–∞–∑–æ–Ω** (range) —Å—Ç–∏–ø–µ–Ω–¥—ñ–π. –û–±—á–∏—Å–ª—é—î—Ç—å—Å—è —è–∫ –≤–∏—Ä–∞–∑ –∑ –¥–≤–æ—Ö –∞–≥—Ä–µ–≥–∞—Ç—ñ–≤.

---

## WHERE vs HAVING: –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –¥–æ —Ç–∞ –ø—ñ—Å–ª—è –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–ª–∏ —Ñ—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏?

–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–Ω–∞–π—Ç–∏ **—Å–µ—Ä–µ–¥–Ω—é —Å—Ç–∏–ø–µ–Ω–¥—ñ—é —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –≥—Ä—É–ø–∏ 30PR11**.

::tabs

::tab{label="WHERE - –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –î–û –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è"}

```sql
SELECT AVG(Grants) AS avg_grant_30PR11
FROM Students AS S
JOIN Groups AS G ON S.GroupId = G.Id
WHERE G.GroupName = '30PR11';  -- –§—ñ–ª—å—Ç—Ä—É—î–º–æ –†–Ø–î–ö–ò –ø–µ—Ä–µ–¥ –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è–º
```

**–ü–æ—Ä—è–¥–æ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è**:

1. JOIN —Ç–∞–±–ª–∏—Ü—å Students —ñ Groups
2. **WHERE** ‚Äî –∑–∞–ª–∏—à–∞—î–º–æ —Ç—ñ–ª—å–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –∑ –≥—Ä—É–ø–∏ 30PR11
3. **AVG()** ‚Äî –æ–±—á–∏—Å–ª—é—î–º–æ —Å–µ—Ä–µ–¥–Ω—é —Å—Ç–∏–ø–µ–Ω–¥—ñ—é **–≤—ñ–¥—Ñ—ñ–ª—å—Ç—Ä–æ–≤–∞–Ω–∏—Ö** —Ä—è–¥–∫—ñ–≤

::

::tab{label="HAVING - –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ü–Ü–°–õ–Ø –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è"}

```sql
-- ‚ùå –¶–µ –ù–ï —Å–ø—Ä–∞—Ü—é—î –¥–ª—è –Ω–∞—à–æ—ó –∑–∞–¥–∞—á—ñ!
SELECT AVG(Grants) AS avg_grant
FROM Students
HAVING AVG(Grants) > 1200;  -- –§—ñ–ª—å—Ç—Ä—É—î–º–æ –†–ï–ó–£–õ–¨–¢–ê–¢ –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è
```

**–ü–æ—Ä—è–¥–æ–∫ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è**:

1. **AVG()** ‚Äî –æ–±—á–∏—Å–ª—é—î–º–æ —Å–µ—Ä–µ–¥–Ω—é —Å—Ç–∏–ø–µ–Ω–¥—ñ—é –¥–ª—è –í–°–Ü–• —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
2. **HAVING** ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —á–∏ —Å–µ—Ä–µ–¥–Ω—è > 1200
3. –Ø–∫—â–æ –¢–ê–ö ‚Äî –ø–æ–∫–∞–∑—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, —è–∫—â–æ –ù–Ü ‚Äî –Ω–µ –ø–æ–∫–∞–∑—É—î–º–æ

::

::

::warning
**–ó–æ–ª–æ—Ç–µ –ø—Ä–∞–≤–∏–ª–æ**:

- `WHERE` ‚Äî —Ñ—ñ–ª—å—Ç—Ä—É—î **–æ–∫—Ä–µ–º—ñ —Ä—è–¥–∫–∏** –î–û –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è
- `HAVING` ‚Äî —Ñ—ñ–ª—å—Ç—Ä—É—î **—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è** –ü–Ü–°–õ–Ø
  ::

### –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –ø–æ—Ä—è–¥–∫—É –≤–∏–∫–æ–Ω–∞–Ω–Ω—è

::mermaid

```mermaid
graph TD
    A[–¢–∞–±–ª–∏—Ü—è Students<br/>10 —Ä—è–¥–∫—ñ–≤] --> B{WHERE<br/>GroupName = '30PR11'}
    B -->|–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è| C[–ó–∞–ª–∏—à–∏–ª–æ—Å—å 3 —Ä—è–¥–∫–∏]
    C --> D[AVG Grants]
    D --> E[–†–µ–∑—É–ª—å—Ç–∞—Ç: 1218.67]

    F[–¢–∞–±–ª–∏—Ü—è Students<br/>10 —Ä—è–¥–∫—ñ–≤] --> G[AVG Grants<br/>–¥–ª—è –≤—Å—ñ—Ö]
    G --> H[–†–µ–∑—É–ª—å—Ç–∞—Ç: 1201.50]
    H --> I{HAVING<br/>AVG > 1200}
    I -->|TRUE| J[–ü–æ–∫–∞–∑–∞—Ç–∏ 1201.50]

    style B fill:#3b82f6,color:#fff
    style I fill:#f59e0b,color:#000
    style C fill:#10b981,color:#fff
    style E fill:#10b981,color:#fff
```

::

---

## –ë–∞–≥–∞—Ç–æ—Ç–∞–±–ª–∏—á–Ω—ñ –∑–∞–ø–∏—Ç–∏ –∑ –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏

–î–æ —Ü—å–æ–≥–æ –º–æ–º–µ–Ω—Ç—É –º–∏ –ø—Ä–∞—Ü—é–≤–∞–ª–∏ –∑ –æ–¥–Ω—ñ—î—é —Ç–∞–±–ª–∏—Ü–µ—é. –£ —Ä–µ–∞–ª—å–Ω–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö –¥–∞–Ω—ñ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ –ø–æ **–∫—ñ–ª—å–∫–æ—Ö —Ç–∞–±–ª–∏—Ü—è—Ö**.

### –°—Ö–µ–º–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö University

::mermaid

```mermaid
erDiagram
    Groups ||--o{ Students : "–º–∞—î"
    Groups {
        int Id PK
        nvarchar GroupName
    }
    Students {
        int Id PK
        nvarchar FirstName
        nvarchar LastName
        int GroupId FK
        decimal Grants
        date BirthDate
    }
```

::

### –ó–∞–≤–¥–∞–Ω–Ω—è: –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —É –∫–æ–∂–Ω—ñ–π –≥—Ä—É–ø—ñ

```sql {2,4,5}
SELECT
    G.GroupName,
    COUNT(S.Id) AS student_count
FROM Groups AS G
LEFT JOIN Students AS S ON G.Id = S.GroupId
GROUP BY G.GroupName;
```

**–ê–Ω–∞—Ç–æ–º—ñ—è –∫–æ–¥—É**:

- **–†—è–¥–æ–∫ 2**: –ù–∞–∑–≤–∞ –≥—Ä—É–ø–∏ (–±—É–¥–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –¥–ª—è –∫–æ–∂–Ω–æ—ó –≥—Ä—É–ø–∏ –æ–∫—Ä–µ–º–æ)
- **–†—è–¥–æ–∫ 3**: –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —É —Ü—ñ–π –≥—Ä—É–ø—ñ
- **–†—è–¥–æ–∫ 4-5**: `LEFT JOIN` ‚Äî —â–æ–± –≤–∫–ª—é—á–∏—Ç–∏ –≥—Ä—É–ø–∏ **–±–µ–∑ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤** (—è–∫—â–æ —Ç–∞–∫—ñ —î)
- **GROUP BY** ‚Äî –ø—Ä–æ —Ü–µ –¥–µ—Ç–∞–ª—å–Ω–æ –≤ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| GroupName | student_count |
| :-------- | ------------: |
| 30PR11    |             3 |
| 30PR12    |             3 |
| 32SS11    |             2 |
| 32SS12    |             2 |

---

## –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π

### –Ø–∫ SQL Server –≤–∏–∫–æ–Ω—É—î –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è?

–ó–∞ –ª–∞—à—Ç—É–Ω–∫–∞–º–∏ SQL Server –º–æ–∂–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏:

::tabs

::tab{label="Stream Aggregate"}

**–ö–æ–ª–∏**: –î–∞–Ω—ñ –≤–∂–µ **–≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω—ñ** (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —î —ñ–Ω–¥–µ–∫—Å)

**–ü—Ä–∏–Ω—Ü–∏–ø**: –ü–æ—Å–ª—ñ–¥–æ–≤–Ω–æ —á–∏—Ç–∞—î —Ä—è–¥–∫–∏ —Ç–∞ –Ω–∞–∫–æ–ø–∏—á—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç

```
–í—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ:  [1, 1, 2, 2, 3, 3]
                     ‚Üì  ‚Üì  ‚Üì  ‚Üì  ‚Üì  ‚Üì
SUM:          1 ‚Üí 2 ‚Üí 4 ‚Üí 6 ‚Üí 9 ‚Üí 12
```

**–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**: O(n) ‚Äî –¥—É–∂–µ —à–≤–∏–¥–∫–æ ‚ö°

::

::tab{label="Hash Aggregate"}

**–ö–æ–ª–∏**: –î–∞–Ω—ñ **–ù–ï** –≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω—ñ

**–ü—Ä–∏–Ω—Ü–∏–ø**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î hash-—Ç–∞–±–ª–∏—Ü—é –¥–ª—è –≥—Ä—É–ø—É–≤–∞–Ω–Ω—è

```
–ù–µ–≤—ñ–¥—Å–æ—Ä—Ç–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ: [3, 1, 2, 1, 3, 2]
                      ‚Üì
Hash Table:  {1: [1,1], 2: [2,2], 3: [3,3]}
             ‚Üì
–†–µ–∑—É–ª—å—Ç–∞—Ç–∏:  {1: SUM=2, 2: SUM=4, 3: SUM=6}
```

**–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**: O(n) –∞–ª–µ **–ø–æ—Ç—Ä–µ–±—É—î –ø–∞–º'—è—Ç—ñ** üêå

::

::

::tip
**–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è**: –°—Ç–≤–æ—Ä—ñ—Ç—å —ñ–Ω–¥–µ–∫—Å –Ω–∞ —Å—Ç–æ–≤–ø—Ü—ñ, –ø–æ —è–∫–æ–º—É —á–∞—Å—Ç–æ –∞–≥—Ä–µ–≥—É—î—Ç–µ:

```sql
CREATE INDEX IX_Students_Grants ON Students(Grants);
-- –¢–µ–ø–µ—Ä SUM(Grants) –±—É–¥–µ —à–≤–∏–¥—à–∏–º!
```

::

---

## –¢–∏–ø–æ–≤—ñ –ø–æ–º–∏–ª–∫–∏ —Ç–∞ Anti-Patterns

### ‚ùå –ü–æ–º–∏–ª–∫–∞ 1: –ó–º—ñ—à—É–≤–∞–Ω–Ω—è –∞–≥—Ä–µ–≥–∞—Ç—ñ–≤ —ñ –Ω–µ–∞–≥—Ä–µ–≥–æ–≤–∞–Ω–∏—Ö —Å—Ç–æ–≤–ø—Ü—ñ–≤

```sql
-- ‚ùå –¶–ï –ù–ï –ü–†–ê–¶–Æ–Ñ!
SELECT
    GroupName,      -- –ù–µ–∞–≥—Ä–µ–≥–æ–≤–∞–Ω–∏–π —Å—Ç–æ–≤–ø–µ—Ü—å
    COUNT(*)        -- –ê–≥—Ä–µ–≥–∞—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
FROM Students AS S
JOIN Groups AS G ON S.GroupId = G.Id;
```

**–ü–æ–º–∏–ª–∫–∞**:

```
Column 'Groups.GroupName' is invalid in the select list
because it is not contained in either an aggregate function
or the GROUP BY clause.
```

**–ß–æ–º—É**: –ê–≥—Ä–µ–≥–∞—Ç –ø–æ–≤–µ—Ä—Ç–∞—î **–æ–¥–Ω–µ** –∑–Ω–∞—á–µ–Ω–Ω—è, –∞ `GroupName` ‚Äî **–±–∞–≥–∞—Ç–æ**. SQL –Ω–µ –∑–Ω–∞—î, —è–∫–µ –∑ –Ω–∏—Ö –≤–∏–±—Ä–∞—Ç–∏.

**–†—ñ—à–µ–Ω–Ω—è**:

```sql
-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
SELECT
    GroupName,
    COUNT(*)
FROM Students AS S
JOIN Groups AS G ON S.GroupId = G.Id
GROUP BY GroupName;  -- –ì—Ä—É–ø—É—î–º–æ –ø–æ GroupName!
```

---

### ‚ùå –ü–æ–º–∏–ª–∫–∞ 2: WHERE –∑–∞–º—ñ—Å—Ç—å HAVING –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ç—ñ–≤

```sql
-- ‚ùå –ù–ï –ü–†–ê–¶–Æ–Ñ
SELECT AVG(Grants) FROM Students
WHERE AVG(Grants) > 1200;
```

**–ü–æ–º–∏–ª–∫–∞**:

```
An aggregate may not appear in the WHERE clause.
```

**–†—ñ—à–µ–Ω–Ω—è**:

```sql
-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
SELECT AVG(Grants) FROM Students
HAVING AVG(Grants) > 1200;
```

---

### ‚ùå –ü–æ–º–∏–ª–∫–∞ 3: –Ü–≥–Ω–æ—Ä—É–≤–∞–Ω–Ω—è NULL —É —Å–µ—Ä–µ–¥–Ω—ñ—Ö –∑–Ω–∞—á–µ–Ω–Ω—è—Ö

```sql
-- ‚ùå –ù–ï–ö–û–†–ï–ö–¢–ù–û: –Ω–µ –≤—Ä–∞—Ö–æ–≤—É—î —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –±–µ–∑ —Å—Ç–∏–ø–µ–Ω–¥—ñ—ó
SELECT AVG(Grants) AS avg_grant FROM Students;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 1201.50 (–ø–æ–¥—ñ–ª–µ–Ω–æ –Ω–∞ 8, –∞ –Ω–µ –Ω–∞ 10!)

-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: —Å–µ—Ä–µ–¥–Ω—è —Å—Ç–∏–ø–µ–Ω–¥—ñ—è –Ω–∞ –í–°–Ü–• —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
SELECT SUM(Grants) / COUNT(*) AS true_avg FROM Students;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 961.20
```

---

## Best Practices: –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —â–æ?

::mermaid

```mermaid
graph TD
    A[–ü–æ—Ç—Ä—ñ–±–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞?] --> B{–û–¥–∏–Ω —Å—Ç–æ–≤–ø–µ—Ü—å?}
    B -->|–¢–∞–∫| C[–ü—Ä–æ—Å—Ç–∞ –∞–≥—Ä–µ–≥–∞—Ç–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è]
    B -->|–ù—ñ, –ø–æ –≥—Ä—É–ø–∞—Ö| D[GROUP BY + –∞–≥—Ä–µ–≥–∞—Ç]

    C --> E{–Ø–∫–∏–π —Å–∞–º–µ –ø–æ–∫–∞–∑–Ω–∏–∫?}
    E -->|–ö—ñ–ª—å–∫—ñ—Å—Ç—å| F[COUNT]
    E -->|–°—É–º–∞| G[SUM]
    E -->|–°–µ—Ä–µ–¥–Ω—î| H[AVG]
    E -->|–ï–∫—Å—Ç—Ä–µ–º—É–º| I[MIN/MAX]

    D --> J{–§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ—Ç—Ä—ñ–±–Ω–∞?}
    J -->|–î–æ –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è| K[WHERE]
    J -->|–ü—ñ—Å–ª—è –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è| L[HAVING]

    style C fill:#10b981,color:#fff
    style D fill:#3b82f6,color:#fff
    style F fill:#f59e0b,color:#000
    style K fill:#ec4899,color:#fff
    style L fill:#8b5cf6,color:#fff
```

::

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è

::steps

### –ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä—ñ—Ç—å —Ç–µ—Å—Ç–æ–≤—É –±–∞–∑—É –¥–∞–Ω–∏—Ö

```sql
CREATE TABLE Products (
    product_id INT PRIMARY KEY,
    product_name NVARCHAR(100),
    category NVARCHAR(50),
    price DECIMAL(10, 2),
    stock_quantity INT,
    supplier_id INT
);

INSERT INTO Products VALUES
(1, '–ù–æ—É—Ç–±—É–∫ Dell XPS', '–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞', 35000.00, 15, 1),
(2, '–ú–∏—à–∞ Logitech', '–ê–∫—Å–µ—Å—É–∞—Ä–∏', 450.00, 120, 2),
(3, '–ö–ª–∞–≤—ñ–∞—Ç—É—Ä–∞ Razer', '–ê–∫—Å–µ—Å—É–∞—Ä–∏', 2500.00, 45, 2),
(4, '–ú–æ–Ω—ñ—Ç–æ—Ä Samsung', '–ï–ª–µ–∫—Ç—Ä–æ–Ω—ñ–∫–∞', 8500.00, 30, 3),
(5, 'SSD 1TB', '–ö–æ–º–ø–ª–µ–∫—Ç—É—é—á—ñ', 2200.00, NULL, 1);
```

### –ö—Ä–æ–∫ 2: –ë–∞–∑–æ–≤—ñ –∞–≥—Ä–µ–≥–∞—Ç–∏

**–ó–∞–≤–¥–∞–Ω–Ω—è**: –ó–Ω–∞–π–¥—ñ—Ç—å:

1. –ó–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–æ–≤–∞—Ä—ñ–≤
2. –°–µ—Ä–µ–¥–Ω—é —Ü—ñ–Ω—É
3. –ù–∞–π–¥–æ—Ä–æ–∂—á–∏–π —Ç–æ–≤–∞—Ä
4. –ó–∞–≥–∞–ª—å–Ω—É –≤–∞—Ä—Ç—ñ—Å—Ç—å —Å–∫–ª–∞–¥—É (—Ü—ñ–Ω–∞ √ó –∫—ñ–ª—å–∫—ñ—Å—Ç—å)

::collapsible{label="–ü–æ–∫–∞–∑–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è"}

```sql
SELECT
    COUNT(*) AS total_products,
    AVG(price) AS avg_price,
    MAX(price) AS max_price,
    SUM(price * ISNULL(stock_quantity, 0)) AS total_inventory_value
FROM Products;
```

**–ü–æ—è—Å–Ω–µ–Ω–Ω—è**:

- `ISNULL(stock_quantity, 0)` ‚Äî –∑–∞–º—ñ–Ω—é—î NULL –Ω–∞ 0, —â–æ–± –Ω–µ –≤—Ç—Ä–∞—Ç–∏—Ç–∏ —Ç–æ–≤–∞—Ä —É –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É

::

### –ö—Ä–æ–∫ 3: –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è

**–ó–∞–≤–¥–∞–Ω–Ω—è**: –ó–Ω–∞–π–¥—ñ—Ç—å —Å–µ—Ä–µ–¥–Ω—é —Ü—ñ–Ω—É —Ç–æ–≤–∞—Ä—ñ–≤ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó "–ê–∫—Å–µ—Å—É–∞—Ä–∏"

::collapsible{label="–ü–æ–∫–∞–∑–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è"}

```sql
SELECT AVG(price) AS avg_accessory_price
FROM Products
WHERE category = '–ê–∫—Å–µ—Å—É–∞—Ä–∏';
```

::

### –ö—Ä–æ–∫ 4: –°–∫–ª–∞–¥–Ω—ñ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è

**–ó–∞–≤–¥–∞–Ω–Ω—è**: –ó–Ω–∞–π–¥—ñ—Ç—å —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ –Ω–∞–π–¥–æ—Ä–æ–∂—á–∏–º —ñ –Ω–∞–π–¥–µ—à–µ–≤—à–∏–º —Ç–æ–≤–∞—Ä–æ–º

::collapsible{label="–ü–æ–∫–∞–∑–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è"}

```sql
SELECT
    MAX(price) - MIN(price) AS price_range,
    MAX(price) AS most_expensive,
    MIN(price) AS cheapest
FROM Products;
```

::

::

---

## –†–µ–∑—é–º–µ

::note
**–ö–ª—é—á–æ–≤—ñ –≤–∏—Å–Ω–æ–≤–∫–∏**:

1. **–ê–≥—Ä–µ–≥–∞—Ç–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó** –ø–µ—Ä–µ—Ç–≤–æ—Ä—é—é—Ç—å –º–Ω–æ–∂–∏–Ω—É —Ä—è–¥–∫—ñ–≤ –≤ –æ–¥–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è
2. **5 –±–∞–∑–æ–≤–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π**: COUNT, SUM, AVG, MIN, MAX
3. **NULL –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —ñ–≥–Ω–æ—Ä—É—î—Ç—å—Å—è** –≤—Å—ñ–º–∞ –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏
4. **WHERE** —Ñ—ñ–ª—å—Ç—Ä—É—î —Ä—è–¥–∫–∏ –î–û –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è
5. **HAVING** —Ñ—ñ–ª—å—Ç—Ä—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ü–Ü–°–õ–Ø –∞–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è
6. **–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å**: –ê–≥—Ä–µ–≥—É–≤–∞–Ω–Ω—è —É –ë–î —à–≤–∏–¥—à–µ —É 100-1000 —Ä–∞–∑—ñ–≤ –Ω—ñ–∂ —É –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É
7. **–Ü–Ω–¥–µ–∫—Å–∏** –ø—Ä–∏—Å–∫–æ—Ä—é—é—Ç—å –∞–≥—Ä–µ–≥–∞—Ç–Ω—ñ –∑–∞–ø–∏—Ç–∏

::

::tip
**–©–æ –¥–∞–ª—ñ?**

–£ –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ –º–∏ –¥–µ—Ç–∞–ª—å–Ω–æ –≤–∏–≤—á–∏–º–æ:

- `GROUP BY` ‚Äî —è–∫ –≥—Ä—É–ø—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ
- `HAVING` ‚Äî —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –≥—Ä—É–ø
- `ROLLUP`, `CUBE`, `GROUPING SETS` ‚Äî –±–∞–≥–∞—Ç–æ—Ä—ñ–≤–Ω–µ–≤—ñ –ø—ñ–¥—Å—É–º–∫–∏

[–ü–µ—Ä–µ–π—Ç–∏ –¥–æ —Ä–æ–∑–¥—ñ–ª—É "–ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö" ‚Üí](./02.grouping-data.md)
::

---

## –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [–û—Ñ—ñ—Ü—ñ–π–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è Microsoft: Aggregate Functions](https://learn.microsoft.com/en-us/sql/t-sql/functions/aggregate-functions-transact-sql)
- [Execution Plans –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ç—ñ–≤](https://learn.microsoft.com/en-us/sql/relational-databases/performance/execution-plans)
