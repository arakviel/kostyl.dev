---
title: –ó–æ–≤–Ω—ñ—à–Ω—ñ –æ–±'—î–¥–Ω–∞–Ω–Ω—è –≤ MS SQL Server
description: –î–µ—Ç–∞–ª—å–Ω–µ –≤–∏–≤—á–µ–Ω–Ω—è LEFT JOIN, RIGHT JOIN —Ç–∞ FULL JOIN –∑ –≤—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è–º–∏ –¥—ñ–∞–≥—Ä–∞–º –í–µ–Ω–Ω–∞ —Ç–∞ –æ–±—Ä–æ–±–∫–æ—é NULL –∑–Ω–∞—á–µ–Ω—å
---

# –ó–æ–≤–Ω—ñ—à–Ω—ñ –æ–±'—î–¥–Ω–∞–Ω–Ω—è (OUTER JOIN)

## –ü—Ä–æ–±–ª–µ–º–∞ INNER JOIN: –í—Ç—Ä–∞—Ç–∞ –¥–∞–Ω–∏—Ö

–£ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ –º–∏ –Ω–∞–≤—á–∏–ª–∏—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ **INNER JOIN**, –∞–ª–µ –≤—ñ–Ω –º–∞—î –≤–∞–∂–ª–∏–≤–µ –æ–±–º–µ–∂–µ–Ω–Ω—è.

### –†–µ–∞–ª—å–Ω–∏–π —Å—Ü–µ–Ω–∞—Ä—ñ–π: –°—Ç—É–¥–µ–Ω—Ç–∏ –±–µ–∑ –æ—Ü—ñ–Ω–æ–∫

–ü—Ä–∏–ø—É—Å—Ç–∏–º–æ, —É –Ω–∞—Å —î —Ç–∞–±–ª–∏—Ü—ñ `Students` —Ç–∞ `Achievements` (—É—Å–ø—ñ—à–Ω—ñ—Å—Ç—å):

```sql
CREATE TABLE Achievements (
    Id INT PRIMARY KEY IDENTITY,
    StudentId INT FOREIGN KEY REFERENCES Students(Id),
    SubjectName NVARCHAR(100),
    Grade INT CHECK (Grade BETWEEN 1 AND 100)
);
```

**–î–∞–Ω—ñ**:

```sql
-- 5 —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
INSERT INTO Students (FirstName, LastName, GroupId, Grants) VALUES
(1, '–Ü–≤–∞–Ω', '–ü–µ—Ç—Ä–µ–Ω–∫–æ', 1, 1200),
(2, '–û–ª–µ–Ω–∞', '–ö–æ–≤–∞–ª–µ–Ω–∫–æ', 1, 1100),
(3, '–ü–µ—Ç—Ä–æ', '–°–∏–¥–æ—Ä–µ–Ω–∫–æ', 2, 1300),
(4, '–ú–∞—Ä—ñ—è', '–Ü–≤–∞–Ω–æ–≤–∞', 2, NULL),    -- –ù–µ–º–∞—î –æ—Ü—ñ–Ω–æ–∫!
(5, '–ê–Ω–¥—Ä—ñ–π', '–ö–æ–≤–∞–ª—å—á—É–∫', 3, 1250); -- –ù–µ–º–∞—î –æ—Ü—ñ–Ω–æ–∫!

-- 3 –æ—Ü—ñ–Ω–∫–∏ (—Ç—ñ–ª—å–∫–∏ –¥–ª—è 3 —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤)
INSERT INTO Achievements VALUES
(1, 1, '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞', 95),
(2, 1, '–§—ñ–∑–∏–∫–∞', 88),
(3, 2, '–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞', 92);
```

**–ó–∞–≤–¥–∞–Ω–Ω—è**: –û—Ç—Ä–∏–º–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ **–í–°–Ü–•** —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —Ç–∞ —ó—Ö–Ω—ñ –æ—Ü—ñ–Ω–∫–∏.

### –°–ø—Ä–æ–±–∞ –∑ INNER JOIN

```sql
SELECT
    S.FirstName,
    S.LastName,
    A.SubjectName,
    A.Grade
FROM Students AS S
INNER JOIN Achievements AS A ON S.Id = A.StudentId;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| FirstName | LastName  | SubjectName | Grade |
| :-------- | :-------- | :---------- | ----: |
| –Ü–≤–∞–Ω      | –ü–µ—Ç—Ä–µ–Ω–∫–æ  | –ú–∞—Ç–µ–º –∞—Ç–∏–∫–∞ |    95 |
| –Ü–≤–∞–Ω      | –ü–µ—Ç—Ä–µ–Ω–∫–æ  | –§—ñ–∑–∏–∫–∞      |    88 |
| –û–ª–µ–Ω–∞     | –ö–æ–≤–∞–ª–µ–Ω–∫–æ | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞  |    92 |

::warning
**–ü—Ä–æ–±–ª–µ–º–∞**: **–ú–∞—Ä—ñ—è** —Ç–∞ **–ê–Ω–¥—Ä—ñ–π** (—Å—Ç—É–¥–µ–Ω—Ç–∏ –±–µ–∑ –æ—Ü—ñ–Ω–æ–∫) **–ù–ï** –ø–æ—Ç—Ä–∞–ø–∏–ª–∏ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!  
INNER JOIN –ø–æ–≤–µ—Ä—Ç–∞—î —Ç—ñ–ª—å–∫–∏ —Ä—è–¥–∫–∏, –¥–µ —î **–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å** —É –æ–±–æ—Ö —Ç–∞–±–ª–∏—Ü—è—Ö.
::

---

## –†—ñ—à–µ–Ω–Ω—è: LEFT JOIN

**LEFT JOIN (LEFT OUTER JOIN)** –ø–æ–≤–µ—Ä—Ç–∞—î **–í–°–Ü** —Ä—è–¥–∫–∏ –∑ **–ª—ñ–≤–æ—ó** —Ç–∞–±–ª–∏—Ü—ñ, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –Ω–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç–µ–π –≤ –ø—Ä–∞–≤—ñ–π.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å

```sql
SELECT <—Å—Ç–æ–≤–ø—Ü—ñ>
FROM <–õ—ñ–≤–∞_–¢–∞–±–ª–∏—Ü—è>
LEFT JOIN <–ü—Ä–∞–≤–∞_–¢–∞–±–ª–∏—Ü—è>
    ON <—É–º–æ–≤–∞>
```

### –¢–æ–π —Å–∞–º–∏–π –∑–∞–ø–∏—Ç –∑ LEFT JOIN

```sql {4}
SELECT
    S.FirstName,
    S.LastName,
    A.SubjectName,
    A.Grade
FROM Students AS S
LEFT JOIN Achievements AS A ON S.Id = A.StudentId;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| FirstName | LastName  | SubjectName | Grade |
| :-------- | :-------- | :---------- | ----: |
| –Ü–≤–∞–Ω      | –ü–µ—Ç—Ä–µ–Ω–∫–æ  | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞  |    95 |
| –Ü–≤–∞–Ω      | –ü–µ—Ç—Ä–µ–Ω–∫–æ  | –§—ñ–∑–∏–∫–∞      |    88 |
| –û–ª–µ–Ω–∞     | –ö–æ–≤–∞–ª–µ–Ω–∫–æ | –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞  |    92 |
| –ü–µ—Ç—Ä–æ     | –°–∏–¥–æ—Ä–µ–Ω–∫–æ | **NULL**    |  NULL |
| –ú–∞—Ä—ñ—è     | –Ü–≤–∞–Ω–æ–≤–∞   | **NULL**    |  NULL |
| –ê–Ω–¥—Ä—ñ–π    | –ö–æ–≤–∞–ª—å—á—É–∫ | **NULL**    |  NULL |

::note
**–ö–ª—é—á–æ–≤–∞ –≤—ñ–¥–º—ñ–Ω–Ω—ñ—Å—Ç—å**: –°—Ç—É–¥–µ–Ω—Ç–∏ **–±–µ–∑ –æ—Ü—ñ–Ω–æ–∫** —Ç–µ–ø–µ—Ä –ø—Ä–∏—Å—É—Ç–Ω—ñ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ, –∞–ª–µ —Å—Ç–æ–≤–ø—Ü—ñ –∑ Achievements –∑–∞–ø–æ–≤–Ω–µ–Ω—ñ **NULL**.
::

---

## –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è: –î—ñ–∞–≥—Ä–∞–º–∏ –í–µ–Ω–Ω–∞ –¥–ª—è JOIN

::mermaid

```mermaid
graph TD
    subgraph INNER JOIN
        direction LR
        A1[Students]
        B1[Achievements]
        C1[–†–µ–∑—É–ª—å—Ç–∞—Ç:<br/>–¢—ñ–ª—å–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ]

        A1 -.->|Intersection| C1
        B1 -.->|Intersection| C1
    end

    subgraph LEFT JOIN
        direction LR
        A2[Students<br/>–í–°–Ü —Ä—è–¥–∫–∏]
        B2[Achievements<br/>–ü—ñ–¥—Ö–æ–¥—è—â—ñ]
        C2[–†–µ–∑—É–ª—å—Ç–∞—Ç:<br/>–í—Å—ñ Students<br/>+ NULL –¥–ª—è –Ω–µ—Å–ø—ñ–≤–ø–∞–¥—ñ–Ω—å]

        A2 -->|–í—Å—ñ| C2
        B2 -.->|–Ø–∫—â–æ —î| C2
    end

    subgraph RIGHT JOIN
        direction LR
        A3[Students<br/>–ü—ñ–¥—Ö–æ–¥—è—â—ñ]
        B3[Achievements<br/>–í–°–Ü —Ä—è–¥–∫–∏]
        C3[–†–µ–∑—É–ª—å—Ç–∞—Ç:<br/>–í—Å—ñ Achievements<br/>+ NULL –¥–ª—è –Ω–µ—Å–ø—ñ–≤–ø–∞–¥—ñ–Ω—å]

        A3 -.->|–Ø–∫—â–æ —î| C3
        B3 -->|–í—Å—ñ| C3
    end

    subgraph FULL JOIN
        direction LR
        A4[Students<br/>–í–°–Ü]
        B4[Achievements<br/>–í–°–Ü]
        C4[–†–µ–∑—É–ª—å—Ç–∞—Ç:<br/>–í—Å—ñ –∑ –æ–±–æ—Ö<br/>+ NULL –¥–µ –Ω–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç–µ–π]

        A4 -->|–í—Å—ñ| C4
        B4 -->|–í—Å—ñ| C4
    end

    style C1 fill:#f59e0b,color:#000
    style C2 fill:#3b82f6,color:#fff
    style C3 fill:#8b5cf6,color:#fff
    style C4 fill:#10b981,color:#fff
```

::

---

## –ö–ª–∞—Å–∏—á–Ω—ñ –¥—ñ–∞–≥—Ä–∞–º–∏ –í–µ–Ω–Ω–∞ –¥–ª—è JOIN

::tabs

::tab{label="INNER JOIN"}

```
     Students    Achievements
        ‚ï≠‚îÄ‚îÄ‚îÄ‚ïÆ   ‚ï≠‚îÄ‚îÄ‚îÄ‚ïÆ
        ‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ
        ‚îÇ   ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ   ‚îÇ
        ‚îÇ   ‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚îÇ
        ‚îÇ   ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ   ‚îÇ
        ‚îÇ       ‚îÇ   ‚îÇ
        ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ   ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ
```

**–¢—ñ–ª—å–∫–∏ –ø–µ—Ä–µ—Ç–∏–Ω** (‚ñà) ‚Äî —Ä—è–¥–∫–∏ –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—è–º–∏ –≤ –æ–±–æ—Ö —Ç–∞–±–ª–∏—Ü—è—Ö.

::

::tab{label="LEFT JOIN"}

```
     Students    Achievements
        ‚ï≠‚îÄ‚îÄ‚îÄ‚ïÆ   ‚ï≠‚îÄ‚îÄ‚îÄ‚ïÆ
        ‚îÇ‚ñà‚ñà‚ñà‚îÇ   ‚îÇ   ‚îÇ
        ‚îÇ‚ñà‚ñà‚ñà‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ   ‚îÇ
        ‚îÇ‚ñà‚ñà‚ñà‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà  ‚îÇ
        ‚îÇ‚ñà‚ñà‚ñà‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ   ‚îÇ
        ‚îÇ‚ñà‚ñà‚ñà    ‚îÇ   ‚îÇ
        ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ   ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ
```

**–í—Å—è –ª—ñ–≤–∞** (‚ñà) ‚Äî –≤—Å—ñ Students + –ø—ñ–¥—Ö–æ–¥—è—â—ñ Achievements (NULL –¥–ª—è —Ä–µ—à—Ç–∏).

::

::tab{label="RIGHT JOIN"}

```
     Students    Achievements
        ‚ï≠‚îÄ‚îÄ‚îÄ‚ïÆ   ‚ï≠‚îÄ‚îÄ‚îÄ‚ïÆ
        ‚îÇ   ‚îÇ   ‚îÇ‚ñà‚ñà‚ñà‚îÇ
        ‚îÇ   ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ‚ñà‚ñà‚ñà‚îÇ
        ‚îÇ   ‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚îÇ
        ‚îÇ   ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ‚ñà‚ñà‚ñà‚îÇ
        ‚îÇ       ‚îÇ‚ñà‚ñà‚ñà‚îÇ
        ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ   ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ
```

**–í—Å—è –ø—Ä–∞–≤–∞** (‚ñà) ‚Äî –≤—Å—ñ Achievements + –ø—ñ–¥—Ö–æ–¥—è—â—ñ Students (NULL –¥–ª—è —Ä–µ—à—Ç–∏).

::

::tab{label="FULL JOIN"}

```
     Students    Achievements
        ‚ï≠‚îÄ‚îÄ‚îÄ‚ïÆ   ‚ï≠‚îÄ‚îÄ‚îÄ‚ïÆ
        ‚îÇ‚ñà‚ñà‚ñà‚îÇ   ‚îÇ‚ñà‚ñà‚ñà‚îÇ
        ‚îÇ‚ñà‚ñà‚ñà‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ‚ñà‚ñà‚ñà‚îÇ
        ‚îÇ‚ñà‚ñà‚ñà‚îÇ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚îÇ
        ‚îÇ‚ñà‚ñà‚ñà‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ‚ñà‚ñà‚ñà‚îÇ
        ‚îÇ‚ñà‚ñà‚ñà    ‚îÇ‚ñà‚ñà‚ñà‚îÇ
        ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ   ‚ï∞‚îÄ‚îÄ‚îÄ‚ïØ
```

**–í—Å—ñ –∑ –æ–±–æ—Ö** (‚ñà) ‚Äî –≤—Å—ñ Students + –≤—Å—ñ Achievements, NULL –¥–µ –Ω–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç–µ–π.

::

::

---

## LEFT JOIN: –î–µ—Ç–∞–ª—å–Ω–∏–π —Ä–æ–∑–±—ñ—Ä

### –Ø–∫ –ø—Ä–∞—Ü—é—î LEFT JOIN?

::plant-uml

```plantuml
@startuml
skinparam backgroundColor #1e1e2e
skinparam defaultFontColor #cdd6f4

participant "Students (–õ—ñ–≤–∞)" as S #a6e3a1
participant "JOIN Engine" as J #f9e2af
participant "Achievements (–ü—Ä–∞–≤–∞)" as A #89b4fa
participant "Result" as R #cba6f7

S -> J: –ß–∏—Ç–∞—î –í–°–Ü —Ä—è–¥–∫–∏ Students
activate J
J -> J: –Ü–≤–∞–Ω (Id=1)
J -> J: –û–ª–µ–Ω–∞ (Id=2)
J -> J: –ü–µ—Ç—Ä–æ (Id=3) - –±–µ–∑ –æ—Ü—ñ–Ω–æ–∫
J -> J: –ú–∞—Ä—ñ—è (Id=4) - –±–µ–∑ –æ—Ü—ñ–Ω–æ–∫

J -> A: –®—É–∫–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –≤ Achievements
activate A
A --> J: StudentId=1 ‚Üí –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞, 95
A --> J: StudentId=1 ‚Üí –§—ñ–∑–∏–∫–∞, 88
A --> J: StudentId=2 ‚Üí –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞, 92
A --> J: StudentId=3 ‚Üí –ù–ï–ú–ê–Ñ
A --> J: StudentId=4 ‚Üí –ù–ï–ú–ê–Ñ
deactivate A

J -> R: –§–æ—Ä–º—É—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç
activate R
R -> R: –Ü–≤–∞–Ω + –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞, 95
R -> R: –Ü–≤–∞–Ω + –§—ñ–∑–∏–∫–∞, 88
R -> R: –û–ª–µ–Ω–∞ + –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞, 92
R -> R: –ü–µ—Ç—Ä–æ + NULL, NULL ‚Üê –ó–±–µ—Ä—ñ–≥—Å—è!
R -> R: –ú–∞—Ä—ñ—è + NULL, NULL ‚Üê –ó–±–µ—Ä—ñ–≥—Å—è!
deactivate R

Note over S,R: –í—Å—ñ —Å—Ç—É–¥–µ–Ω—Ç–∏ –ø—Ä–∏—Å—É—Ç–Ω—ñ,\n–ùULL –¥–ª—è —Ç–∏—Ö, —É –∫–æ–≥–æ –Ω–µ–º–∞—î –æ—Ü—ñ–Ω–æ–∫

deactivate J

@enduml
```

::

### –ü—Ä–∞–∫—Ç–∏—á–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥: –ì—Ä—É–ø–∏ –±–µ–∑ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤

**–ó–∞–≤–¥–∞–Ω–Ω—è**: –ü–æ–∫–∞–∑–∞—Ç–∏ **–≤—Å—ñ** –≥—Ä—É–ø–∏ —Ç–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —É –∫–æ–∂–Ω—ñ–π (–≤–∫–ª—é—á–Ω–æ –∑ –ø–æ—Ä–æ–∂–Ω—ñ–º–∏ –≥—Ä—É–ø–∞–º–∏).

```sql {5}
SELECT
    G.GroupName,
    COUNT(S.Id) AS StudentCount  -- COUNT(S.Id) —ñ–≥–Ω–æ—Ä—É—î NULL
FROM Groups AS G
LEFT JOIN Students AS S ON G.Id = S.GroupId
GROUP BY G.GroupName
ORDER BY StudentCount DESC;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| GroupName | StudentCount |
| :-------- | -----------: | ---------------------- |
| 30PR11    |            3 |
| 30PR12    |            3 |
| 32SS11    |            2 |
| 33GR12    |            0 | ‚Üê –ì—Ä—É–ø–∞ –±–µ–∑ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤! |

::tip
**–í–∞–∂–ª–∏–≤–æ**: `COUNT(S.Id)` —Ä–∞—Ö—É—î **–Ω–µ-NULL** –∑–Ω–∞—á–µ–Ω–Ω—è, —Ç–æ–º—É –¥–ª—è –≥—Ä—É–ø –±–µ–∑ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –ø–æ–≤–µ—Ä—Ç–∞—î `0`.  
`COUNT(*)` –ø–æ–≤–µ—Ä–Ω–µ `1` (—Ä–∞—Ö—É—î —Ä—è–¥–æ–∫ –∑ NULL), —â–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ!
::

---

## –†–æ–±–æ—Ç–∞ –∑ NULL –ø—ñ—Å–ª—è LEFT JOIN

### –ü—Ä–æ–±–ª–µ–º–∞: NULL —É –æ–±—á–∏—Å–ª–µ–Ω–Ω—è—Ö

```sql
SELECT
    S.FirstName,
    S.Grants,
    A.Grade,
    S.Grants + A.Grade AS Total  -- ‚ùå –ü—Ä–æ–±–ª–µ–º–∞!
FROM Students AS S
LEFT JOIN Achievements AS A ON S.Id = A.StudentId;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| FirstName | Grants | Grade | Total |
| :-------- | -----: | ----: | ----: | --------------------- |
| –Ü–≤–∞–Ω      |   1200 |    95 |  1295 |
| –ü–µ—Ç—Ä–æ     |   1300 |  NULL |  NULL | ‚Üê NULL + —á–∏—Å–ª–æ = NULL |

::warning
**–ê—Ä–∏—Ñ–º–µ—Ç–∏–∫–∞ –∑ NULL**: –ë—É–¥—å-—è–∫–∞ –æ–ø–µ—Ä–∞—Ü—ñ—è –∑ NULL –ø–æ–≤–µ—Ä—Ç–∞—î NULL!

- `1300 + NULL = NULL`
- `NULL / 2 = NULL`
- `NULL > 100 = UNKNOWN`

::

### –†—ñ—à–µ–Ω–Ω—è 1: COALESCE()

```sql {5}
SELECT
    S.FirstName,
    S.Grants,
    A.Grade,
    S.Grants + COALESCE(A.Grade, 0) AS Total
FROM Students AS S
LEFT JOIN Achievements AS A ON S.Id = A.StudentId;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| FirstName | Grants | Grade | Total |
| :-------- | -----: | ----: | ----: | ----------------- |
| –Ü–≤–∞–Ω      |   1200 |    95 |  1295 |
| –ü–µ—Ç—Ä–æ     |   1300 |  NULL |  1300 | ‚Üê 1300 + 0 = 1300 |

**COALESCE(value, default)**: –ü–æ–≤–µ—Ä—Ç–∞—î **–ø–µ—Ä—à–µ –Ω–µ-NULL** –∑–Ω–∞—á–µ–Ω–Ω—è.

### –†—ñ—à–µ–Ω–Ω—è 2: ISNULL()

```sql
ISNULL(A.Grade, 0)  -- SQL Server —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
```

**–†—ñ–∑–Ω–∏—Ü—è ISNULL vs COALESCE**:

| –§—É–Ω–∫—Ü—ñ—è    | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç—ñ–≤ | –°—Ç–∞–Ω–¥–∞—Ä—Ç SQL | –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å      |
| :--------- | -------------------: | :----------- | :------------------ |
| ISNULL()   |                    2 | ‚ùå –ù—ñ        | ‚ö° –¢—Ä–æ—Ö–∏ —à–≤–∏–¥—à–µ     |
| COALESCE() |                    N | ‚úÖ –¢–∞–∫       | üêå –¢—Ä–æ—Ö–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ |

::tip
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è**: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `COALESCE()` –¥–ª—è –ø–æ—Ä—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—ñ, `ISNULL()` –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó —à–≤–∏–¥–∫–æ—Å—Ç—ñ –≤ SQL Server.
::

---

## –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è NULL –ø—ñ—Å–ª—è LEFT JOIN

### –ó–∞–≤–¥–∞–Ω–Ω—è: –ó–Ω–∞–π—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ **–ë–ï–ó** –æ—Ü—ñ–Ω–æ–∫

```sql {6}
SELECT
    S.FirstName,
    S.LastName
FROM Students AS S
LEFT JOIN Achievements AS A ON S.Id = A.StudentId
WHERE A.Id IS NULL;  -- Id –∑ Achievements –±—É–¥–µ NULL, —è–∫—â–æ –Ω–µ–º–∞—î –æ—Ü—ñ–Ω–∫–∏
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| FirstName | LastName  |
| :-------- | :-------- |
| –ü–µ—Ç—Ä–æ     | –°–∏–¥–æ—Ä–µ–Ω–∫–æ |
| –ú–∞—Ä—ñ—è     | –Ü–≤–∞–Ω–æ–≤–∞   |
| –ê–Ω–¥—Ä—ñ–π    | –ö–æ–≤–∞–ª—å—á—É–∫ |

**–ü–æ—è—Å–Ω–µ–Ω–Ω—è**: `A.Id IS NULL` –æ–∑–Ω–∞—á–∞—î, —â–æ –¥–ª—è —Ü—å–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ **–Ω–µ–º–∞—î –∂–æ–¥–Ω–æ–≥–æ –∑–∞–ø–∏—Å—É** –≤ Achievements.

---

## WHERE vs ON —É LEFT JOIN: –ö—Ä–∏—Ç–∏—á–Ω–∞ —Ä—ñ–∑–Ω–∏—Ü—è!

::tabs

::tab{label="WHERE ‚Äî –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î LEFT JOIN –≤ INNER JOIN"}

```sql
SELECT S.FirstName, G.GroupName
FROM Students AS S
LEFT JOIN Groups AS G ON S.GroupId = G.Id
WHERE G.Faculty = 'IT';  -- ‚ùå –ü—Ä–æ–±–ª–µ–º–∞!
```

**–©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è**:

1. LEFT JOIN –¥–æ–¥–∞—î **–≤—Å—ñ—Ö** —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ (–∑ NULL –¥–ª—è –≥—Ä—É–ø)
2. `WHERE G.Faculty = 'IT'` **–≤–∏–¥–∞–ª—è—î** —Ä—è–¥–∫–∏ –¥–µ `G.Faculty = NULL`
3. –†–µ–∑—É–ª—å—Ç–∞—Ç: —Ç—ñ–ª—å–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–∏ –∑ –≥—Ä—É–ø IT (—è–∫ INNER JOIN!)

::

::tab{label="ON ‚Äî –£–º–æ–≤–∞ –ü–Ü–î –ß–ê–° JOIN"}

```sql
SELECT S.FirstName, G.GroupName
FROM Students AS S
LEFT JOIN Groups AS G
    ON S.GroupId = G.Id AND G.Faculty = 'IT';  -- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!
```

**–©–æ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è**:

1. LEFT JOIN –¥–æ–¥–∞—î **–≤—Å—ñ—Ö** —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤
2. –ü—Ä–∏—î–¥–Ω—É—î –≥—Ä—É–ø–∏ **—Ç—ñ–ª—å–∫–∏ —è–∫—â–æ** `Faculty = 'IT'`
3. –°—Ç—É–¥–µ–Ω—Ç–∏ –∑ –Ω–µ-IT –≥—Ä—É–ø –æ—Ç—Ä–∏–º–∞—é—Ç—å `NULL` –¥–ª—è GroupName

::

::

::caution
**–ó–æ–ª–æ—Ç–µ –ø—Ä–∞–≤–∏–ª–æ**: –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—é **–ø—Ä–∞–≤–æ—ó** —Ç–∞–±–ª–∏—Ü—ñ –≤ LEFT JOIN —Ä–æ–±—ñ—Ç—å –≤ `ON`, –∞ –Ω–µ –≤ `WHERE`!
::

---

## RIGHT JOIN: –î–∑–µ—Ä–∫–∞–ª–æ LEFT JOIN

**RIGHT JOIN** ‚Äî —Ü–µ **–¥–∑–µ—Ä–∫–∞–ª—å–Ω–µ** –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è LEFT JOIN: –∑–±–µ—Ä—ñ–≥–∞—î **–í–°–Ü** —Ä—è–¥–∫–∏ –∑ **–ø—Ä–∞–≤–æ—ó** —Ç–∞–±–ª–∏—Ü—ñ.

### –ü—Ä–∏–∫–ª–∞–¥

```sql
SELECT
    S.FirstName,
    A.SubjectName,
    A.Grade
FROM Achievements AS A
RIGHT JOIN Students AS S ON A.StudentId = S.Id;
```

**–¶–µ –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–æ**:

```sql
-- –ü—Ä–æ—Å—Ç–æ –º—ñ–Ω—è—î–º–æ —Ç–∞–±–ª–∏—Ü—ñ –º—ñ—Å—Ü—è–º–∏
FROM Students AS S
LEFT JOIN Achievements AS A ON S.Id = A.StudentId;
```

::note
**–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ RIGHT JOIN?**  
–ë—ñ–ª—å—à—ñ—Å—Ç—å —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤ **—É–Ω–∏–∫–∞—é—Ç—å** RIGHT JOIN, –±–æ –≤—ñ–Ω –º–µ–Ω—à —ñ–Ω—Ç—É—ó—Ç–∏–≤–Ω–∏–π. –ó–∞–≤–∂–¥–∏ –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–ø–∏—Å–∞—Ç–∏ —è–∫ LEFT JOIN.
::

### –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è RIGHT –≤ LEFT

::code-group

```sql [RIGHT JOIN]
FROM Orders AS O
RIGHT JOIN Customers AS C
ON O.CustomerId = C.Id
```

```sql [LEFT JOIN (–∫—Ä–∞—â–µ)]
FROM Customers AS C
LEFT JOIN Orders AS O
ON C.Id = O.CustomerId
```

::

---

## FULL JOIN: –ö–æ–º–±—ñ–Ω–∞—Ü—ñ—è LEFT + RIGHT

**FULL JOIN (FULL OUTER JOIN)** –ø–æ–≤–µ—Ä—Ç–∞—î **–í–°–Ü** —Ä—è–¥–∫–∏ –∑ **–æ–±–æ—Ö** —Ç–∞–±–ª–∏—Ü—å, –∑–∞–ø–æ–≤–Ω—é—é—á–∏ NULL –¥–µ –Ω–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç–µ–π.

### –°–∏–Ω—Ç–∞–∫—Å–∏—Å

```sql
SELECT <—Å—Ç–æ–≤–ø—Ü—ñ>
FROM <–¢–∞–±–ª–∏—Ü—è_1>
FULL JOIN <–¢–∞–±–ª–∏—Ü—è_2>
    ON <—É–º–æ–≤–∞>
```

### –ü—Ä–∏–∫–ª–∞–¥: –í—Å—ñ —Å—Ç—É–¥–µ–Ω—Ç–∏ —Ç–∞ –≤—Å—ñ –≥—Ä—É–ø–∏

```sql
SELECT
    S.FirstName,
    S.LastName,
    G.GroupName
FROM Students AS S
FULL JOIN Groups AS G ON S.GroupId = G.Id;
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| FirstName | LastName  | GroupName |
| :-------- | :-------- | :-------- | --------------------- |
| –Ü–≤–∞–Ω      | –ü–µ—Ç—Ä–µ–Ω–∫–æ  | 30PR11    |
| –û–ª–µ–Ω–∞     | –ö–æ–≤–∞–ª–µ–Ω–∫–æ | 30PR11    |
| –ü–µ—Ç—Ä–æ     | –°–∏–¥–æ—Ä–µ–Ω–∫–æ | 30PR12    |
| –ú–∞—Ä—ñ—è     | NULL      | NULL      | ‚Üê –°—Ç—É–¥–µ–Ω—Ç–∫–∞ –±–µ–∑ –≥—Ä—É–ø–∏ |
| NULL      | NULL      | 33GR12    | ‚Üê –ì—Ä—É–ø–∞ –±–µ–∑ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ |

::note
**–ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ FULL JOIN?**

- –ü–æ—à—É–∫ —Ä–æ–∑–±—ñ–∂–Ω–æ—Å—Ç–µ–π –º—ñ–∂ —Ç–∞–±–ª–∏—Ü—è–º–∏
- –ê—É–¥–∏—Ç –¥–∞–Ω–∏—Ö (—Ö—Ç–æ –±–µ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç–µ–π?)
- –ó–≤—ñ—Ç–∏ "–≤—Å–µ + –≤—Å–µ"

::

---

## –ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Å—ñ–≤ –±–µ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç–µ–π

### –ó–∞–≤–¥–∞–Ω–Ω—è: –°—Ç—É–¥–µ–Ω—Ç–∏ –ë–ï–ó –≥—Ä—É–ø–∏ —Ç–∞ –ì—Ä—É–ø–∏ –ë–ï–ó —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤

```sql {6-7}
SELECT
    S.FirstName,
    G.GroupName,
    CASE
        WHEN S.Id IS NULL THEN '–ì—Ä—É–ø–∞ –±–µ–∑ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤'
        WHEN G.Id IS NULL THEN '–°—Ç—É–¥–µ–Ω—Ç –±–µ–∑ –≥—Ä—É–ø–∏'
        ELSE 'OK'
    END AS Status
FROM Students AS S
FULL JOIN Groups AS G ON S.GroupId = G.Id
WHERE S.Id IS NULL OR G.Id IS NULL;  -- –¢—ñ–ª—å–∫–∏ "–ø—Ä–æ–±–ª–µ–º–Ω—ñ" —Ä—è–¥–∫–∏
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**:

| FirstName | GroupName | Status              |
| :-------- | :-------- | :------------------ |
| –ú–∞—Ä—ñ—è     | NULL      | –°—Ç—É–¥–µ–Ω—Ç –±–µ–∑ –≥—Ä—É–ø–∏   |
| NULL      | 33GR12    | –ì—Ä—É–ø–∞ –±–µ–∑ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ |

---

## –ö–æ–º–±—ñ–Ω—É–≤–∞–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ JOIN

### –ü—Ä–∏–∫–ª–∞–¥: LEFT + LEFT

**–ó–∞–≤–¥–∞–Ω–Ω—è**: –í—Å—ñ —Å—Ç—É–¥–µ–Ω—Ç–∏ + —ó—Ö–Ω—è –≥—Ä—É–ø–∞ + –∫—É—Ä–∞—Ç–æ—Ä –≥—Ä—É–ø–∏ (—è–∫—â–æ —î).

```sql
SELECT
    S.FirstName AS Student,
    G.GroupName,
    T.FirstName + ' ' + T.LastName AS Teacher
FROM Students AS S
LEFT JOIN Groups AS G ON S.GroupId = G.Id
LEFT JOIN Teachers AS T ON G.TeacherId = T.Id;
```

**–ö–ª—é—á**: **–ü–æ—Ä—è–¥–æ–∫** –≤–∞–∂–ª–∏–≤–∏–π! –î—Ä—É–≥–∏–π LEFT JOIN –ø—Ä–∏—î–¥–Ω—É—î—Ç—å—Å—è –¥–æ **—Ä–µ–∑—É–ª—å—Ç–∞—Ç—É** –ø–µ—Ä—à–æ–≥–æ LEFT JOIN.

---

### –ü—Ä–∏–∫–ª–∞–¥: LEFT + INNER

**–ó–∞–≤–¥–∞–Ω–Ω—è**: –í—Å—ñ –≥—Ä—É–ø–∏ + —Ç—ñ–ª—å–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–∏ –∑—ñ —Å—Ç–∏–ø–µ–Ω–¥—ñ—è–º–∏.

```sql {4-5}
SELECT
    G.GroupName,
    S.FirstName,
    S.Grants
FROM Groups AS G
LEFT JOIN Students AS S
    ON G.Id = S.GroupId AND S.Grants IS NOT NULL;
```

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞** (–º–µ–Ω—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∞):

```sql
FROM Groups AS G
LEFT JOIN Students AS S ON G.Id = S.GroupId
WHERE S.Grants IS NOT NULL OR S.Grants IS NULL;  -- –ù–µ–∑—Ä–æ–∑—É–º—ñ–ª–æ!
```

---

## –°–∫–ª–∞–¥–Ω–∏–π –ø—Ä–∏–∫–ª–∞–¥: 4 —Ç–∞–±–ª–∏—Ü—ñ –∑ —Ä—ñ–∑–Ω–∏–º–∏ JOIN

**–°—Ö–µ–º–∞**:

::mermaid

```mermaid
erDiagram
    Teachers ||--o{ Groups : "–∫—É—Ä—É—î"
    Groups ||--o{ Students : "–º–∞—î"
    Students ||--o{ Achievements : "–º–∞—î –æ—Ü—ñ–Ω–∫–∏"

    Teachers {
        int Id PK
        nvarchar FirstName
    }

    Groups {
        int Id PK
        nvarchar GroupName
        int TeacherId FK
    }

    Students {
        int Id PK
        nvarchar FirstName
        int GroupId FK
    }

    Achievements {
        int Id PK
        int StudentId FK
        int Grade
    }
```

::

**–ó–∞–≤–¥–∞–Ω–Ω—è**: –ó–≤—ñ—Ç –ø–æ –≤—Å—ñ—Ö –≥—Ä—É–ø–∞—Ö –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ —Ç–∞ —ó—Ö–Ω—é —É—Å–ø—ñ—à–Ω—ñ—Å—Ç—å.

```sql
SELECT
    G.GroupName,
    T.FirstName + ' ' + T.LastName AS Teacher,
    S.FirstName AS Student,
    AVG(A.Grade) AS AvgGrade
FROM Groups AS G
LEFT JOIN Teachers AS T ON G.TeacherId = T.Id
LEFT JOIN Students AS S ON G.Id = S.GroupId
LEFT JOIN Achievements AS A ON S.Id = A.StudentId
GROUP BY G.GroupName, T.FirstName, T.LastName, S.FirstName
ORDER BY G.GroupName, S.FirstName;
```

**–¶–µ–π –∑–∞–ø–∏—Ç –ø–æ–≤–µ—Ä–Ω–µ**:

- **–í—Å—ñ** –≥—Ä—É–ø–∏ (–Ω–∞–≤—ñ—Ç—å –±–µ–∑ –≤–∏–∫–ª–∞–¥–∞—á–∞)
- **–í—Å—ñ** —Å—Ç—É–¥–µ–Ω—Ç–∏ (–Ω–∞–≤—ñ—Ç—å –±–µ–∑ –æ—Ü—ñ–Ω–æ–∫ ‚Üí AvgGrade = NULL)
- –ì—Ä—É–ø–∏ –±–µ–∑ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ –º–∞—Ç–∏–º—É—Ç—å NULL —É —Å—Ç–æ–≤–ø—Ü—è—Ö Student —ñ AvgGrade

---

## Performance Tips –¥–ª—è LEFT JOIN

### –ü—Ä–æ–±–ª–µ–º–∞: LEFT JOIN –º–æ–∂–µ –±—É—Ç–∏ –ø–æ–≤—ñ–ª—å–Ω—ñ—à–∏–º –∑–∞ INNER JOIN

```sql
-- INNER JOIN: SQL Server –º–æ–∂–µ –≤–∏–±—Ä–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π –ø–æ—Ä—è–¥–æ–∫
FROM Students AS S INNER JOIN Groups AS G

-- LEFT JOIN: –ü–æ—Ä—è–¥–æ–∫ —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏–π (Students –ø–µ—Ä—ài!)
FROM Students AS S LEFT JOIN Groups AS G
```

### –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

::steps

### 1. –Ü–Ω–¥–µ–∫—Å–∏ –Ω–∞ FK

```sql
CREATE INDEX IX_Students_GroupId ON Students(GroupId);
CREATE INDEX IX_Achievements_StudentId ON Achievements(StudentId);
```

### 2. –§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –ª—ñ–≤—É —Ç–∞–±–ª–∏—Ü—é —É WHERE

```sql
-- ‚úÖ –®–≤–∏–¥—à–µ: –∑–º–µ–Ω—à—É—î –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤ –¥–ª—è JOIN
FROM Students AS S
LEFT JOIN Achievements AS A ON S.Id = A.StudentId
WHERE S.GroupId = 1;
```

### 3. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Covering Index

```sql
-- –Ü–Ω–¥–µ–∫—Å –º—ñ—Å—Ç–∏—Ç—å –í–°–Ü –ø–æ—Ç—Ä—ñ–±–Ω—ñ —Å—Ç–æ–≤–ø—Ü—ñ
CREATE INDEX IX_Students_Covering
ON Students(GroupId)
INCLUDE (FirstName, LastName, Grants);
```

::

---

## –¢–∏–ø–æ–≤—ñ Anti-Patterns

### ‚ùå Anti-Pattern 1: RIGHT JOIN –∑–∞–º—ñ—Å—Ç—å LEFT

```sql
-- ‚ùå –ü–û–ì–ê–ù–û: –í–∞–∂–∫–æ —á–∏—Ç–∞—Ç–∏
FROM Achievements AS A
RIGHT JOIN Students AS S ON A.StudentId = S.Id

-- ‚úÖ –î–û–ë–†–ï: –Ü–Ω—Ç—É—ó—Ç–∏–≤–Ω–æ
FROM Students AS S
LEFT JOIN Achievements AS A ON S.Id = A.StudentId
```

---

### ‚ùå Anti-Pattern 2: –ó–∞–±—É–≤–∞–Ω–Ω—è –ø—Ä–æ NULL

```sql
-- ‚ùå –ü–û–ú–ò–õ–ö–ê: –î–µ Grants < 1200 –ê–ë–û NULL?
SELECT S.FirstName, S.Grants
FROM Students AS S
LEFT JOIN Groups AS G ON S.GroupId = G.Id
WHERE S.Grants < 1200;  -- –í—Ç—Ä–∞—Ç–∏–º–æ —Ä—è–¥–∫–∏ –∑ Grants = NULL!

-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
WHERE S.Grants < 1200 OR S.Grants IS NULL;
```

---

### ‚ùå Anti-Pattern 3: WHERE –∑–∞–º—ñ—Å—Ç—å ON –¥–ª—è –ø—Ä–∞–≤–æ—ó —Ç–∞–±–ª–∏—Ü—ñ

```sql
-- ‚ùå –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î LEFT JOIN –≤ INNER JOIN
LEFT JOIN Groups AS G ON S.GroupId = G.Id
WHERE G.Faculty = 'IT';

-- ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
LEFT JOIN Groups AS G
    ON S.GroupId = G.Id AND G.Faculty = 'IT';
```

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è

::steps

### –ó–∞–≤–¥–∞–Ω–Ω—è 1: –í—Å—ñ –≥—Ä—É–ø–∏ —Ç–∞ —Å—Ç—É–¥–µ–Ω—Ç–∏

–û—Ç—Ä–∏–º–∞—Ç–∏ –≤—Å—ñ –≥—Ä—É–ø–∏ –∑ –∫—ñ–ª—å–∫—ñ—Å—Ç—é —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤ (–≤–∫–ª—é—á–Ω–æ –∑ –ø–æ—Ä–æ–∂–Ω—ñ–º–∏).

::collapsible{label="–ü–æ–∫–∞–∑–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è"}

```sql
SELECT
    G.GroupName,
    COUNT(S.Id) AS StudentCount,
    COALESCE(AVG(S.Grants), 0) AS AvgGrant
FROM Groups AS G
LEFT JOIN Students AS S ON G.Id = S.GroupId
GROUP BY G.GroupName
ORDER BY StudentCount DESC;
```

::

### –ó–∞–≤–¥–∞–Ω–Ω—è 2: –°—Ç—É–¥–µ–Ω—Ç–∏ –±–µ–∑ –æ—Ü—ñ–Ω–æ–∫

–ó–Ω–∞–π—Ç–∏ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤, —è–∫—ñ –Ω–µ –º–∞—é—Ç—å **–∂–æ–¥–Ω–æ—ó** –æ—Ü—ñ–Ω–∫–∏.

::collapsible{label="–ü–æ–∫–∞–∑–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è"}

```sql
SELECT
    S.FirstName,
    S.LastName,
    G.GroupName
FROM Students AS S
LEFT JOIN Achievements AS A ON S.Id = A.StudentId
LEFT JOIN Groups AS G ON S.GroupId = G.Id
WHERE A.Id IS NULL
ORDER BY S.LastName;
```

::

### –ó–∞–≤–¥–∞–Ω–Ω—è 3: FULL JOIN –¥–ª—è –∞—É–¥–∏—Ç—É

–ó–Ω–∞–π—Ç–∏ –≤—Å—ñ —Ä–æ–∑–±—ñ–∂–Ω–æ—Å—Ç—ñ: —Å—Ç—É–¥–µ–Ω—Ç–∏ –±–µ–∑ –≥—Ä—É–ø —Ç–∞ –≥—Ä—É–ø–∏ –±–µ–∑ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤.

::collapsible{label="–ü–æ–∫–∞–∑–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è"}

```sql
SELECT
    COALESCE(S.FirstName + ' ' + S.LastName, 'N/A') AS Student,
    COALESCE(G.GroupName, 'N/A') AS GroupName,
    CASE
        WHEN S.Id IS NULL THEN '‚ö† –ì—Ä—É–ø–∞ –±–µ–∑ —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤'
        WHEN G.Id IS NULL THEN '‚ö† –°—Ç—É–¥–µ–Ω—Ç –±–µ–∑ –≥—Ä—É–ø–∏'
    END AS Issue
FROM Students AS S
FULL JOIN Groups AS G ON S.GroupId = G.Id
WHERE S.Id IS NULL OR G.Id IS NULL;
```

::

::

---

## –†–µ–∑—é–º–µ

::note
**–ö–ª—é—á–æ–≤—ñ –≤–∏—Å–Ω–æ–≤–∫–∏**:

1. **INNER JOIN** ‚Äî —Ç—ñ–ª—å–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ
2. **LEFT JOIN** ‚Äî –≤—Å—ñ –∑ –ª—ñ–≤–æ—ó + –ø—ñ–¥—Ö–æ–¥—è—â—ñ –∑ –ø—Ä–∞–≤–æ—ó (NULL –¥–ª—è —Ä–µ—à—Ç–∏)
3. **RIGHT JOIN** ‚Äî –¥–∑–µ—Ä–∫–∞–ª–æ LEFT JOIN (–∫—Ä–∞—â–µ –ø–µ—Ä–µ–ø–∏—Å—É–≤–∞—Ç–∏ —è–∫ LEFT)
4. **FULL JOIN** ‚Äî –≤—Å—ñ –∑ –æ–±–æ—Ö —Ç–∞–±–ª–∏—Ü—å
5. `WHERE` –ø—ñ—Å–ª—è LEFT JOIN –º–æ–∂–µ –ø–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ –π–æ–≥–æ –≤ INNER JOIN
6. **NULL** –ø–æ—Ç—Ä–µ–±—É—î —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ (COALESCE, ISNULL, IS NULL)
7. –Ü–Ω–¥–µ–∫—Å–∏ –∫—Ä–∏—Ç–∏—á–Ω—ñ –¥–ª—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ

::

::tip
**–©–æ –¥–∞–ª—ñ?**

–í –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ:

- **SELF JOIN** ‚Äî –æ–±'—î–¥–Ω–∞–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—ñ –∑ —Å–æ–±–æ—é
- –Ü—î—Ä–∞—Ä—Ö—ñ—á–Ω—ñ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ (—Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫–∏ ‚Üí –º–µ–Ω–µ–¥–∂–µ—Ä–∏)
- JOIN –∑ –ø—ñ–¥–∑–∞–ø–∏—Ç–∞–º–∏ —Ç–∞ CTE
- Advanced performance patterns

[–ü–µ—Ä–µ–π—Ç–∏ –¥–æ —Ä–æ–∑–¥—ñ–ª—É "SELF JOIN —Ç–∞ —Å–∫–ª–∞–¥–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó" ‚Üí](./03.self-joins-advanced.md)
::

---

## –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏

- [–û—Ñ—ñ—Ü—ñ–π–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è: OUTER JOIN](https://learn.microsoft.com/en-us/sql/relational-databases/performance/joins#outer)
- [NULL Semantics](https://learn.microsoft.com/en-us/sql/t-sql/language-elements/null-values)
- [Execution Plans –¥–ª—è LEFT JOIN](https://learn.microsoft.com/en-us/sql/relational-databases/performance/execution-plans)
