---
title: Transact-SQL —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è
description: –ó–º—ñ–Ω–Ω—ñ, –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏, —Ü–∏–∫–ª–∏ —Ç–∞ —ñ–Ω—à—ñ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó T-SQL –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –≤ –ë–î
---

# Transact-SQL —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è

## –©–æ —Ç–∞–∫–µ Transact-SQL?

**Transact-SQL (T-SQL)** ‚Äî —Ü–µ —Ä–æ–∑—à–∏—Ä–µ–Ω–∏–π –¥—ñ–∞–ª–µ–∫—Ç SQL, —Ä–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π Microsoft –¥–ª—è SQL Server —Ç–∞ Sybase –¥–ª—è Sybase ASE.

::tabs

::tabs-item{label="ANSI SQL (—Å—Ç–∞–Ω–¥–∞—Ä—Ç)"}
–ë–∞–∑–æ–≤–∏–π SQL –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–∞–Ω–∏–º–∏:

```sql
-- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π SELECT
SELECT * FROM Customers WHERE City = 'Kyiv';

-- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π INSERT
INSERT INTO Orders (CustomerId, Total) VALUES (1, 500);
```

**–û–±–º–µ–∂–µ–Ω–Ω—è**: –¢—ñ–ª—å–∫–∏ –∑–∞–ø–∏—Ç–∏, –Ω–µ –º–æ–∂–Ω–∞ –ø–∏—Å–∞—Ç–∏ —Å–∫–ª–∞–¥–Ω—É –ª–æ–≥—ñ–∫—É.
::

::tabs-item{label="T-SQL (Microsoft)"}
SQL + **–ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è**:

```sql
-- –ó–º—ñ–Ω–Ω—ñ
DECLARE @city NVARCHAR(50) = 'Kyiv';

-- –£–º–æ–≤–∏
IF EXISTS (SELECT 1 FROM Customers WHERE City = @city)
BEGIN
    PRINT '–Ñ –∫–ª—ñ—î–Ω—Ç–∏ –∑ –ö–∏—î–≤–∞';
END

-- –¶–∏–∫–ª–∏
WHILE @counter < 10
BEGIN
    -- –õ–æ–≥—ñ–∫–∞
    SET @counter = @counter + 1;
END
```

**–ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ**: –ü–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–µ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö!
::

::

T-SQL –¥–æ–¥–∞—î –¥–æ SQL:
- **–ó–º—ñ–Ω–Ω—ñ** (–ª–æ–∫–∞–ª—å–Ω—ñ —Ç–∞ –≥–ª–æ–±–∞–ª—å–Ω—ñ)
- **–£–º–æ–≤–Ω—ñ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏** (IF...ELSE, CASE)
- **–¶–∏–∫–ª–∏** (WHILE, BREAK, CONTINUE)
- **–û–±—Ä–æ–±–∫–∞ –ø–æ–º–∏–ª–æ–∫** (TRY...CATCH)
- **–§—É–Ω–∫—Ü—ñ—ó** —Ç–∞ **–ø—Ä–æ—Ü–µ–¥—É—Ä–∏**
- **–ö—É—Ä—Å–æ—Ä–∏** —Ç–∞ **–¥–∏–Ω–∞–º—ñ—á–Ω–∏–π SQL**

---

## –ó–º—ñ–Ω–Ω—ñ

### –õ–æ–∫–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ

–õ–æ–∫–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ `@` —ñ —ñ—Å–Ω—É—é—Ç—å —Ç—ñ–ª—å–∫–∏ –≤ –º–µ–∂–∞—Ö –ø–∞–∫–µ—Ç–∞ (batch).

```sql
-- –û–≥–æ–ª–æ—à–µ–Ω–Ω—è
DECLARE @firstName NVARCHAR(50);
DECLARE @age INT = 25;  -- –ó —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—î—é
DECLARE @price DECIMAL(10,2) = 299.99, @quantity INT = 5;  -- –ö—ñ–ª—å–∫–∞ –≤—ñ–¥—Ä–∞–∑—É

-- –ü—Ä–∏—Å–≤–æ—î–Ω–Ω—è —á–µ—Ä–µ–∑ SET
SET @firstName = '–Ü–≤–∞–Ω';

-- –ü—Ä–∏—Å–≤–æ—î–Ω–Ω—è —á–µ—Ä–µ–∑ SELECT
SELECT @firstName = FirstName FROM Students WHERE Id = 1;

-- –í–∏–≤–µ–¥–µ–Ω–Ω—è
PRINT @firstName;
SELECT @firstName AS Name, @age AS Age;
```

### –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ

–ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ –ø–æ—á–∏–Ω–∞—é—Ç—å—Å—è –∑ `@@` —ñ –Ω–∞–¥–∞—î—Ç—å—Å—è SQL Server (—Ç—ñ–ª—å–∫–∏ –¥–ª—è —á–∏—Ç–∞–Ω–Ω—è).

| –ó–º—ñ–Ω–Ω–∞          | –û–ø–∏—Å                                    |
| :-------------- | :-------------------------------------- |
| `@@ROWCOUNT`    | –ö—ñ–ª—å–∫—ñ—Å—Ç—å —Ä—è–¥–∫—ñ–≤, –æ–±—Ä–æ–±–ª–µ–Ω–∏—Ö –æ—Å—Ç–∞–Ω–Ω—ñ–º –∑–∞–ø–∏—Ç–æ–º |
| `@@ERROR`       | –ù–æ–º–µ—Ä –æ—Å—Ç–∞–Ω–Ω—å–æ—ó –ø–æ–º–∏–ª–∫–∏ (0 = –Ω–µ–º–∞—î)     |
| `@@IDENTITY`    | –û—Å—Ç–∞–Ω–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è IDENTITY               |
| `@@TRANCOUNT`   | –ö—ñ–ª—å–∫—ñ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π          |
| `@@VERSION`     | –í–µ—Ä—Å—ñ—è SQL Server                       |
| `@@SERVERNAME`  | –Ü–º'—è —Å–µ—Ä–≤–µ—Ä–∞                            |

```sql
INSERT INTO Books (Title, Price) VALUES ('Test', 100);

SELECT 
    @@ROWCOUNT AS RowsAffected,
    @@IDENTITY AS LastInsertedId,
    @@TRANCOUNT AS ActiveTransactions;
```

### –¢–∞–±–ª–∏—á–Ω—ñ –∑–º—ñ–Ω–Ω—ñ

–ó–º—ñ–Ω–Ω—ñ —Ç–∏–ø—É TABLE –¥–ª—è –∑–±–µ—Ä –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —Ç–∞–±–ª–∏—Ü—å –≤ –ø–∞–º'—è—Ç—ñ.

```sql
-- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ç–∞–±–ª–∏—á–Ω–æ—ó –∑–º—ñ–Ω–Ω–æ—ó
DECLARE @tempBooks TABLE (
    Id INT NOT NULL,
    Title NVARCHAR(200),
    Price DECIMAL(10,2)
);

-- –ó–∞–ø–æ–≤–Ω–µ–Ω–Ω—è
INSERT INTO @tempBooks
SELECT TOP 5 Id, NameBook, Price
FROM book.Books;

-- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
SELECT * FROM @tempBooks WHERE Price > 100;
```

::note
**–¢–∞–±–ª–∏—á–Ω—ñ –∑–º—ñ–Ω–Ω—ñ vs –¢–∏–º—á–∞—Å–æ–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ (#temp)**:

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞       | –¢–∞–±–ª–∏—á–Ω—ñ –∑–º—ñ–Ω–Ω—ñ     | –¢–∏–º—á–∞—Å–æ–≤—ñ —Ç–∞–±–ª–∏—Ü—ñ   |
| :------------------- | :------------------ | :------------------ |
| –û–±–ª–∞—Å—Ç—å –¥—ñ—ó          | Batch / –ø—Ä–æ—Ü–µ–¥—É—Ä–∞   | –°–µ—Å—ñ—è (##=–≥–ª–æ–±–∞–ª—å–Ω–∞)|
| –Ü–Ω–¥–µ–∫—Å–∏              | –¢—ñ–ª—å–∫–∏ PRIMARY KEY  | –ë—É–¥—å-—è–∫—ñ            |
| –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞           | –ù–µ–º–∞—î               | –Ñ                   |
| –¢—Ä–∞–Ω–∑–∞–∫—Ü—ñ—ó           | –ù–µ –≤—ñ–¥–º—ñ–Ω—è—é—Ç—å—Å—è –ø—Ä–∏ ROLLBACK | –í—ñ–¥–º—ñ–Ω—è—é—Ç—å—Å—è |

**–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è**: –¢–∞–±–ª–∏—á–Ω—ñ –∑–º—ñ–Ω–Ω—ñ ‚Äî –¥–ª—è –Ω–µ–≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö (<1000 —Ä—è–¥–∫—ñ–≤).
::

---

## –û–ø–µ—Ä–∞—Ç–æ—Ä–∏ –≤–∏–≤–µ–¥–µ–Ω–Ω—è

### PRINT

–í–∏–≤–æ–¥–∏—Ç—å —Ä—è–¥–æ–∫ ASCII –≤ Messages (–Ω–µ Result Set).

```sql
PRINT 'Hello World';

DECLARE @name NVARCHAR(50) = '–Ü–≤–∞–Ω';
PRINT '–ü—Ä–∏–≤—ñ—Ç, ' + @name + '!';

-- –ó –¥–∞—Ç–æ—é
DECLARE @msg NVARCHAR(100) = N'–°—å–æ–≥–æ–¥–Ω—ñ ' + CAST(GETDATE() AS NVARCHAR(30));
PRINT @msg;
```

::warning
**–û–±–º–µ–∂–µ–Ω–Ω—è PRINT**:
- –ù–ï –º–æ–∂–Ω–∞ –∫–æ–Ω–∫–∞—Ç–∏–Ω—É–≤–∞—Ç–∏ –∑ –≤–∏—Ä–∞–∑–∞–º–∏ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ (–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –∑–º—ñ–Ω–Ω—É)
- –ú–∞–∫—Å–∏–º—É–º 8000 —Å–∏–º–≤–æ–ª—ñ–≤
- –ù–µ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–æ–≤–∞–Ω–æ–≥–æ –≤–∏–≤–æ–¥—É (–∫—Ä–∞—â–µ SELECT)
::

### RAISERROR

–í–∏–≤–æ–¥–∏—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–º–∏–ª–∫—É (–º–æ–∂–Ω–∞ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞—Ç–∏ —è–∫ `printf` –≤ C).

```sql
DECLARE @count INT = 5;

RAISERROR('–û–±—Ä–æ–±–ª–µ–Ω–æ %d —Ä—è–¥–∫—ñ–≤', 0, 1, @count);
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: "–û–±—Ä–æ–±–ª–µ–Ω–æ 5 —Ä—è–¥–∫—ñ–≤"

-- –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
RAISERROR('User: %s, ID: %d, Price: %.2f', 10, 1, '–Ü–≤–∞–Ω', 123, 299.99);
```

**–°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∏ —Ñ–æ—Ä–º–∞—Ç—É**:
-`%d`, `%i` ‚Äî —Ü—ñ–ª—ñ —á–∏—Å–ª–∞
- `%s` ‚Äî —Ä—è–¥–∫–∏
- `%f` ‚Äî –¥—ñ–π—Å–Ω—ñ —á–∏—Å–ª–∞ (–Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î—Ç—å—Å—è –Ω–∞–ø—Ä—è–º—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ CAST)

**–†—ñ–≤–Ω—ñ –≤–∞–∂–ª–∏–≤–æ—Å—Ç—ñ**:
- `0-10` ‚Äî —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
- `11-16` ‚Äî –ø–æ–º–∏–ª–∫–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- `17-25` ‚Äî –∫—Ä–∏—Ç–∏—á–Ω—ñ –ø–æ–º–∏–ª–∫–∏ (—Ç—ñ–ª—å–∫–∏ sysadmin)

---

## –£–º–æ–≤–Ω—ñ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏

### IF...ELSE

```sql
DECLARE @age INT = 20;

IF @age >= 18
BEGIN
    PRINT '–î–æ—Ä–æ—Å–ª–∏–π';
END
ELSE
BEGIN
    PRINT '–ù–µ–ø–æ–≤–Ω–æ–ª—ñ—Ç–Ω—ñ–π';
END
```

**–ó SELECT** (–æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –¥—É–∂–∫–∏!):

```sql
IF (SELECT COUNT(*) FROM Students) > 100
BEGIN
    PRINT '–ë—ñ–ª—å—à–µ 100 —Å—Ç—É–¥–µ–Ω—Ç—ñ–≤';
END

-- –ó EXISTS (–Ω–∞–π—à–≤–∏–¥—à–∏–π —Å–ø–æ—Å—ñ–± –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏)
IF EXISTS (SELECT 1 FROM Students WHERE Age > 20)
BEGIN
    PRINT '—î —Å—Ç—É–¥–µ–Ω—Ç–∏ —Å—Ç–∞—Ä—à–µ 20';
END
```

### CASE

**–ü—Ä–æ—Å—Ç–∞ —Ñ–æ—Ä–º–∞** (–ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–æ—é):

```sql
SELECT 
    NameBook,
    CASE ThemeId
        WHEN 1 THEN '–ü—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è'
        WHEN 2 THEN '–ë–∞–∑–∏ –¥–∞–Ω–∏—Ö'
        WHEN 3 THEN '–í–µ–±-—Ä–æ–∑—Ä–æ–±–∫–∞'
        ELSE '–Ü–Ω—à–µ'
    END AS ThemeName
FROM book.Books;
```

**–ó –ø–æ—à—É–∫–æ–º** (—É–º–æ–≤–Ω—ñ –≤–∏—Ä–∞–∑–∏):

```sql
SELECT 
    NameBook,
    Price,
    CASE
        WHEN Price < 100 THEN '–î–µ—à–µ–≤–∞'
        WHEN Price BETWEEN 100 AND 500 THEN '–°–µ—Ä–µ–¥–Ω—è'
        ELSE '–î–æ—Ä–æ–≥–∞'
    END AS PriceCategory
FROM book.Books;
```

::tip
**CASE ‚Äî —Ü–µ –§–£–ù–ö–¶–Ü–Ø**, –Ω–µ –∫–æ–º–∞–Ω–¥–∞! –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –≤ SELECT, UPDATE, WHERE.

**vs IF**: IF ‚Äî –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –ø–æ—Ç–æ–∫—É, CASE ‚Äî –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è.
::

---

## –¶–∏–∫–ª–∏

### WHILE

–Ñ–¥–∏–Ω–∏–π —Ç–∏–ø —Ü–∏–∫–ª—É –≤ T-SQL.

```sql
DECLARE @counter INT = 1;

WHILE @counter <= 10
BEGIN
    PRINT '–Ü—Ç–µ—Ä–∞—Ü—ñ—è: ' + CAST(@counter AS NVARCHAR);
    SET @counter = @counter + 1;
END
```

### BREAK —Ç–∞ CONTINUE

```sql
DECLARE @i INT = 1;

WHILE @i < 20
BEGIN
    SET @i = @i + 1;
    
    IF @i = 5
        CONTINUE;  -- –ü—Ä–æ–ø—É—Å—Ç–∏—Ç–∏ —ñ—Ç–µ—Ä–∞—Ü—ñ—é
    
    IF @i > 10
        BREAK;  -- –í–∏–π—Ç–∏ –∑ —Ü–∏–∫–ª—É
    
    PRINT @i;
END
-- –í–∏–≤–µ–¥–µ: 2, 3, 4, 6, 7, 8, 9, 10
```

**–ü—Ä–∏–∫–ª–∞–¥: –ó–±—ñ–ª—å—à–µ–Ω–Ω—è —Ü—ñ–Ω –¥–æ —Å–µ—Ä–µ–¥–Ω—å–æ—ó —Ü—ñ–Ω–∏ 200**:

```sql
WHILE (SELECT AVG(Price) FROM book.Books) < 200
BEGIN
    UPDATE book.Books
    SET Price = Price * 1.1;  -- –ó–±—ñ–ª—å—à–∏—Ç–∏ –Ω–∞ 10%
END

SELECT AVG(Price) AS AveragePrice FROM book.Books;
```

---

## GOTO (–ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ!)

–ë–µ–∑—É–º–æ–≤–Ω–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ –¥–æ –º—ñ—Ç–∫–∏.

```sql
DECLARE @error INT = 0;

-- –°–ø—Ä–æ–±–∞ –æ–ø–µ—Ä–∞—Ü—ñ—ó
INSERT INTO Books (Title) VALUES ('Test');
SET @error = @@ERROR;

IF @error <> 0
    GOTO ErrorHandler;

PRINT '–£—Å–ø—ñ—Ö';
GOTO EndScript;

ErrorHandler:
    PRINT '–ü–æ–º–∏–ª–∫–∞!';

EndScript:
    PRINT '–ö—ñ–Ω–µ—Ü—å';
```

::caution
**–£–Ω–∏–∫–∞–π—Ç–µ GOTO!**

–†–æ–±–∏—Ç—å –∫–æ–¥ –Ω–µ—á–∏—Ç–∞–±–µ–ª—å–Ω–∏–º —ñ –≤–∞–∂–∫–æ –Ω–∞–ª–∞–≥–æ–¥–∂—É–≤–∞–Ω–∏–º. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ:
- TRY...CATCH –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–º–∏–ª–æ–∫
- IF...ELSE –¥–ª—è –ª–æ–≥—ñ–∫–∏
::

---

## Common Table Expressions (CTE)

**–í—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è** –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –≤ –º–µ–∂–∞—Ö –æ–¥–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É.

### –ë–∞–∑–æ–≤–∏–π CTE

```sql
WITH AvgPriceByAuthor AS
(
    SELECT 
        a.Id AS AuthorId,
        a.LastName + ' ' + a.FirstName AS AuthorName,
        AVG(b.Price) AS AvgPrice
    FROM book.Authors a
    INNER JOIN book.Books b ON a.Id = b.AuthorId
    GROUP BY a.Id, a.LastName, a.FirstName
)
SELECT 
    b.NameBook,
    b.Price,
    ap.AuthorName,
    ap.AvgPrice
FROM book.Books b
INNER JOIN AvgPriceByAuthor ap ON b.AuthorId = ap.AuthorId
WHERE b.Price > ap.AvgPrice;
```

**–ü–µ—Ä–µ–≤–∞–≥–∏ CTE**:
- –ß–∏—Ç–∞–±–µ–ª—å–Ω—ñ—à–∏–π –∫–æ–¥ (–∑–∞–º—ñ—Å—Ç—å –ø—ñ–¥–∑–∞–ø–∏—Ç—ñ–≤)
- –ú–æ–∂–Ω–∞ –ø–æ—Å–∏–ª–∞—Ç–∏—Å—è –∫—ñ–ª—å–∫–∞ —Ä–∞–∑—ñ–≤
- –ü—ñ–¥—Ç—Ä–∏–º—É—î —Ä–µ–∫—É—Ä—Å—ñ—é

### –†–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π CTE

–î–ª—è —ñ—î—Ä–∞—Ä—Ö—ñ—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö (–¥–µ—Ä–µ–≤–∞, –≥—Ä–∞—Ñ–∏).

```sql
-- –ü—Ä–∏–∫–ª–∞–¥: –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å —á–∏—Å–µ–ª 1-10
WITH Numbers AS
(
    -- –ü–æ—á–∞—Ç–∫–æ–≤–∞ –≤–∏–±—ñ—Ä–∫–∞ (—è–∫—ñ—Ä)
    SELECT 1 AS Num
    
    UNION ALL
    
    -- –†–µ–∫—É—Ä—Å–∏–≤–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞
    SELECT Num + 1
    FROM Numbers
    WHERE Num < 10
)
SELECT * FROM Numbers;
-- –†–µ–∑—É–ª—å—Ç–∞—Ç: 1, 2, 3, ..., 10
```

::warning
**–û–±–º–µ–∂–µ–Ω–Ω—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏—Ö CTE**:
- –ù–ï –º–æ–∂–Ω–∞: SELECT DISTINCT, GROUP BY, HAVING, TOP, OUTER JOIN
- –ú–∞–∫—Å–∏–º—É–º 100 —Ä—ñ–≤–Ω—ñ–≤ —Ä–µ–∫—É—Ä–∞—Ü—ñ—ó (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
::

---

## –ö–æ—Ä–∏—Å–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó

### COALESCE

–ü–æ–≤–µ—Ä—Ç–∞—î –ø–µ—Ä—à–µ NOT NULL –∑–Ω–∞—á–µ–Ω–Ω—è.

```sql
SELECT 
    COALESCE(RetailPrice, TradePrice, 0) AS FinalPrice
FROM book.Books;

-- –ï–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–æ:
CASE
    WHEN RetailPrice IS NOT NULL THEN RetailPrice
    WHEN TradePrice IS NOT NULL THEN TradePrice
    ELSE 0
END
```

### NULLIF

–ü–æ–≤–µ—Ä—Ç–∞—î NULL, —è–∫—â–æ –¥–≤–∞ –≤–∏—Ä–∞–∑–∏ —Ä—ñ–≤–Ω—ñ.

```sql
SELECT 
    NameBook,
    NULLIF(DrawingOfBook, 0) AS Drawing  -- –Ø–∫—â–æ 0 ‚Üí NULL
FROM book.Books;

-- –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑ COALESCE
SELECT COALESCE(NULLIF(DrawingOfBook, 0), 1000) AS DefaultDrawing
FROM book.Books;
```

### IIF (SQL Server 2012+)

–°–∫–æ—Ä–æ—á–µ–Ω–∞ —Ñ–æ—Ä–º–∞ IF...ELSE (–ø–æ–≤–µ—Ä—Ç–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è).

```sql
SELECT 
    NameBook,
    Price,
    IIF(Price > 100, '–î–æ—Ä–æ–≥–∞', '–î–µ—à–µ–≤–∞') AS PriceCategory
FROM book.Books;

-- –ï–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç–Ω–æ:
CASE WHEN Price > 100 THEN '–î–æ—Ä–æ–≥–∞' ELSE '–î–µ—à–µ–≤–∞' END
```

---

## –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è

::accordion

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 1: –¶–∏–∫–ª –∑ —É–º–æ–≤–æ—é" icon="i-lucide-repeat"}

**–£–º–æ–≤–∞**: –í–∏–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–Ω—ñ —á–∏—Å–ª–∞ –≤—ñ–¥ 1 –¥–æ 20.

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
DECLARE @num INT = 1;

WHILE @num <= 20
BEGIN
    IF @num % 2 = 0  -- –ü–∞—Ä–Ω–µ —á–∏—Å–ª–æ
        PRINT @num;
    
    SET @num = @num + 1;
END
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 2: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è CTE" icon="i-lucide-layers"}

**–£–º–æ–≤–∞**: –ó–Ω–∞–π–¥—ñ—Ç—å –∫–Ω–∏–≥–∏, —Ü—ñ–Ω–∞ —è–∫–∏—Ö –≤–∏—â–µ —Å–µ—Ä–µ–¥–Ω—å–æ—ó –∑–∞ —Å–≤–æ—î—é —Ç–µ–º–∞—Ç–∏–∫–æ—é.

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
WITH ThemeAvgPrice AS
(
    SELECT 
        ThemeId,
        AVG(Price) AS AvgPrice
    FROM book.Books
    GROUP BY ThemeId
)
SELECT 
    b.NameBook,
    b.Price,
    t.NameTheme,
    tap.AvgPrice AS ThemeAvgPrice
FROM book.Books b
INNER JOIN book.Themes t ON b.ThemeId = t.Id
INNER JOIN ThemeAvgPrice tap ON b.ThemeId = tap.ThemeId
WHERE b.Price > tap.AvgPrice
ORDER BY b.Price DESC;
```

</details>

::

::accordion-item{label="–ó–∞–≤–¥–∞–Ω–Ω—è 3: –û–±—Ä–æ–±–∫–∞ NULL" icon="i-lucide-alert-circle"}

**–£–º–æ–≤–∞**: –í–∏–±–µ—Ä—ñ—Ç—å –Ω–∞–∑–≤—É –∫–Ω–∏–≥–∏ —Ç–∞ —ó—ó —Ç–∏—Ä–∞–∂. –Ø–∫—â–æ —Ç–∏—Ä–∞–∂ 0 –∞–±–æ NULL ‚Üí –ø–æ–∫–∞–∑–∞—Ç–∏ '–ù–µ–≤—ñ–¥–æ–º–æ'.

<details>
<summary>üí° –†–æ–∑–≤'—è–∑–æ–∫</summary>

```sql
SELECT 
    NameBook AS Title,
    COALESCE(
        NULLIF(CAST(DrawingOfBook AS NVARCHAR), '0'),
        '–ù–µ–≤—ñ–¥–æ–º–æ'
    ) AS Drawing
FROM book.Books;
```

</details>

::

::

---

## –†–µ–∑—é–º–µ

::tip
**–ö–ª—é—á–æ–≤—ñ –º–æ–º–µ–Ω—Ç–∏ T-SQL —Ä–æ–∑—à–∏—Ä–µ–Ω—å**:

1. **–ó–º—ñ–Ω–Ω—ñ**: `@local` (–ª–æ–∫–∞–ª—å–Ω—ñ), `@@global` (–≥–ª–æ–±–∞–ª—å–Ω—ñ), —Ç–∞–±–ª–∏—á–Ω—ñ
2. **IF...ELSE**: –£–º–æ–≤–Ω—ñ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∏ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –ø–æ—Ç–æ–∫—É
3. **CASE**: –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –∑–Ω–∞—á–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —É–º–æ–≤
4. **WHILE**: –Ñ–¥–∏–Ω–∏–π —Ç–∏–ø —Ü–∏–∫–ª—É (–∑ BREAK/CONTINUE)
5. **PRINT/RAISERROR**: –í–∏–≤–µ–¥–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
6. **CTE**: –í—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –¥–ª—è —á–∏—Ç–∞–±–µ–ª—å–Ω–æ—Å—Ç—ñ
7. **COALESCE/NULLIF/IIF**: –†–æ–±–æ—Ç–∞ –∑ NULL —Ç–∞ —É–º–æ–≤–∞–º–∏

**Best Practices**:
- –£–Ω–∏–∫–∞–π—Ç–µ GOTO
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ CTE –∑–∞–º—ñ—Å—Ç—å –≤–∫–ª–∞–¥–µ–Ω–∏—Ö –ø—ñ–¥–∑–∞–ø–∏—Ç—ñ–≤
- –¢–∞–±–ª–∏—á–Ω—ñ –∑–º—ñ–Ω–Ω—ñ ‚Äî –¥–ª—è –Ω–µ–≤–µ–ª–∏–∫–∏—Ö –¥–∞–Ω–∏—Ö
- EXISTS —à–≤–∏–¥—à–µ –Ω—ñ–∂ COUNT(*) > 0
- APPLY –∑–∞–º—ñ—Å—Ç—å –∫—É—Ä—Å–æ—Ä—ñ–≤ –¥–µ –º–æ–∂–ª–∏–≤–æ

**–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫**: –ó–∞—Å—Ç–æ—Å—É–π—Ç–µ —Ü—ñ –∑–Ω–∞–Ω–Ω—è –≤ [DML-—Ç—Ä–∏–≥–µ—Ä–∞—Ö](01.dml-triggers.md) —Ç–∞ [–∑–±–µ—Ä—ñ–≥–∞—î–º–∏—Ö –ø—Ä–æ—Ü–µ–¥—É—Ä–∞—Ö](05.stored-procedures.md) –¥–ª—è —Å–∫–ª–∞–¥–Ω–æ—ó –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏!
::
