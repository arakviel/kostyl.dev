# 05. DASH Protocol: –í—ñ–¥–∫—Ä–∏—Ç–∏–π –°—Ç–∞–Ω–¥–∞—Ä—Ç

## 1. –í—Å—Ç—É–ø: –ß–æ–º—É –≤–∏–Ω–∏–∫ DASH?

### –ü—Ä–æ–±–ª–µ–º–∞, —è–∫—É –≤–∏—Ä—ñ—à—É—î DASH

–£—è–≤—ñ—Ç—å: —Ü–µ 2010 —Ä—ñ–∫. –£ —Å–≤—ñ—Ç—ñ —Å—Ç—Ä—ñ–º—ñ–Ω–≥—É —Ö–∞–æ—Å:

- **Apple** –ø—Ä–æ—Å—É–≤–∞—î HLS (—Ç—ñ–ª—å–∫–∏ –¥–ª—è iOS/Safari)
- **Microsoft** –º–∞—î Smooth Streaming (—Ç—ñ–ª—å–∫–∏ –¥–ª—è Silverlight)
- **Adobe** –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î HDS (HTTP Dynamic Streaming –¥–ª—è Flash)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–æ–∑—Ä–æ–±–Ω–∏–∫–∏ –∑–º—É—à–µ–Ω—ñ –∫–æ–¥—É–≤–∞—Ç–∏ –≤—ñ–¥–µ–æ **—Ç—Ä–∏ —Ä–∞–∑–∏** –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º.

**–†—ñ—à–µ–Ω–Ω—è:** MPEG Industry Forum —Å—Ç–≤–æ—Ä–∏–≤ **DASH (Dynamic Adaptive Streaming over HTTP)** ‚Äî –≤—ñ–¥–∫—Ä–∏—Ç–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç ISO/IEC 23009-1.

::tip{icon="i-lucide-lightbulb"}
**DASH = "Linux" —Å–≤—ñ—Ç—É —Å—Ç—Ä—ñ–º—ñ–Ω–≥—É**

- –í—ñ–¥–∫—Ä–∏—Ç–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç (–Ω–µ –Ω–∞–ª–µ–∂–∏—Ç—å –æ–¥–Ω—ñ–π –∫–æ–º–ø–∞–Ω—ñ—ó)
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ –±—É–¥—å-—è–∫–∏—Ö –∫–æ–¥–µ–∫—ñ–≤ (VP9, AV1, Opus)
- –£–Ω—ñ–≤–µ—Ä—Å–∞–ª—å–Ω–∏–π DRM (Widevine, PlayReady)
- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è YouTube, Netflix, Amazon Prime

::

### –ê–Ω–∞–ª–æ–≥—ñ—è: Lego –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è

–Ø–∫—â–æ HLS ‚Äî —Ü–µ "–∑–º—ñ—Å—Ç –∫–Ω–∏–≥–∏" (–ª—ñ–Ω—ñ–π–Ω–∏–π —Å–ø–∏—Å–æ–∫ —Å–µ–≥–º–µ–Ω—Ç—ñ–≤), —Ç–æ DASH ‚Äî —Ü–µ **XML-–º–∞–Ω—ñ—Ñ–µ—Å—Ç**, —Å—Ö–æ–∂–∏–π –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é Lego:

- "–û—Å—å —Ü–µ–π –∫—É–±–∏–∫ (Representation) ‚Äî –¥–ª—è –∑–≤—É–∫—É 5.1"
- "–û—Å—å —Ü–µ–π –∫—É–±–∏–∫ ‚Äî –¥–ª—è –≤—ñ–¥–µ–æ 4K"
- "–û—Å—å —Ü–µ–π –∫—É–±–∏–∫ ‚Äî –¥–ª—è —Å—É–±—Ç–∏—Ç—Ä—ñ–≤ –Ω—ñ–º–µ—Ü—å–∫–æ—é"
- "–¢–∏ –º–æ–∂–µ—à –∑—ñ–±—Ä–∞—Ç–∏ –∑ –Ω–∏—Ö —â–æ –∑–∞–≤–≥–æ–¥–Ω–æ"

**–ü–µ—Ä–µ–≤–∞–≥–∏ —Ç–∞–∫–æ–≥–æ –ø—ñ–¥—Ö–æ–¥—É:**

- –ú–æ–¥—É–ª—å–Ω—ñ—Å—Ç—å (–æ–∫—Ä–µ–º–æ –∞—É–¥—ñ–æ, –≤—ñ–¥–µ–æ, —Å—É–±—Ç–∏—Ç—Ä–∏)
- –ì–Ω—É—á–∫—ñ—Å—Ç—å (–º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ —Ç—Ä–µ–∫–∏ –±–µ–∑ –ø–µ—Ä–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –≤—Å—å–æ–≥–æ)
- –ú—ñ–∂–Ω–∞—Ä–æ–¥–Ω—ñ—Å—Ç—å (–±–∞–≥–∞—Ç–æ–º–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç)

---

## 2. –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ DASH: MPD (Media Presentation Description)

### 2.1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ MPD

–ú–∞–Ω—ñ—Ñ–µ—Å—Ç —É DASH –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è **.mpd** (Media Presentation Description). –¶–µ XML —Ñ–∞–π–ª.

**–ß–æ–º—É XML, –∞ –Ω–µ —Ç–µ–∫—Å—Ç —è–∫ —É HLS?**

::card-group

::card{title="‚úÖ –ü–µ—Ä–µ–≤–∞–≥–∏ XML" icon="i-lucide-check-circle"}

- –§–æ—Ä–º–∞–ª—å–Ω–∞ —Å—Ö–µ–º–∞ (–º–æ–∂–Ω–∞ –≤–∞–ª—ñ–¥—É–≤–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ)
- –Ü—î—Ä–∞—Ä—Ö—ñ—á–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Period ‚Üí AdaptationSet ‚Üí Representation)
- –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ñ XML-–ø–∞—Ä—Å–µ—Ä–∏ –≤ —É—Å—ñ—Ö –º–æ–≤–∞—Ö –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—è
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ namespace (–º–æ–∂–Ω–∞ –¥–æ–¥–∞–≤–∞—Ç–∏ –∫–∞—Å—Ç–æ–º–Ω—ñ –∞—Ç—Ä–∏–±—É—Ç–∏)

::

::card{title="‚ùå –ù–µ–¥–æ–ª—ñ–∫–∏ XML" icon="i-lucide-alert-circle"}

- –ë—ñ–ª—å—à–∏–π —Ä–æ–∑–º—ñ—Ä —Ñ–∞–π–ª—É (–ø–æ—Ä—ñ–≤–Ω—è–Ω–æ –∑ M3U8)
- –°–∫–ª–∞–¥–Ω—ñ—à–µ —á–∏—Ç–∞—Ç–∏ –æ—á–∏–º–∞
- –ë—ñ–ª—å—à–µ overhead –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥—É

::

::

### 2.2. –Ü—î—Ä–∞—Ä—Ö—ñ—è DASH XML

::mermaid

```mermaid
graph TD
    MPD[MPD - Root]
    P1[Period #1: Intro]
    P2[Period #2: Main Movie]
    P3[Period #3: Credits]

    AS_V[AdaptationSet: Video]
    AS_A_EN[AdaptationSet: Audio EN]
    AS_A_ES[AdaptationSet: Audio ES]
    AS_SUB[AdaptationSet: Subtitles]

    R_1080[Representation: 1080p]
    R_720[Representation: 720p]
    R_480[Representation: 480p]

    R_A_EN[Representation: AAC 128k]
    R_A_ES[Representation: AAC 128k]

    SEG[Segments: .m4s files]

    MPD --> P1
    MPD --> P2
    MPD --> P3

    P2 --> AS_V
    P2 --> AS_A_EN
    P2 --> AS_A_ES
    P2 --> AS_SUB

    AS_V --> R_1080
    AS_V --> R_720
    AS_V --> R_480

    AS_A_EN --> R_A_EN
    AS_A_ES --> R_A_ES

    R_1080 --> SEG
    R_720 --> SEG
    R_480 --> SEG
```

::
**–†–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–∞:**

1. **MPD (Root)**: –ö–æ—Ä—ñ–Ω—å –¥–æ–∫—É–º–µ–Ω—Ç–∞
2. **Period**: –ß–∞—Å–æ–≤–∏–π –ø–µ—Ä—ñ–æ–¥ (—Ä–µ–∫–ª–∞–º–∞, –æ—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç, —Ç–∏—Ç—Ä–∏)
3. **AdaptationSet**: –ì—Ä—É–ø–∞ –ø–æ—Ç–æ–∫—ñ–≤ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø—É (–≤—Å—ñ –≤—ñ–¥–µ–æ, –≤—Å—ñ –∞—É–¥—ñ–æ)
4. **Representation**: –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç —è–∫–æ—Å—Ç—ñ (1080p, 720p, AAC 128k)
5. **Segment**: –§—ñ–∑–∏—á–Ω–∏–π —Ñ–∞–π–ª (.m4s)

### 2.3. –ü—Ä–∏–∫–ª–∞–¥ MPD

```xml
<?xml version="1.0" encoding="UTF-8"?>
<MPD xmlns="urn:mpeg:dash:schema:mpd:2011"
     type="static"
     mediaPresentationDuration="PT10M30S"
     minBufferTime="PT2S">

  <Period id="main" duration="PT10M30S">

    <!-- Video Adaptation Set -->
    <AdaptationSet
        id="video"
        mimeType="video/mp4"
        codecs="avc1.4d401f"
        width="1920"
        height="1080"
        frameRate="30">

      <!-- 1080p Representation -->
      <Representation
          id="video_1080p"
          bandwidth="5000000"
          width="1920"
          height="1080">
        <BaseURL>video/1080p/</BaseURL>
        <SegmentTemplate
            media="segment_$Number$.m4s"
            initialization="init.mp4"
            timescale="90000"
            duration="540000"
            startNumber="1"/>
      </Representation>

      <!-- 720p Representation -->
      <Representation
          id="video_720p"
          bandwidth="2500000"
          width="1280"
          height="720">
        <BaseURL>video/720p/</BaseURL>
        <SegmentTemplate
            media="segment_$Number$.m4s"
            initialization="init.mp4"
            timescale="90000"
            duration="540000"
            startNumber="1"/>
      </Representation>

      <!-- 480p Representation -->
      <Representation
          id="video_480p"
          bandwidth="1000000"
          width="854"
          height="480">
        <BaseURL>video/480p/</BaseURL>
        <SegmentTemplate
            media="segment_$Number$.m4s"
            initialization="init.mp4"
            timescale="90000"
            duration="540000"
            startNumber="1"/>
      </Representation>
    </AdaptationSet>

    <!-- Audio Adaptation Set (English) -->
    <AdaptationSet
        id="audio_en"
        mimeType="audio/mp4"
        codecs="mp4a.40.2"
        lang="en"
        audioSamplingRate="48000">

      <Representation
          id="audio_en_128k"
          bandwidth="128000">
        <BaseURL>audio/en/</BaseURL>
        <SegmentTemplate
            media="segment_$Number$.m4s"
            initialization="init.mp4"
            timescale="48000"
            duration="288000"
            startNumber="1"/>
      </Representation>
    </AdaptationSet>

    <!-- Audio Adaptation Set (Spanish) -->
    <AdaptationSet
        id="audio_es"
        mimeType="audio/mp4"
        codecs="mp4a.40.2"
        lang="es"
        audioSamplingRate="48000">

      <Representation
          id="audio_es_128k"
          bandwidth="128000">
        <BaseURL>audio/es/</BaseURL>
        <SegmentTemplate
            media="segment_$Number$.m4s"
            initialization="init.mp4"
            timescale="48000"
            duration="288000"
            startNumber="1"/>
      </Representation>
    </AdaptationSet>

  </Period>
</MPD>
```

**–ü–æ—è—Å–Ω–µ–Ω–Ω—è –∫–ª—é—á–æ–≤–∏—Ö –∞—Ç—Ä–∏–±—É—Ç—ñ–≤:**

::field-group

::field{name="type" type="static | dynamic"}

- `static`: VOD (–≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–Ω–∏–π –æ–¥—Ä–∞–∑—É)
- `dynamic`: Live (—Å–µ–≥–º–µ–Ω—Ç–∏ –¥–æ–¥–∞—é—Ç—å—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ)

::

::field{name="mediaPresentationDuration" type="ISO 8601"}
–ó–∞–≥–∞–ª—å–Ω–∞ —Ç—Ä–∏–≤–∞–ª—ñ—Å—Ç—å (PT10M30S = 10 —Ö–≤–∏–ª–∏–Ω 30 —Å–µ–∫—É–Ω–¥)
::

::field{name="minBufferTime" type="Duration"}
–ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –±—É—Ñ–µ—Ä, —è–∫–∏–π –ø–ª–µ—î—Ä –º–∞—î –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º
::

::field{name="timescale" type="Integer"}
–ö—ñ–ª—å–∫—ñ—Å—Ç—å "—Ç—ñ–∫—ñ–≤" –≤ —Å–µ–∫—É–Ω–¥—ñ. 90000 = —Å—Ç–∞–Ω–¥–∞—Ä—Ç –¥–ª—è –≤—ñ–¥–µ–æ (90kHz). –î–ª—è –∞—É–¥—ñ–æ –∑–∞–∑–≤–∏—á–∞–π = sampling rate (48000Hz).
::

::field{name="duration" type="Integer"}
–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç–∞ –≤ timescale units. 540000 / 90000 = 6 —Å–µ–∫—É–Ω–¥.
::

::

### 2.4. SegmentTemplate: –Ø–∫ –≥–µ–Ω–µ—Ä—É—é—Ç—å—Å—è URL

```xml
<SegmentTemplate
    media="segment_$Number$.m4s"
    initialization="init.mp4"
    timescale="90000"
    duration="540000"
    startNumber="1"/>
```

**–Ø–∫ –ø–ª–µ—î—Ä –±—É–¥—É—î URL:**

1. –ë–∞–∑–æ–≤–∏–π URL: `https://cdn.example.com/video/1080p/`
2. –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ–π–Ω–∏–π —Å–µ–≥–º–µ–Ω—Ç (–æ–¥–∏–Ω —Ä–∞–∑): `init.mp4`
3. –ú–µ–¥—ñ–∞-—Å–µ–≥–º–µ–Ω—Ç–∏:
    - `$Number$` –∑–∞–º—ñ–Ω—é—î—Ç—å—Å—è –Ω–∞ –Ω–æ–º–µ—Ä —Å–µ–≥–º–µ–Ω—Ç–∞
    - `segment_1.m4s`, `segment_2.m4s`, `segment_3.m4s`, ...

**–ü–æ–≤–Ω—ñ URL:**

```
https://cdn.example.com/video/1080p/init.mp4         ‚Üê –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è 1 —Ä–∞–∑
https://cdn.example.com/video/1080p/segment_1.m4s
https://cdn.example.com/video/1080p/segment_2.m4s
https://cdn.example.com/video/1080p/segment_3.m4s
...
```

---

## 3. DASH vs HLS: –î–µ—Ç–∞–ª—å–Ω–µ –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

### 3.1. –ü–æ—Ä—ñ–≤–Ω—è–ª—å–Ω–∞ —Ç–∞–±–ª–∏—Ü—è

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞                | HLS (Apple)                                       | DASH (MPEG)                                     |
| :---------------------------- | :------------------------------------------------ | :---------------------------------------------- |
| **–†–æ–∑—Ä–æ–±–Ω–∏–∫**                 | Apple Inc.                                        | MPEG Industry Forum                             |
| **–°—Ç–∞–Ω–¥–∞—Ä—Ç**                  | RFC 8216 (IETF)                                   | ISO/IEC 23009-1                                 |
| **–ú–∞–Ω—ñ—Ñ–µ—Å—Ç**                  | `.m3u8` (—Ç–µ–∫—Å—Ç–æ–≤–∏–π, M3U Extended)                 | `.mpd` (XML)                                    |
| **–ö–æ–¥–µ–∫–∏**                    | –û–±–º–µ–∂–µ–Ω—ñ (H.264/H.265/AAC –æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –¥–ª—è Safari) | Codec-agnostic (VP9, AV1, Opus, –±—É–¥—å-—â–æ)        |
| **–°–µ–≥–º–µ–Ω—Ç–∏**                  | `.ts` (MPEG-TS) –∞–±–æ `.m4s` (fMP4)                 | `.m4s` (fragmented MP4)                         |
| **DRM**                       | FairPlay (—Ç—ñ–ª—å–∫–∏ Apple –µ–∫–æ—Å–∏—Å—Ç–µ–º–∞)                | CENC (Common Encryption) ‚Üí Widevine, PlayReady  |
| **–ù–∞—Ç–∏–≤–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ iOS**     | ‚úÖ –¢–∞–∫ (Safari, AVPlayer)                         | ‚ùå –ü–æ—Ç—Ä—ñ–±–µ–Ω dash.js –∞–±–æ Shaka Player            |
| **–ù–∞—Ç–∏–≤–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ Android** | ‚ö†Ô∏è –ß–∞—Å—Ç–∫–æ–≤–æ (–ø–æ—Ç—Ä—ñ–±–µ–Ω ExoPlayer –∞–±–æ hls.js)       | ‚úÖ –¢–∞–∫ (—á–µ—Ä–µ–∑ MSE - Media Source Extensions)    |
| **–õ–∞—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å (—Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω–∞)**  | 20-40 —Å–µ–∫                                         | 10-30 —Å–µ–∫ (–∫—Ä–∞—â–µ —á–µ—Ä–µ–∑ –º–µ–Ω—à–∏–π segment overhead) |
| **–õ–∞—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å (Low Latency)** | 2-6 —Å–µ–∫ (LL-HLS, iOS 14+)                         | 3-5 —Å–µ–∫ (LL-DASH)                               |
| **CDN friendly**              | ‚úÖ –í—ñ–¥–º—ñ–Ω–Ω–æ                                       | ‚úÖ –í—ñ–¥–º—ñ–Ω–Ω–æ                                     |
| **Multi-audio**               | ‚ö†Ô∏è –°–∫–ª–∞–¥–Ω–æ (–ø–æ—Ç—Ä—ñ–±–µ–Ω –æ–∫—Ä–µ–º–∏–π –ø–ª–µ–π–ª—ñ—Å—Ç)            | ‚úÖ –ü—Ä–æ—Å—Ç–æ (AdaptationSet –∑ `lang` –∞—Ç—Ä–∏–±—É—Ç–æ–º)    |
| **Multi-subtitle**            | ‚ö†Ô∏è –û–∫—Ä–µ–º–∏–π WebVTT –ø–ª–µ–π–ª—ñ—Å—Ç                        | ‚úÖ –í–±—É–¥–æ–≤–∞–Ω–æ –≤ MPD                              |
| **–ï–∫–æ—Å–∏—Å—Ç–µ–º–∞**                | –ë—ñ–ª—å—à–∞ (–±—ñ–ª—å—à–µ CDN –ø—ñ–¥—Ç—Ä–∏–º–∫–∏)                     | –ú–µ–Ω—à–∞, –∞–ª–µ –∑—Ä–æ—Å—Ç–∞—î                              |

### 3.2. –ö–ª—é—á–æ–≤—ñ –í—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ

::accordion

::accordion-item{label="üé≠ Period: –ë–∞–≥–∞—Ç–æ–ø–µ—Ä—ñ–æ–¥–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç" icon="i-lucide-layers"}

**DASH –º–∞—î Period ‚Äî HLS –Ω—ñ**

–£ DASH –º–æ–∂–Ω–∞ –º–∞—Ç–∏ –∫—ñ–ª—å–∫–∞ **Period** (–ø–µ—Ä—ñ–æ–¥—ñ–≤) –≤ –æ–¥–Ω–æ–º—É MPD:

```xml
<MPD>
  <Period id="preroll_ad" duration="PT30S">
    <!-- 30-—Å–µ–∫—É–Ω–¥–Ω–∞ —Ä–µ–∫–ª–∞–º–∞ -->
  </Period>

  <Period id="main_content" duration="PT2H">
    <!-- –û—Å–Ω–æ–≤–Ω–∏–π —Ñ—ñ–ª—å–º -->
  </Period>

  <Period id="credits" duration="PT5M">
    <!-- –¢–∏—Ç—Ä–∏ -->
  </Period>
</MPD>
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**

- –†—ñ–∑–Ω—ñ –ø–µ—Ä—ñ–æ–¥–∏ –º–æ–∂—É—Ç—å –º–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ –∫–æ–¥–µ–∫–∏
- –õ–µ–≥–∫–æ –≤—Å—Ç–∞–≤–∏—Ç–∏ —Ä–µ–∫–ª–∞–º—É (server-side ad insertion)
- –ú–æ–∂–Ω–∞ –∑–º—ñ–Ω—é–≤–∞—Ç–∏ –Ω–∞–±—ñ—Ä —è–∫–æ—Å—Ç–µ–π per-period

**HLS –µ–∫–≤—ñ–≤–∞–ª–µ–Ω—Ç:** –ü–æ—Ç—Ä—ñ–±–µ–Ω –æ–∫—Ä–µ–º–∏–π `.m3u8` –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø–µ—Ä—ñ–æ–¥—É –∞–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `#EXT-X-DISCONTINUITY`.

::

::accordion-item{label="üåç Multi-language Audio: –ü—Ä–æ—Å—Ç—ñ—à–µ –≤ DASH" icon="i-lucide-languages"}

**DASH:**

```xml
<AdaptationSet lang="en" mimeType="audio/mp4">
  <Representation bandwidth="128000">...</Representation>
</AdaptationSet>

<AdaptationSet lang="es" mimeType="audio/mp4">
  <Representation bandwidth="128000">...</Representation>
</AdaptationSet>

<AdaptationSet lang="uk" mimeType="audio/mp4">
  <Representation bandwidth="128000">...</Representation>
</AdaptationSet>
```

–ü–ª–µ—î—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–±–∏—Ä–∞—î –º–æ–≤—É –Ω–∞ –æ—Å–Ω–æ–≤—ñ browser locale.

**HLS:** –ü–æ—Ç—Ä—ñ–±–µ–Ω `#EXT-X-MEDIA` —É Master Playlist:

```m3u8
#EXT-X-MEDIA:TYPE=AUDIO,GROUP-ID="audio",LANGUAGE="en",NAME="English",URI="audio_en.m3u8"
#EXT-X-MEDIA:TYPE=AUDIO,GROUP-ID="audio",LANGUAGE="es",NAME="Spanish",URI="audio_es.m3u8"
```

**–í–∏—Å–Ω–æ–≤–æ–∫:** DASH –ø—Ä–∏—Ä–æ–¥–Ω–æ –ø—ñ–¥—Ç—Ä–∏–º—É—î –±–∞–≥–∞—Ç–æ–º–æ–≤–Ω—ñ—Å—Ç—å.

::

::accordion-item{label="üîê DRM: DASH –≤–∏–≥—Ä–∞—î" icon="i-lucide-shield-check"}

**DASH + CENC (Common Encryption):**

- –û–¥–∏–Ω —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª –ø—Ä–∞—Ü—é—î –∑ **–∫—ñ–ª—å–∫–æ–º–∞ DRM** (Widevine, PlayReady, FairPlay\*)
- MPD –º—ñ—Å—Ç–∏—Ç—å `<ContentProtection>` –¥–ª—è –∫–æ–∂–Ω–æ—ó —Å–∏—Å—Ç–µ–º–∏:

```xml
<ContentProtection schemeIdUri="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed" value="Widevine">
  <cenc:pssh>BASE64_WIDEVINE_PSSH</cenc:pssh>
</ContentProtection>

<ContentProtection schemeIdUri="urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95" value="PlayReady">
  <cenc:pssh>BASE64_PLAYREADY_PSSH</cenc:pssh>
</ContentProtection>
```

**HLS + FairPlay:**

- –¢—ñ–ª—å–∫–∏ Apple –µ–∫–æ—Å–∏—Å—Ç–µ–º–∞
- –î–ª—è Widevine –ø–æ—Ç—Ä—ñ–±–µ–Ω –æ–∫—Ä–µ–º–∏–π DASH manifest

**–í–∏—Å–Ω–æ–≤–æ–∫:** Netflix –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î DASH —Å–∞–º–µ —á–µ—Ä–µ–∑ DRM flexibility.

::

::

---

## 4. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è DASH –ö–æ–Ω—Ç–µ–Ω—Ç—É –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é FFmpeg

### 4.1. –ü—Ä–æ—Å—Ç–∏–π DASH stream (–æ–¥–Ω–∞ —è–∫—ñ—Å—Ç—å)

```bash
ffmpeg -i input.mp4 \
  -c:v libx264 -preset medium -crf 23 \
  -c:a aac -b:a 128k \
  -f dash \
  -seg_duration 6 \
  -use_template 1 \
  -use_timeline 0 \
  output.mpd
```

**–ü–æ—è—Å–Ω–µ–Ω–Ω—è –ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤:**

::field-group

::field{name="-f dash" type="Format"}
–í–∏—Ö—ñ–¥–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç ‚Äî DASH
::

::field{name="-seg_duration 6" type="Seconds"}
–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å –∫–æ–∂–Ω–æ–≥–æ —Å–µ–≥–º–µ–Ω—Ç–∞ (6 —Å–µ–∫—É–Ω–¥)
::

::field{name="-use_template 1" type="Boolean"}
–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `<SegmentTemplate>` –∑–∞–º—ñ—Å—Ç—å `<SegmentList>` (–µ–∫–æ–Ω–æ–º–∏—Ç—å –º—ñ—Å—Ü–µ –≤ MPD)
::

::field{name="-use_timeline 0" type="Boolean"}
–ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `<SegmentTimeline>` (–ø—Ä–æ—Å—Ç—ñ—à–∏–π MPD –¥–ª—è VOD)
::

::

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```
output.mpd
init-stream0.m4s       ‚Üê –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ–π–Ω–∏–π —Å–µ–≥–º–µ–Ω—Ç (–≤—ñ–¥–µ–æ)
init-stream1.m4s       ‚Üê –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ–π–Ω–∏–π —Å–µ–≥–º–µ–Ω—Ç (–∞—É–¥—ñ–æ)
chunk-stream0-00001.m4s
chunk-stream0-00002.m4s
chunk-stream0-00003.m4s
...
chunk-stream1-00001.m4s  ‚Üê –ê—É–¥—ñ–æ —Å–µ–≥–º–µ–Ω—Ç–∏
chunk-stream1-00002.m4s
...
```

### 4.2. Multi-bitrate DASH (ABR)

–°—Ç–≤–æ—Ä–∏–º–æ 3 –≤–∞—Ä—ñ–∞–Ω—Ç–∏ —è–∫–æ—Å—Ç—ñ: 480p, 720p, 1080p.

```bash
#!/bin/bash

INPUT="movie.mp4"
OUTPUT_DIR="dash_output"
mkdir -p "$OUTPUT_DIR"

ffmpeg -i "$INPUT" \
  -map 0:v -map 0:v -map 0:v -map 0:a \
  \
  -c:v:0 libx264 -b:v:0 1000k -s:v:0 854x480 -profile:v:0 main \
  -c:v:1 libx264 -b:v:1 2500k -s:v:1 1280x720 -profile:v:1 main \
  -c:v:2 libx264 -b:v:2 5000k -s:v:2 1920x1080 -profile:v:2 high \
  \
  -c:a aac -b:a 128k -ar 48000 \
  \
  -f dash \
  -seg_duration 6 \
  -use_template 1 \
  -use_timeline 0 \
  -init_seg_name 'init-$RepresentationID$.m4s' \
  -media_seg_name 'chunk-$RepresentationID$-$Number%05d$.m4s' \
  -adaptation_sets "id=0,streams=v id=1,streams=a" \
  "$OUTPUT_DIR/manifest.mpd"
```

**–ü–æ—è—Å–Ω–µ–Ω–Ω—è:**

- `-map 0:v -map 0:v -map 0:v`: –°—Ç–≤–æ—Ä—é—î 3 –≤—ñ–¥–µ–æ-–ø–æ—Ç–æ–∫–∏
- `-map 0:a`: –û–¥–∏–Ω –∞—É–¥—ñ–æ-–ø–æ—Ç—ñ–∫
- `-c:v:0`, `-c:v:1`, `-c:v:2`: –û–∫—Ä–µ–º—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –≤—ñ–¥–µ–æ
- `-adaptation_sets`: –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è (AdaptationSet 0 = –≤—ñ–¥–µ–æ, AdaptationSet 1 = –∞—É–¥—ñ–æ)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```xml
<MPD>
  <Period>
    <AdaptationSet id="0">
      <Representation id="0" bandwidth="1000000" width="854" height="480">...
      <Representation id="1" bandwidth="2500000" width="1280" height="720">...
      <Representation id="2" bandwidth="5000000" width="1920" height="1080">...
    </AdaptationSet>
    <AdaptationSet id="1">
      <Representation id="3" bandwidth="128000">...
    </AdaptationSet>
  </Period>
</MPD>
```

### 4.3. Multi-language Audio

```bash
ffmpeg -i movie.mp4 -i audio_spanish.mp3 \
  -map 0:v -map 0:a -map 1:a \
  \
  -c:v libx264 -b:v 2500k \
  -c:a aac -b:a 128k \
  \
  -f dash \
  -seg_duration 6 \
  -adaptation_sets "id=0,streams=v id=1,streams=a,lang=en id=2,streams=a,lang=es" \
  output.mpd
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```xml
<AdaptationSet id="1" lang="en">
  <Representation id="audio_en">...</Representation>
</AdaptationSet>

<AdaptationSet id="2" lang="es">
  <Representation id="audio_es">...</Representation>
</AdaptationSet>
```

---

## 5. –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è DASH –≤ –ë—Ä–∞—É–∑–µ—Ä

### 5.1. Shaka Player (Google)

**–ß–æ–º—É Shaka Player?**

- –†–æ–∑—Ä–æ–±–ª–µ–Ω–∏–π Google (–ø—ñ–¥—Ç—Ä–∏–º–∫–∞ –Ω–∞–π–∫—Ä–∞—â–∞)
- –ü—ñ–¥—Ç—Ä–∏–º—É—î DRM (Widevine, PlayReady, FairPlay\*)
- –í–±—É–¥–æ–≤–∞–Ω–∏–π ABR –∞–ª–≥–æ—Ä–∏—Ç–º
- –î–µ—Ç–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (bandwidth, buffer, dropped frames)

**–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è:**

```html
<!DOCTYPE html>
<html>
    <head>
        <script src="https://cdn.jsdelivr.net/npm/shaka-player@4.7/dist/shaka-player.compiled.js"></script>
    </head>
    <body>
        <video id="video" width="640" controls></video>

        <script>
            const video = document.getElementById('video')
            const player = new shaka.Player(video)

            // DASH manifest URL
            const manifestUri = 'https://cdn.example.com/manifest.mpd'

            player
                .load(manifestUri)
                .then(() => {
                    console.log('Video loaded successfully!')
                })
                .catch((error) => {
                    console.error('Error loading video:', error)
                })

            // –í—ñ–¥—Å–ª—ñ–¥–∫–æ–≤—É–≤–∞–Ω–Ω—è –∑–º—ñ–Ω —è–∫–æ—Å—Ç—ñ
            player.addEventListener('adaptation', () => {
                const tracks = player.getVariantTracks()
                const activeTrack = tracks.find((t) => t.active)
                console.log(`Quality: ${activeTrack.height}p, Bandwidth: ${activeTrack.bandwidth}`)
            })
        </script>
    </body>
</html>
```

### 5.2. dash.js (–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)

**dash.js** ‚Äî reference implementation –≤—ñ–¥ Dash Industry Forum.

```html
<script src="https://cdn.dashjs.org/latest/dash.all.min.js"></script>
<video id="video" controls></video>

<script>
    const url = 'https://cdn.example.com/manifest.mpd'
    const player = dashjs.MediaPlayer().create()
    player.initialize(document.querySelector('#video'), url, true)

    // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è ABR
    player.updateSettings({
        streaming: {
            abr: {
                fetchThroughputCalculationMode: 'ewma',
                bandwidthSafetyFactor: 0.9,
                useDefaultABRRules: true,
            },
        },
    })
</script>
```

::tip
**Shaka Player vs dash.js:**

- **Shaka Player**: –ö—Ä–∞—â–∏–π DRM support, –∫—Ä–∞—â–∏–π API, –∞–∫—Ç–∏–≤–Ω—ñ—à–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞
- **dash.js**: Reference implementation (100% –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É), –¥–µ—Ç–∞–ª—å–Ω—ñ—à—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è ABR

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** –î–ª—è production –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ **Shaka Player**.
::

---

## 6. –†–æ–∑—à–∏—Ä–µ–Ω—ñ –¢–µ–º–∏

### 6.1. Common Encryption (CENC) —Ç–∞ DRM

**–ü—Ä–æ–±–ª–µ–º–∞ –±–µ–∑ CENC:**

–£ –º–∏–Ω—É–ª–æ–º—É –∫–æ–∂–Ω–∞ DRM —Å–∏—Å—Ç–µ–º–∞ –≤–∏–º–∞–≥–∞–ª–∞ –æ–∫—Ä–µ–º–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è:

- Widevine: `video_widevine.m4s`
- PlayReady: `video_playready.m4s`
- FairPlay: `video_fairplay.m4s`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 3x storage, 3x bandwidth.

**–†—ñ—à–µ–Ω–Ω—è: CENC (Common Encryption)**

–û–¥–∏–Ω —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª, –∞–ª–µ –∑ –º–µ—Ç–∞–¥–∞–Ω–∏–º–∏ –¥–ª—è –∫—ñ–ª—å–∫–æ—Ö DRM:

```xml
<ContentProtection schemeIdUri="urn:mpeg:dash:mp4protection:2011" value="cenc" cenc:default_KID="ABCD1234..."/>

<ContentProtection schemeIdUri="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed">
  <!-- Widevine PSSH -->
  <cenc:pssh>AAAAW3Bzc2gAAAAA7e+LqXnWSs6jyCfc...</cenc:pssh>
</ContentProtection>

<ContentProtection schemeIdUri="urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95">
  <!-- PlayReady PSSH -->
  <cenc:pssh>AAACYHBzc2gAAAAAmgTweZhAQoarkuZb...</cenc:pssh>
</ContentProtection>
```

**–Ø–∫ —Ü–µ –ø—Ä–∞—Ü—é—î:**

1. –°–µ–≥–º–µ–Ω—Ç–∏ —à–∏—Ñ—Ä—É—é—Ç—å—Å—è AES-128-CTR –∑ Content Key
2. PSSH (Protection System Specific Header) –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ DRM
3. –ü–ª–µ—î—Ä –≤–∏–±–∏—Ä–∞—î –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—É —Å–∏—Å—Ç–µ–º—É (Chrome ‚Üí Widevine, Edge ‚Üí PlayReady)
4. –û—Ç—Ä–∏–º—É—î –ª—ñ—Ü–µ–Ω–∑—ñ—é –∑ License Server
5. –†–æ–∑—à–∏—Ñ—Ä–æ–≤—É—î —Ç–∞ –ø—Ä–æ–≥—Ä–∞—î

**–ü—Ä–∏–∫–ª–∞–¥ –∑ Shaka Player:**

```javascript
const player = new shaka.Player(video)

player.configure({
    drm: {
        servers: {
            'com.widevine.alpha': 'https://license.example.com/widevine',
            'com.microsoft.playready': 'https://license.example.com/playready',
        },
    },
})

player.load('https://cdn.example.com/encrypted.mpd')
```

::warning
**FairPlay —É DASH:** Apple FairPlay —Ç–µ—Ö–Ω—ñ—á–Ω–æ –Ω–µ—Å—É–º—ñ—Å–Ω–∏–π –∑ DASH MPD (Apple –≤–∏–º–∞–≥–∞—î HLS). –û–¥–Ω–∞–∫ –¥–µ—è–∫—ñ –ø–ª–µ—î—Ä–∏ (Shaka Player 4.3+) –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å FairPlay + DASH —á–µ—Ä–µ–∑ custom extensions.
::

### 6.2. Live DASH: Dynamic MPD

**–í—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ Live –≤—ñ–¥ VOD:**

::tabs

::tabs-item{label="VOD (type=static)" icon="i-lucide-film"}

```xml
<MPD type="static" mediaPresentationDuration="PT2H15M">
  <Period>
    <AdaptationSet>
      <Representation bandwidth="5000000">
        <SegmentTemplate media="seg_$Number$.m4s" startNumber="1"/>
      </Representation>
    </AdaptationSet>
  </Period>
</MPD>
```

- –£—Å—ñ —Å–µ–≥–º–µ–Ω—Ç–∏ –≤—ñ–¥–æ–º—ñ –∑–∞–∑–¥–∞–ª–µ–≥—ñ–¥—å
- `mediaPresentationDuration` —Ñ—ñ–∫—Å–æ–≤–∞–Ω–∏–π
- –ü–ª–µ—î—Ä –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î MPD –æ–¥–∏–Ω —Ä–∞–∑

::

::tabs-item{label="Live (type=dynamic)" icon="i-lucide-radio"}

```xml
<MPD type="dynamic"
     availabilityStartTime="2024-02-17T12:00:00Z"
     publishTime="2024-02-17T12:30:00Z"
     minimumUpdatePeriod="PT5S"
     timeShiftBufferDepth="PT2M">

  <Period start="PT0S">
    <AdaptationSet>
      <Representation bandwidth="5000000">
        <SegmentTemplate media="seg_$Number$.m4s"
                         timescale="90000"
                         duration="540000"
                         startNumber="1"/>
      </Representation>
    </AdaptationSet>
  </Period>
</MPD>
```

**–ö–ª—é—á–æ–≤—ñ –∞—Ç—Ä–∏–±—É—Ç–∏:**

- `availabilityStartTime`: –ö–æ–ª–∏ –ø–æ—á–∞–ª–∞—Å—è —Ç—Ä–∞–Ω—Å–ª—è—Ü—ñ—è
- `publishTime`: –ö–æ–ª–∏ –±—É–≤ –æ–Ω–æ–≤–ª–µ–Ω–∏–π MPD (timestamps –¥–ª—è –∫–µ—à—É–≤–∞–Ω–Ω—è)
- `minimumUpdatePeriod`: –Ø–∫ —á–∞—Å—Ç–æ –ø–ª–µ—î—Ä –º–∞—î –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è (5 —Å–µ–∫)
- `timeShiftBufferDepth`: DVR window (2 —Ö–≤–∏–ª–∏–Ω–∏ –Ω–∞–∑–∞–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –ø–µ—Ä–µ–º–æ—Ç–∞—Ç–∏)

::

::

**–Ø–∫ –ø–ª–µ—î—Ä –ø—Ä–∞—Ü—é—î –∑ Live:**

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î MPD
2. –†–æ–∑—Ä–∞—Ö–æ–≤—É—î `availableSegmentNumber` –Ω–∞ –æ—Å–Ω–æ–≤—ñ `availabilityStartTime` —Ç–∞ –ø–æ—Ç–æ—á–Ω–æ–≥–æ —á–∞—Å—É
3. –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –¥–æ—Å—Ç—É–ø–Ω—ñ —Å–µ–≥–º–µ–Ω—Ç–∏
4. –ö–æ–∂–Ω—ñ `minimumUpdatePeriod` —Å–µ–∫—É–Ω–¥ –æ–Ω–æ–≤–ª—é—î MPD
5. –Ø–∫—â–æ —î –Ω–æ–≤—ñ —Å–µ–≥–º–µ–Ω—Ç–∏ ‚Äî –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î —ó—Ö

### 6.3. Low Latency DASH (LL-DASH)

**–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞ DASH –ª–∞—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å:** 10-30 —Å–µ–∫—É–Ω–¥

**LL-DASH –ª–∞—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å:** 3-5 —Å–µ–∫—É–Ω–¥

**–ö–ª—é—á–æ–≤—ñ –∑–º—ñ–Ω–∏:**

::card-group

::card{title="üì¶ Chunked Transfer Encoding" icon="i-lucide-package"}

–°–µ–≥–º–µ–Ω—Ç–∏ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è –ø–æ —á–∞—Å—Ç–∏–Ω–∞—Ö (chunks) –¥–æ —Ç–æ–≥–æ, —è–∫ –≤–æ–Ω–∏ –ø–æ–≤–Ω—ñ—Å—Ç—é –∑–∞–∫–æ–¥–æ–≤–∞–Ω—ñ.

```http
Transfer-Encoding: chunked

0A\r\n
[chunk 1 data]\r\n
0B\r\n
[chunk 2 data]\r\n
...
```

–ü–ª–µ—î—Ä –ø–æ—á–∏–Ω–∞—î decode –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–µ—Ä—à–æ–≥–æ chunk.

::

::card{title="‚ö° Shorter Segments" icon="i-lucide-zap"}

Segment duration: 1-2 —Å–µ–∫—É–Ω–¥–∏ (–∑–∞–º—ñ—Å—Ç—å 6-10)

::

::card{title="üîÑ Server Push" icon="i-lucide-upload"}

HTTP/2 Server Push –ø–µ—Ä–µ–¥–∞—î –Ω–∞—Å—Ç—É–ø–Ω–∏–π —Å–µ–≥–º–µ–Ω—Ç —Ä–∞–∑–æ–º —ñ–∑ –ø–æ—Ç–æ—á–Ω–∏–º.

::

::

**–ü—Ä–∏–∫–ª–∞–¥ MPD –¥–ª—è LL-DASH:**

```xml
<MPD type="dynamic"
     availabilityStartTime="2024-02-17T12:00:00Z"
     suggestedPresentationDelay="PT2S"
     minBufferTime="PT1S">

  <ServiceDescription>
    <Latency target="2000" min="1000" max="4000"/>
  </ServiceDescription>

  <Period>
    <AdaptationSet>
      <Representation>
        <SegmentTemplate media="seg_$Number$.m4s" duration="90000" timescale="90000"/>
        <!-- duration=90000/90000 = 1 —Å–µ–∫—É–Ω–¥–∞ -->
      </Representation>
    </AdaptationSet>
  </Period>
</MPD>
```

::note
**LL-DASH –ø—ñ–¥—Ç—Ä–∏–º–∫–∞:**

- dash.js 4.0+
- Shaka Player 4.2+
- –ü–æ—Ç—Ä–µ–±—É—î HTTP/2 —Å–µ—Ä–≤–µ—Ä (Nginx 1.13+, Apache 2.4.17+)

::

### 6.4. CMAF (Common Media Application Format)

**–ü—Ä–æ–±–ª–µ–º–∞:** –†—ñ–∑–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏ —Å–µ–≥–º–µ–Ω—Ç—ñ–≤ –¥–ª—è HLS (`.ts` –∞–±–æ `.m4s`) —Ç–∞ DASH (`.m4s`).

**–†—ñ—à–µ–Ω–Ω—è:** CMAF ‚Äî —î–¥–∏–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç, —Å—É–º—ñ—Å–Ω–∏–π –∑ –æ–±–æ–º–∞.

**–ü–µ—Ä–µ–≤–∞–≥–∏ CMAF:**

- –û–¥–∏–Ω –Ω–∞–±—ñ—Ä —Å–µ–≥–º–µ–Ω—Ç—ñ–≤ –¥–ª—è HLS —Ç–∞ DASH
- 50% –µ–∫–æ–Ω–æ–º—ñ—è storage —Ç–∞ bandwidth
- –ü—Ä–æ—Å—Ç—ñ—à–∏–π workflow (–∫–æ–¥—É—î–º–æ –æ–¥–∏–Ω —Ä–∞–∑)

**–Ø–∫ —Å—Ç–≤–æ—Ä–∏—Ç–∏ CMAF –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é FFmpeg:**

```bash
ffmpeg -i input.mp4 \
  -c:v libx264 -c:a aac \
  -f hls \
  -hls_segment_type fmp4 \
  -hls_playlist_type vod \
  output.m3u8
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

```
output.m3u8          ‚Üê HLS manifest
output0.m4s
output1.m4s
output2.m4s
...
```

**–°—Ç–≤–æ—Ä—é—î–º–æ DASH MPD –≤—Ä—É—á–Ω—É:**

```xml
<MPD>
  <Period>
    <AdaptationSet>
      <Representation>
        <BaseURL>./</BaseURL>
        <SegmentTemplate media="output$Number$.m4s" startNumber="0"/>
      </Representation>
    </AdaptationSet>
  </Period>
</MPD>
```

**–ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ Shaka Packager:**

```bash
packager \
  in=input.mp4,stream=video,output=video.mp4 \
  in=input.mp4,stream=audio,output=audio.mp4 \
  --hls_master_playlist_output master.m3u8 \
  --mpd_output manifest.mpd
```

---

## 7. Performance Optimization

### 7.1. Initialization Segment Optimization

**–ü—Ä–æ–±–ª–µ–º–∞:** Init segment –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î—Ç—å—Å—è –¥–ª—è –∫–æ–∂–Ω–æ—ó —è–∫–æ—Å—Ç—ñ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—ñ.

**–†—ñ—à–µ–Ω–Ω—è:** –û–±'—î–¥–Ω–∞–Ω–∏–π init segment –¥–ª—è –≤—Å—ñ—Ö representations.

```bash
ffmpeg \
  -f dash \
  -single_file 1 \
  -init_seg_name 'init.mp4' \
  output.mpd
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**

- –û–¥–∏–Ω `init.mp4` –¥–ª—è –≤—Å—ñ—Ö —è–∫–æ—Å—Ç–µ–π
- –ï–∫–æ–Ω–æ–º—ñ—è: 1-2 MB –ø—Ä–∏ –∫–æ–∂–Ω–æ–º—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–Ω—ñ —è–∫–æ—Å—Ç—ñ

### 7.2. Byte-Range Requests

**–ó–∞–º—ñ—Å—Ç—å –æ–∫—Ä–µ–º–∏—Ö —Ñ–∞–π–ª—ñ–≤** –º–æ–∂–Ω–∞ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏ –≤—Å—ñ —Å–µ–≥–º–µ–Ω—Ç–∏ –≤ –æ–¥–Ω–æ–º—É —Ñ–∞–π–ª—ñ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ HTTP Range headers:

```xml
<SegmentList>
  <Initialization sourceURL="stream.mp4" range="0-1024"/>
  <SegmentURL mediaRange="1025-500000"/>
  <SegmentURL mediaRange="500001-950000"/>
  <SegmentURL mediaRange="950001-1400000"/>
</SegmentList>
```

**–ü–µ—Ä–µ–≤–∞–≥–∏:**

- –ú–µ–Ω—à–µ HTTP –∑–∞–ø–∏—Ç—ñ–≤ (–æ–¥–∏–Ω —Ñ–∞–π–ª –∑–∞–º—ñ—Å—Ç—å 100+ —Å–µ–≥–º–µ–Ω—Ç—ñ–≤)
- –ü—Ä–æ—Å—Ç—ñ—à–∏–π storage (–æ–¥–∏–Ω —Ñ–∞–π–ª –∑–∞–º—ñ—Å—Ç—å —Ç–∏—Å—è—á)
- –Ü–¥–µ–∞–ª—å–Ω–æ –¥–ª—è CDN (–æ–¥–∏–Ω –∫–µ—à-–∑–∞–ø–∏—Å)

**–ù–µ–¥–æ–ª—ñ–∫–∏:**

- –Ø–∫—â–æ —â–æ—Å—å –ø—Å—É—î—Ç—å—Å—è –≤ —Ñ–∞–π–ª—ñ ‚Äî –≤—Å—è —è–∫—ñ—Å—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
- –°–∫–ª–∞–¥–Ω—ñ—à–µ –æ–Ω–æ–≤–ª—é–≤–∞—Ç–∏ Live –∫–æ–Ω—Ç–µ–Ω—Ç

### 7.3. Server-Side Rendering: Reduce MPD Size

**–í–µ–ª–∏–∫–∏–π MPD (–∫—ñ–ª—å–∫–∞ MB)** –º–æ–∂–µ —Å–ø–æ–≤—ñ–ª—å–Ω–∏—Ç–∏ start time.

**–†—ñ—à–µ–Ω–Ω—è:** –ì–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ MPD –¥–∏–Ω–∞–º—ñ—á–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ:

```javascript
// Node.js –ø—Ä–∏–∫–ª–∞–¥
app.get('/manifest.mpd', (req, res) => {
    const userAgent = req.headers['user-agent']
    const isMobile = /Mobile/.test(userAgent)

    // –î–ª—è –º–æ–±—ñ–ª—å–Ω–∏—Ö: —Ç—ñ–ª—å–∫–∏ 480p, 720p
    // –î–ª—è desktop: 720p, 1080p, 4K
    const qualities = isMobile ? ['480p', '720p'] : ['720p', '1080p', '4k']

    const mpd = generateMPD(qualities)
    res.set('Content-Type', 'application/dash+xml')
    res.send(mpd)
})
```

**–ï–∫–æ–Ω–æ–º—ñ—è:** MPD —Ä–æ–∑–º—ñ—Ä–æ–º 500 KB –∑–∞–º—ñ—Å—Ç—å 2 MB.

---

## 8. Troubleshooting

### 8.1. –¢–∏–ø–æ–≤—ñ –ü—Ä–æ–±–ª–µ–º–∏

::accordion

::accordion-item{label="‚ùå CORS Error" icon="i-lucide-alert-circle"}

**–¢–µ —Å–∞–º–µ, —â–æ –≤ HLS.** –î–æ–¥–∞–π—Ç–µ CORS headers:

```nginx
location ~ \.(mpd|m4s|mp4)$ {
    add_header Access-Control-Allow-Origin * always;
    add_header Access-Control-Allow-Methods 'GET, HEAD, OPTIONS' always;
    add_header Access-Control-Allow-Headers 'Range' always;

    if ($request_method = OPTIONS) {
        return 204;
    }
}
```

::

::accordion-item{label="üö´ Safari –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—î DASH" icon="i-lucide-apple"}

**–ü—Ä–æ–±–ª–µ–º–∞:** Safari –ù–ï –º–∞—î –Ω–∞—Ç–∏–≤–Ω–æ—ó –ø—ñ–¥—Ç—Ä–∏–º–∫–∏ DASH.

**–†—ñ—à–µ–Ω–Ω—è:**

1. **Fallback –Ω–∞ HLS:**

```javascript
const video = document.getElementById('video')

if (video.canPlayType('application/vnd.apple.mpegurl')) {
    // Safari: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ HLS
    video.src = 'https://cdn.example.com/stream.m3u8'
} else if (shaka.Player.isBrowserSupported()) {
    // Chrome/Firefox: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ DASH
    const player = new shaka.Player(video)
    player.load('https://cdn.example.com/manifest.mpd')
}
```

2. **CMAF:** –û–¥–∏–Ω –Ω–∞–±—ñ—Ä —Å–µ–≥–º–µ–Ω—Ç—ñ–≤, –¥–≤–∞ manifests (HLS + DASH).

::

::accordion-item{label="‚è±Ô∏è Segments –¥–æ—Å—Ç—É–ø–Ω—ñ –∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é (404)" icon="i-lucide-clock"}

**–°–∏–º–ø—Ç–æ–º (Live DASH):**

```
Failed to load segment: 404 Not Found
chunk-stream0-00125.m4s
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–ª–µ—î—Ä —Ä–æ–∑—Ä–∞—Ö—É–≤–∞–≤, —â–æ —Å–µ–≥–º–µ–Ω—Ç –≤–∂–µ –º–∞—î –±—É—Ç–∏ –¥–æ—Å—Ç—É–ø–Ω–∏–π, –∞–ª–µ encoder —â–µ –Ω–µ —Å—Ç–≤–æ—Ä–∏–≤ –π–æ–≥–æ.

**–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

–ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `suggestedPresentationDelay` —É MPD:

```xml
<MPD suggestedPresentationDelay="PT10S">
```

–¶–µ –æ–∑–Ω–∞—á–∞—î: –ø–ª–µ—î—Ä –º–∞—î –≤—ñ–¥—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∑ –∑–∞—Ç—Ä–∏–º–∫–æ—é 10 —Å–µ–∫—É–Ω–¥ –≤—ñ–¥ "live edge".

**–†—ñ—à–µ–Ω–Ω—è:**

–ó–±—ñ–ª—å—à—ñ—Ç—å `suggestedPresentationDelay` –¥–æ 15-20 —Å–µ–∫—É–Ω–¥.

::

::accordion-item{label="üéµ Audio/Video –Ω–µ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–æ–≤–∞–Ω—ñ" icon="i-lucide-music"}

**–ü—Ä–∏—á–∏–Ω–∞:** –†—ñ–∑–Ω—ñ `timescale` –¥–ª—è –∞—É–¥—ñ–æ —Ç–∞ –≤—ñ–¥–µ–æ.

**–î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**

```bash
ffprobe -show_streams chunk-stream0-00001.m4s | grep time_base
# –í—ñ–¥–µ–æ: time_base=1/90000

ffprobe -show_streams chunk-stream1-00001.m4s | grep time_base
# –ê—É–¥—ñ–æ: time_base=1/48000
```

**–†—ñ—à–µ–Ω–Ω—è:**

–£ MPD –ø–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—å, —â–æ `timescale` –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π:

```xml
<!-- –í—ñ–¥–µ–æ -->
<SegmentTemplate timescale="90000" duration="540000"/>
<!-- 540000/90000 = 6 —Å–µ–∫—É–Ω–¥ -->

<!-- –ê—É–¥—ñ–æ -->
<SegmentTemplate timescale="48000" duration="288000"/>
<!-- 288000/48000 = 6 —Å–µ–∫—É–Ω–¥ -->
```

–û–±–∏–¥–≤–∞ –º–∞—é—Ç—å –±—É—Ç–∏ 6 —Å–µ–∫—É–Ω–¥.

::

::

### 8.2. –Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

::card-group

::card{title="üß™ DASH Validator" icon="i-lucide-check-square"}

[DASH-IF Conformance Tool](https://conformance.dashif.org/)

Upload –≤–∞—à `.mpd` —Ç–∞ –æ—Ç—Ä–∏–º–∞–π—Ç–µ –∑–≤—ñ—Ç –ø—Ä–æ –ø–æ–º–∏–ª–∫–∏.

::

::card{title="üìä Shaka Player Stats" icon="i-lucide-bar-chart"}

```javascript
const player = new shaka.Player(video)

setInterval(() => {
    const stats = player.getStats()
    console.log('Bandwidth:', stats.estimatedBandwidth)
    console.log('Buffer:', video.buffered.end(0) - video.currentTime)
    console.log('Dropped frames:', stats.droppedFrames)
}, 1000)
```

::

::card{title="üîç Chrome Media Internals" icon="i-lucide-chrome"}

–í—ñ–¥–∫—Ä–∏–π—Ç–µ `chrome://media-internals/` —Ç–∞ –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Play –Ω–∞ DASH –≤—ñ–¥–µ–æ.

–í–∏ –ø–æ–±–∞—á–∏—Ç–µ:

- –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω—ñ —Å–µ–≥–º–µ–Ω—Ç–∏
- Buffer graph
- Decoder —Å—Ç–∞—Ç—É—Å
- –ü–æ–º–∏–ª–∫–∏ –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è

::

::

---

## 9. DASH Best Practices

::steps

### 1. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ CMAF –¥–ª—è HLS + DASH

–û–¥–∏–Ω –Ω–∞–±—ñ—Ä —Å–µ–≥–º–µ–Ω—Ç—ñ–≤ = 50% –µ–∫–æ–Ω–æ–º—ñ—ó.

### 2. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ Cache Headers

```nginx
location ~ \.mpd$ {
    add_header Cache-Control "public, max-age=10";
}

location ~ \.(m4s|mp4)$ {
    add_header Cache-Control "public, max-age=31536000, immutable";
}
```

### 3. –î–ª—è Live: `suggestedPresentationDelay` >= 10s

–ó–∞—Ö–∏—â–∞—î –≤—ñ–¥ 404 –Ω–∞ —Å–µ–≥–º–µ–Ω—Ç–∞—Ö.

### 4. DRM: –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ CENC

–û–¥–∏–Ω —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π —Ñ–∞–π–ª –¥–ª—è Widevine + PlayReady.

### 5. Multi-language: –û–∫—Ä–µ–º—ñ AdaptationSet

```xml
<AdaptationSet lang="en">...</AdaptationSet>
<AdaptationSet lang="es">...</AdaptationSet>
```

::

---

## 10. –ü—Ä–∞–∫—Ç–∏—á–Ω—ñ –ó–∞–≤–¥–∞–Ω–Ω—è

::steps

### –ó–∞–≤–¥–∞–Ω–Ω—è 1: –°—Ç–≤–æ—Ä–∏—Ç–∏ Multi-bitrate DASH

**–ú–µ—Ç–∞:** –ü–µ—Ä–µ—Ç–≤–æ—Ä–∏—Ç–∏ `movie.mp4` –Ω–∞ DASH –∑ 3 —è–∫–æ—Å—Ç—è–º–∏ (480p, 720p, 1080p) —Ç–∞ 2 –º–æ–≤–∞–º–∏ (–∞–Ω–≥–ª—ñ–π—Å—å–∫–∞, —ñ—Å–ø–∞–Ω—Å—å–∫–∞).

**–ö—Ä–æ–∫–∏:**

1. –ü—ñ–¥–≥–æ—Ç—É–π—Ç–µ `audio_spanish.mp3`
2. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ FFmpeg –¥–ª—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è DASH
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ MPD —É –≤–∞–ª—ñ–¥–∞—Ç–æ—Ä—ñ
4. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –≤ Shaka Player Demo

**–ö—Ä–∏—Ç–µ—Ä—ñ—ó —É—Å–ø—ñ—Ö—É:**

- 3 –≤—ñ–¥–µ–æ representations
- 2 –∞—É–¥—ñ–æ adaptationSets –∑ `lang` –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏
- ABR –ø—Ä–∞—Ü—é—î (–ø–µ—Ä–µ–º–∏–∫–∞—î—Ç—å—Å—è –º—ñ–∂ —è–∫–æ—Å—Ç—è–º–∏)

### –ó–∞–≤–¥–∞–Ω–Ω—è 2: CMAF –¥–ª—è HLS + DASH

**–ú–µ—Ç–∞:** –°—Ç–≤–æ—Ä–∏—Ç–∏ –æ–¥–∏–Ω –Ω–∞–±—ñ—Ä —Å–µ–≥–º–µ–Ω—Ç—ñ–≤, —è–∫–∏–π –ø—Ä–∞—Ü—é—î —ñ –∑ HLS, —ñ –∑ DASH.

**–ö—Ä–æ–∫–∏:**

1. –ó–∞–∫–æ–¥—É–π—Ç–µ –≤—ñ–¥–µ–æ –≤ fMP4 (CMAF)
2. –°—Ç–≤–æ—Ä—ñ—Ç—å HLS manifest (`master.m3u8`)
3. –°—Ç–≤–æ—Ä—ñ—Ç—å DASH manifest (`manifest.mpd`)
4. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –æ–±–∏–¥–≤–∞ –≤ —Ä—ñ–∑–Ω–∏—Ö –ø–ª–µ—î—Ä–∞—Ö

### –ó–∞–≤–¥–∞–Ω–Ω—è 3: –î—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Live DASH

**–ü—Ä–æ–±–ª–µ–º–∞:** Live stream –º–∞—î –∑–∞—Ç—Ä–∏–º–∫—É 45 —Å–µ–∫—É–Ω–¥ –∑–∞–º—ñ—Å—Ç—å –æ—á—ñ–∫—É–≤–∞–Ω–∏—Ö 10.

**–ó–∞–≤–¥–∞–Ω–Ω—è:**

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ MPD —Ç–∞ –∑–Ω–∞–π–¥—ñ—Ç—å `suggestedPresentationDelay`
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ `timeShiftBufferDepth`
3. –í–∏–º—ñ—Ä—è–π—Ç–µ encoder latency
4. –ó–Ω–∞–π–¥—ñ—Ç—å bottleneck

::

---

## 11. FAQ

::accordion

::accordion-item{label="Q: –ß–æ–º—É Netflix –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î DASH, –∞ –Ω–µ HLS?" icon="i-lucide-help-circle"}

**A:** DRM flexibility. DASH + CENC –ø—ñ–¥—Ç—Ä–∏–º—É—î Widevine (Android/Chrome) —Ç–∞ PlayReady (Windows/Xbox) –∑ –æ–¥–Ω–æ–≥–æ –Ω–∞–±–æ—Ä—É —Ñ–∞–π–ª—ñ–≤. HLS –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ç—ñ–ª—å–∫–∏ FairPlay (Apple only).

::

::accordion-item{label="Q: –Ø–∫ –∑—Ä–æ–±–∏—Ç–∏ DASH —É Safari?" icon="i-lucide-apple"}

**A:** Safari –ù–ï –ø—ñ–¥—Ç—Ä–∏–º—É—î DASH –Ω–∞—Ç–∏–≤–Ω–æ. –í–∞—Ä—ñ–∞–Ω—Ç–∏:

1. –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ Shaka Player (JavaScript polyfill)
2. Fallback –Ω–∞ HLS –¥–ª—è Safari
3. CMAF: –æ–¥–∏–Ω –Ω–∞–±—ñ—Ä —Å–µ–≥–º–µ–Ω—Ç—ñ–≤, –¥–≤–∞ manifests

::

::accordion-item{label="Q: `<SegmentTemplate>` vs `<SegmentList>` vs `<SegmentBase>`?" icon="i-lucide-list"}

**A:**

- **SegmentTemplate**: –®–∞–±–ª–æ–Ω URL (`segment_$Number$.m4s`). –ö–æ–º–ø–∞–∫—Ç–Ω–∏–π MPD.
- **SegmentList**: –Ø–≤–Ω–∏–π —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö —Å–µ–≥–º–µ–Ω—Ç—ñ–≤. –í–µ–ª–∏–∫–∏–π MPD, –∞–ª–µ –≥–Ω—É—á–∫—ñ—à–∏–π.
- **SegmentBase**: –û–¥–∏–Ω —Ñ–∞–π–ª –∑ Byte-Range requests. –î–ª—è VOD –∑ –≤–µ–ª–∏–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—è:** `SegmentTemplate` –¥–ª—è –±—ñ–ª—å—à–æ—Å—Ç—ñ –≤–∏–ø–∞–¥–∫—ñ–≤.

::

::accordion-item{label="Q: –Ø–∫ –ø—Ä–∞—Ü—é—î DVR (time-shift) —É Live DASH?" icon="i-lucide-rewind"}

**A:**

```xml
<MPD type="dynamic" timeShiftBufferDepth="PT10M">
```

`timeShiftBufferDepth=PT10M` = –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–æ–∂–µ –ø–µ—Ä–µ–º–æ—Ç–∞—Ç–∏ –Ω–∞ 10 —Ö–≤–∏–ª–∏–Ω –Ω–∞–∑–∞–¥.

–ü–ª–µ—î—Ä –∑–±–µ—Ä—ñ–≥–∞—î —Å—Ç–∞—Ä—ñ —Å–µ–≥–º–µ–Ω—Ç–∏ –≤ –±—É—Ñ–µ—Ä—ñ. –ü—ñ—Å–ª—è 10 —Ö–≤–∏–ª–∏–Ω –≤–æ–Ω–∏ –≤–∏–¥–∞–ª—è—é—Ç—å—Å—è.

::

::

---

## 12. –†–µ–∑—é–º–µ

::card-group

::card{title="üéØ –©–æ —Ç–∞–∫–µ DASH" icon="i-lucide-target"}

- –í—ñ–¥–∫—Ä–∏—Ç–∏–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç ISO/IEC 23009-1
- Codec-agnostic (VP9, AV1, Opus)
- XML manifest (`.mpd`)
- –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ CENC DRM (Widevine, PlayReady)

::

::card{title="üìê –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞" icon="i-lucide-layout"}

```
MPD
‚îî‚îÄ Period
   ‚îî‚îÄ AdaptationSet (Video)
      ‚îú‚îÄ Representation (1080p)
      ‚îú‚îÄ Representation (720p)
      ‚îî‚îÄ Representation (480p)
   ‚îî‚îÄ AdaptationSet (Audio EN)
   ‚îî‚îÄ AdaptationSet (Audio ES)
```

::

::card{title="‚öôÔ∏è –°—Ç–≤–æ—Ä–µ–Ω–Ω—è" icon="i-lucide-settings"}

```bash
ffmpeg -i input.mp4 \
  -c:v libx264 -c:a aac \
  -f dash \
  output.mpd
```

::

::card{title="üåê –ë—Ä–∞—É–∑–µ—Ä" icon="i-lucide-globe"}

Shaka Player –∞–±–æ dash.js

Safari: fallback –Ω–∞ HLS

::

::

::tip{icon="i-lucide-graduation-cap"}
**–í—ñ—Ç–∞—î–º–æ!** –í–∏ –æ–ø–∞–Ω—É–≤–∞–ª–∏ DASH Protocol.

**–ö–ª—é—á–æ–≤—ñ –≤–∏—Å–Ω–æ–≤–∫–∏:**

- DASH = –≥–Ω—É—á–∫—ñ—Å—Ç—å (codec-agnostic, multi-language, DRM)
- HLS = simple —Ç–∞ Apple-friendly
- **Best practice:** CMAF (–æ–¥–∏–Ω –Ω–∞–±—ñ—Ä —Å–µ–≥–º–µ–Ω—Ç—ñ–≤ –¥–ª—è –æ–±–æ—Ö)

**–ù–∞—Å—Ç—É–ø–Ω–∏–π –∫—Ä–æ–∫:** [CDN Architecture](./07.cdn-architecture.md) –∞–±–æ [Video Encoding Optimization](./08.video-encoding.md)
::
