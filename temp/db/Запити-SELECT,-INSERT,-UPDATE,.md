---
created: 2026-02-06T09:31:17 (UTC +02:00)
tags: []
source: https://materials.itstep.org/content/82a1ea3d-b686-440d-b7eb-295646c029e6/uk
author: 
---

# Запити SELECT, INSERT, UPDATE,

> ## Excerpt
> 1. Оператор SELECT

---
## 1\. Оператор SELECT

На минулому занятті ми продемонстрували вам приклад SQL-запиту, який повернув прізвища студентів, що народилися в листопаді. На поточному занятті ви докладніше дізнаєтесь, які оператори використовуються при написанні запитів,і почнемо ми з оператора SELECT.

### 1.1. Пропозиція SELECT

Пропозиція SELECT дозволяє читати необхідну інформацію з бази даних. У найпростішому варіанті використання після інструкції SELECT вказуються імена стовпців, значення яких потрібно отримати з однієї або декількох таблиць, назви цих стовпців розділяються між собою комами. Також після оператора SELECT можна вказувати обчислювальні результати і функції агрегування, про які ви дізнаєтеся в одному з наступних уроків.

Написання SQL-запиту із застосуванням лише одного оператора SELECT призведе до синтаксичної помилки, тому що необхідно використовувати його у поєднанні ще як мінімум з одним оператором — FROM.

### 1.2. Пропозиція FROM

Пропозиція FROM використовується для вказівки джерела отримання даних, після нього прописується назва таблиці або список таблиць, розділених між собою комами. Загальна форма запису SQL-запиту з використанням операторів SELECT та FROM виглядає наступним чином:

```html
SELECT columnName1, columnName2,...
FROM tableName;
```

![](select-insert/copy-svgrepo-com.svg)

Продемонструємо простий запит, який дає змогу отримати всю інформацію з таблиці Students бази даних University, яка була створена нами на попередньому уроці. Для цього відкриємо _MS SQL Server Management Studio 17_ і на панелі інструментів натиснемо кнопку New Query (Рисунок 1) або поєднання клавіш Ctrl+N, після чого у випадаючому списку необхідно вибрати необхідну БД (Рисунок 1).

![Рисунок 1. Створення нового запиту](select-insert/s9Chb9Vmx_ZWbb5znTgQNaSJ-dp73eJp.jpg)

Рисунок 1. Створення нового запиту

Увікні, що з'явилося напишемо наступний SQL-запит:

```html
SELECT LastName, FirstName, BirthDate, Grants, Email
FROM Students;
```

![](select-insert/copy-svgrepo-com.svg)

За допомогою цього запиту ми хочемо отримати значення стовпців LastName, FirstName, BirthDate, GrantsтаEmail для всіх записів таблиці Students.

Для того, щоб написаний нами запит виконався, необхідно натиснути кнопку Execute або клавішу F5 на клавіатурі (Рисунок 2).

![Рисунок 2. Запуск запиту на виконання](select-insert/tSidS6NDxpgxdjdFqQQI9SW1wXopjOFX.jpg)

Рисунок 2. Запуск запиту на виконання

В результаті SQL-запиту буде створено віртуальну таблицю, в якій міститься вся запитана інформація із фізичної таблиці Students бази даних University (Рисунок 3).

![Рисунок 3. Отримання всіх записів із таблиці Students](select-insert/bbakSll4Np0eJTj0Nj9xrVgJbuywNiCt.jpg)

Рисунок 3. Отримання всіх записів із таблиці Students

У мові SQL існує можливість написати запит, у якому замість списку стовпців таблиці можна вказати символ \*:

```html
SELECT*
FROM Students;
```

![](select-insert/copy-svgrepo-com.svg)

І хоча результат ми отримаємо такий же (Рисунок 3), цей SQL-запит буде виконуватися довше. Це відбувається тому, що потрібні стовпці не вказані явним чином і СУБД доводиться витрачати час на визначення та отримання всіх стовпців у таблиці. Різниця за часом при невеликій кількості записів буде не суттєвою, проте при великих обсягах даних буде дуже помітна, тому рекомендується в SQL-запиті вказувати всі стовпці, інформацію з яких необхідно отримати.

При написанні SQL-запитів можна формувати нові стовпці у віртуальній таблиці, поєднуючи значення кількох реальних стовпців за допомогою символу +, у цьому випадку заголовок такого стовпця буде (No column name), якщо ж такий варіант вас не влаштовує, то ви можете задати псевдонім (alias) цього стовпця за допомогою оператора AS. Наприклад, з'єднавши в SQL-запиті ім'я та прізвище студента через пробіл, вкажемо цьому стовпцю псевдонім FullName:

```html
SELECT FirstName + ' ' + LastName AS FullName, BirthDate, Grants, Email
FROM Students;
```

![](select-insert/copy-svgrepo-com.svg)

Результат запиту представлений на рисунку 4.

![Рисунок 4. Використання псевдоніму для формування нового стовпця](select-insert/R1lwWvoZzi3fEkFRVteca_Cx8aFHM6Vh.jpg)

Рисунок 4. Використання псевдоніму для формування нового стовпця

При написанні SQL-запиту ви можете змінювати дані у віртуальній таблиці, застосовуючи різні арифметичні дії, і це не позначиться на реальних даних. Припустимо, «ректор нашого університету» захотів дізнатися: «Як зміняться стипендії студентів, якщо їх збільшити на 20 відсотків?». Для того, щоб відповісти на це запитання, ми можемо написати наступний запит:

```html
SELECT FirstName + ' ' + LastName AS FullName, Grants*1.2 AS [Plus 20 persent]
FROM Students;
```

![](select-insert/copy-svgrepo-com.svg)

У попередньому запиті продемонстрована одна особливість при написанні імен стовпців: якщо в назві стовпця присутні пробіли, то цю назву необхідно брати до квадратних дужок. Результат цього SQL-запиту представлений на рисунку 5.

![Рисунок 5. Використання арифметичних операцій](select-insert/qvF8BPCgGvfjpilHlRwy4EDOzmer7a3H.jpg)

Рисунок 5. Використання арифметичних операцій

Оператор SELECT дозволяє повертати інформацію у вигляді рядка, який формується шляхом конкатенації (зчеплення) певної текстової інформації та значень різних стовпців. Однак при цьому зазначені стовпці повинні зберігати текстові дані, інакше при виконанні SQL-запиту ми отримаємо помилку (Рисунок 6).

![Рисунок 6. Помилка: неприпустиме приведення типів даних](select-insert/k4S2Ccm73WeDP76s8Fs1xuk19OiMmLbx.jpg)

Рисунок 6. Помилка: неприпустиме приведення типів даних

Ця помилка сталася через неможливість перетворення дійсних значень стовпця Grant до рядкового типу даних. Щоб вирішити цю проблему в мові T-SQL, існують дві стандартні функції CAST() і CONVERT(), які дозволяють здійснювати приведення даних до потрібного типу. Ці функції відрізняються параметрами, що приймаються, але порівнявши такі запити, ви розберетеся, як їх використовувати.

```html
SELECT 'Student ' + LastName + ' receives ' + CAST(Grants ASnvarchar(10)) FROM Students;
SELECT 'Student ' + LastName + ' receives ' + CONVERT(nvarchar(10), Grants) FROM Students;
```

![](select-insert/copy-svgrepo-com.svg)

В результаті виконання цих двох запитів ми отримаємо однакові результати (Рисунок 7).

![Рисунок 7. Формування SQL-запиту у вигляді рядка](select-insert/m284hlLIaLLEHf6ogln2gx6w9b8lnF3F.jpg)

Рисунок 7. Формування SQL-запиту у вигляді рядка

Наявність NULL-значень пояснюється тим, що у деяких студентів стипендія має невизначене значення, як прибрати такі записи з результуючої таблиці ви дізнаєтеся в наступному підрозділі.

У мові T-SQL разом із пропозицією SELECT можна використовувати оператор TOP, який дозволяє отримати перші записи абов кількісному, або у відсотковому відношенні.

Припустимо, що нам необхідно отримати перші два записи в таблиці Students, тоді запит буде виглядати так:

```html
SELECT TOP 2 LastName, FirstName, BirthDate
FROM Students;
```

![](select-insert/copy-svgrepo-com.svg)

Результат цього SQL-запиту представлений на рисунку 8.

![Рисунок 8. Використання оператора TOP](select-insert/y-SSYZ0coaQotnmGdjBm8er4nrsDd4Vo.jpg)

Рисунок 8. Використання оператора TOP

Якщо нам потрібно отримати, наприклад, 20% перших записів з таблиці Students, тоді після числового значення необхідно додати ключове слово PERCENT, що демонструється в наступному SQL-запиті (результат на рисунку 9).

```html
SELECT TOP 20 PERCENT LastName, FirstName, BirthDate
FROM Students;
```

![](select-insert/copy-svgrepo-com.svg)

![Рисунок 9. Використання оператора TOP](select-insert/8HO_CbWLQ-ag3IQSJ1qWywSYoyUJ06f2.jpg)

Рисунок 9. Використання оператора TOP

Якщо в таблиці вашої бази даних певне поле містить велику кількість значень, що повторюються, а ваше завдання позбутися від них у результуючій таблиці, то ви можете використовувати для цього оператор DISTINCT, який слід написати перед ім'ям необхідного стовпця, і тим самим ви виключите з результату всі повторення. Наприклад, нам треба визначити які імена у студентів у «нашому навчальному закладі», при цьому слід виключити повторення:

```html
SELECT DISTINCT FirstName
FROM Students;
```

![](select-insert/copy-svgrepo-com.svg)

Результат цього SQL-запиту представлений на рисунку 10.

![Рисунок 10. Використання оператора DISTINCT](select-insert/LNDMsUwoPy8nrFa4dFiHITPG90QgfY1o.jpg)

Рисунок 10. Використання оператора DISTINCT

### 1.3. Пропозиція WHERE

У випадках, коли необхідно відфільтрувати отримані дані, задавши певні умови, в SQL-запиті передбачено використання оператора WHERE, після якого прописуються необхідні умови. Загальна форма запису запиту з використанням оператора WHERE виглядає так:

```html
SELECT columnName1, columnName2, ...
FROM tableName
WHERE condition;
```

![](select-insert/copy-svgrepo-com.svg)

Для того, щоб у SQL-запиті вказати необхідні обмеження, у мові T-SQL використовуються наступні оператори порівняння:

-   \= — рівне;
-   <> — не рівне;
-   \> — більше;
-   \>= — більше чирівне;
-   !> — не більше ніж;
-   < — менше;
-   <= — менше чирівне;
-   !< — не менше ніж.

Наприклад, необхідно вивести стипендію та прізвища всіх студентів, у яких розмір стипендії перевищує 1000. SQL-запит у цьому випадку виглядатиме таким чином:

```html
SELECT LastName, Grants
FROM Students
WHERE Grants &gt; 1000;
```

![](select-insert/copy-svgrepo-com.svg)

В результаті виконання цього SQL-запиту ви отримаєте наступну таблицю (Рисунок 11).

![Рисунок 11. Використання операторів порівняння](select-insert/me0nIzYhvBLRvX8CutmJxYHXBj9OZe_k.jpg)

Рисунок 11. Використання операторів порівняння

Наступний SQL-запит дозволяє отримати інформацію про студентів, в імені яких не більше чотирьох символів:

```html
SELECT Id, LastName, FirstName, BirthDate, Grants, Email
FROM Students
WHERE LEN(FirstName) !&gt; 4;
```

![](select-insert/copy-svgrepo-com.svg)

Щоб визначити кількість символів (довжину рядка) в імені студента, ми використовуємо функцію LEN(), яка приймає рядкові дані. Ця функція вбудована в _MS SQL Server_ і не входить до стандарту мови T-SQL, тобто її виконання забезпечує сама СУБД. В результаті виконання цього SQL-запиту ви отримаєте наступну таблицю (Рисунок 12).

![Рисунок 12. Використання операторів порівняння](select-insert/rX-ymu76aJbJU1gFKB5PNPo-gdBxE_5K.jpg)

Рисунок 12. Використання операторів порівняння

Для того, щоб в операторі WHERE задати кілька умов, необхідно використовувати оператори об'єднання AND та OR.

Оператор AND об'єднує дві умови та повертає істину, якщо обидві умови правильні. Наприклад, потрібно отримати інформацію про студентів, які народилися восени, такий SQL-запит може виглядати так:

```html
SELECT LastName, FirstName, BirthDate
FROM Students
WHERE MONTH(BirthDate) &gt;= 9 AND MONTH(BirthDate) &lt;= 11;
```

![](select-insert/copy-svgrepo-com.svg)

Для того, щоб визначити місяць народження студентів, ми скористалися стандартною функцією мови T-SQL — MONTH(), яка дозволяє отримати номер місяця з переданої дати. Для того, щоб отримати рік і день, як частину дати, ви можете скористатися стандартними функціями YEAR() та DAY() відповідно.

В результаті виконання попереднього SQL-запиту ви отримаєте таку таблицю (Рисунок 13).

![Рисунок 13. Використання оператора AND](select-insert/Zla52LFwcJ9Qti4IIXwe5Dbx7FV7Ae6x.jpg)

Рисунок 13. Використання оператора AND

Оператор OR об'єднує дві умови і повертає істину, якщо хоча б одна з умов є правильною. Наприклад, необхідно відобразити інформацію про студентів, які мають або парний рік народження, або непарний день народження. Для того щоб отримати необхідний результат необхідно здійснити перевірку відповідних значень на кратність числу два, використовуючи операцію ділення по модулю (%).

```html
SELECT LastName, FirstName, BirthDate
FROM Students
WHERE YEAR(BirthDate) % 2 = 0 OR DAY(BirthDate) % 2 &lt;&gt; 0;
```

![](select-insert/copy-svgrepo-com.svg)

В результаті виконання попереднього SQL-запиту ви отримаєте наступну таблицю (Рисунок 14).

![Рисунок 14. Використання оператора OR](select-insert/aVhWokibY94AO1MXaRhElAT9aXFh5MbO.jpg)

Рисунок 14. Використання оператора OR

У випадках, коли вам потрібно перевірити значення стовпців на невизначеність (значення NULL), використання операторів порівняння (\=, <>, \>, <, тощо) неможливо. Натомість вам необхідно використовувати оператор IS NULL. Наприклад, для того, щоб отримати список усіх студентів, які не отримують стипендії, необхідно написати наступний запит до бази даних:

```html
SELECT LastName, FirstName, Grants
FROM Students
WHERE Grants IS NULL;
```

![](select-insert/copy-svgrepo-com.svg)

Результат SQL-запиту представлений рисунку 15.

![Рисунок 15. Використання оператора IS NULL](select-insert/_U9mV_hqlU1hCXTGDSyLVNO-W_OZgpJN.jpg)

Рисунок 15. Використання оператора IS NULL

Існує ще один оператор — NOT, який використовується, коли необхідно задати протилежну умову, скажімо, потрібно отримати інформацію про студентів, прізвища яких вказувалися при заповненні таблиці Students, тобто не рівні Doe.

```html
SELECT Id, LastName, FirstName, BirthDate, Grants, Email
FROM Students
WHERE NOT LastName = 'Doe';
```

![](select-insert/copy-svgrepo-com.svg)

Результат SQL-запиту представлений на рисунку 16.

![Рисунок 16. Використання оператора NOT](select-insert/TWXfOp3jcq0vLSw8bAkQXvzfT1qVsUyJ.jpg)

Рисунок 16. Використання оператора NOT

Синтаксис використання оператора NOT зі значеннями NULL дещо відрізняється. Припустимо, нам необхідна інформація про всіх студентів, які отримують стипендію, у цьому випадку SQL-запит виглядатиме так:

```html
SELECT LastName, FirstName, Grants
FROM Students
WHERE Grants IS NOT NULL;
```

![](select-insert/copy-svgrepo-com.svg)

Результати цього запитубудуть,природно, діаметрально протилежні запиту на рисунку 15 (Рисунок 17).

![Рисунок 17. Використання оператора NOT з значеннями NULL](select-insert/ZjwJSdPWXNifyr_AvITzf_jZ32u-SUH7.jpg)

Рисунок 17. Використання оператора NOT з значеннями NULL

### 1.4. Пропозиція ORDER BY

При написанні деяких SQL-запитів існує потреба впорядкувати отриману інформацію, у таких випадках при написанні запитів слід використовувати пропозицію ORDER BY. Загальна форма запису запиту з використанням оператора ORDER BY виглядає наступним чином:

```html
SELECT columnName1, columnName2, ...
FROM tableName
ORDER BY columnName1 ASC | DESC, ...;
```

![](select-insert/copy-svgrepo-com.svg)

За допомогою оператора ORDER BY можна вказати потрібну кількість стовпців, за якими буде проводитися сортування та напрямок цього сортування. Для того щоб отримані дані були відсортовані за спаданням, необхідно вказати ключове слово DESC (від _descending_) після відповідного поля. Сортування за зростанням є сортуванням по замовчуванню і його можна не вказувати, але якщо ви хочете зробити це явним чином, слід скористатися ключовим словом ASC (від _ascending_).

Як приклад використання оператора ORDER BY наведемо SQL-запит, який повертає список студентів, відсортований за датою народження (Рисунок 18):

```html
SELECT LastName, FirstName, BirthDate
FROM Students
ORDER BY BirthDate;
```

![](select-insert/copy-svgrepo-com.svg)

![Рисунок 18. Використання сортування у SQL-запиті](select-insert/CCySW1PlVX6-PJessl4BgbdNtnPeUBdJ.jpg)

Рисунок 18. Використання сортування у SQL-запиті

При написанні SQL-запиту існує можливість вказати в операторі ORDER BY кілька полів із різним напрямком сортування. Припустимо, отриманий в результаті виконання запиту, список студентів треба відсортувати як за спаданням (стовпець LastName), так і за зростанням (стовпець FirstName), для цього необхідно написати наступний SQL-запит:

```html
SELECT LastName, FirstName, BirthDate
FROM Students
ORDER BY LastName DESC, FirstName ASC;
```

![](select-insert/copy-svgrepo-com.svg)

Сортування даних буде здійснюватися наступним чином: всі результати будуть відсортовані по прізвищу і тільки в тому випадку, коли значення стовпця LastName збігається більш ніж в одному результуючому рядку, запуститься сортування по імені студента (Рисунок 19).

![Рисунок 19. Використання сортування за кількома стовпцями](select-insert/9mIx-k9nZfAgmlf5-lM-jHor9Jr9T4Qx.jpg)

Рисунок 19. Використання сортування за кількома стовпцями

## 2\. Ключові слова IN, BETWEEN, LIKE

При написанні різних SQL-запитів існує потреба вказати складну умову фільтрації отриманих результатів з використанням кількох операторів OR. Наприклад, необхідно отримати інформацію про студентів, яких звуть John, David або Jack:

```html
SELECT LastName, FirstName, BirthDate, Grants, Email
FROM Students
WHERE FirstName = 'John' OR FirstName = 'David' OR FirstName = 'Jack';
```

![](select-insert/copy-svgrepo-com.svg)

Цей SQL-запит поверне правильний результат (Рисунок 20), але в ньому часто використовується оператор OR.

![Рисунок 20. Запит, який використовує кілька операторів OR](select-insert/qaEkXECiDglsQK51-xe2X_fWGeiVmqsQ.jpg)

Рисунок 20. Запит, який використовує кілька операторів OR

Для того, щоб покращити читабельність подібних запитів, можна використовувати ключове слово IN, яке забезпечує порівняння значення зазначеного стовпця з будь-яким значенням із зазначеної множини. Переписавши попередній запит, ми отримаємо той самий результат (Рисунок 20).

```html
SELECT LastName, FirstName, BirthDate, Grants, Email
FROM Students
WHERE FirstName IN('John', 'David', 'Jack');
```

![](select-insert/copy-svgrepo-com.svg)

При написанні SQL-запитів, в яких потрібна перевірка на потрапляння значення певного стовпця в певний діапазон, можна використовувати оператор AND, а можна,як альтернативу, застосувати ключове слово BETWEEN. Ключове слово BETWEEN прописується після імені стовпця, а після нього необхідно вказати нижню та верхню межу діапазону значень, розділених оператором AND, межі діапазону також враховуються.

Припустимо, необхідно визначити студентів, які народилися у 1997 році. Наступні два запити повернуть однаковий результат (Рисунок 21).

SQL-запит, щовикористовує оператор AND:

```html
SELECT LastName, FirstName, BirthDate
FROM Students
WHERE BirthDate &gt;= '1997-01-01' AND BirthDate &lt;= '1997-12-31';
```

![](select-insert/copy-svgrepo-com.svg)

SQL-запит із використанням ключового слова BETWEEN:

```html
SELECT LastName, FirstName, BirthDate
FROM Students
WHERE BirthDate BETWEEN '1997-01-01' AND '1997-12-31';
```

![](select-insert/copy-svgrepo-com.svg)

![Рисунок 21. Результат попадання інформації у вказаний діапазон](select-insert/vR_ITYuPrVaVGyGYPDn-_bWwaqPpTixi.jpg)

Рисунок 21. Результат попадання інформації у вказаний діапазон

Слід звернути увагу на синтаксис запису дати народження: дата вказується в послідовності рік-місяць-день і береться в одинарні лапки, як рядкові дані. Таке представлення дати визначено драйвером ODBC (_Open Database Connectivity_), який забезпечує взаємодію програм, написаних різними мовами програмування, з даними SQL Server.

Ключове слово BETWEEN можна застосовувати в SQL-запитах, які вимагають порівняння рядкових значень, при цьому порівняння буде здійснюватись відповідно до кодів символів. Також із ключовим словом BETWEEN можна використовувати оператор NOT, наприклад, необхідно вивести всіх студентів, прізвища яких не починаються на літери E, F та G.

```html
SELECT LastName, FirstName
FROM Students
WHERE LastName NOT BETWEEN 'E' AND 'G';
```

![](select-insert/copy-svgrepo-com.svg)

Результат, отриманий після виконання цього SQL-запиту, відображено на рисунку 22.

![Рисунок 22. Використання ключового слова BETWEEN із оператором NOT](select-insert/EsZgf2Ek4GMjGQdeFfI9FWZKmLPVFEgV.jpg)

Рисунок 22. Використання ключового слова BETWEEN із оператором NOT

У тих випадках, коли необхідно здійснити пошук текстових полів таблиць, існує можливість використовувати шаблон, який можна задати, застосувавши ключове слово LIKE. Для того, щоб сформувати шаблон, необхідно вказувати певні службові символи або комбінації цих символів:

-   % — відповідає будь-якій послідовності символів від 0 і більше;
-   \_ — представляє будь-який одиночний символ;
-   \[\] — задає послідовність чи діапазон можливих символів;
-   \[^\] — задає послідовність або діапазон символів, які мають бути відсутніми.

Продемонструємо використання ключового слова LIKE на таких прикладах. За допомогою першого SQL-запиту ми хочемо отримати всіх студентів, прізвище яких починається на букву J або M, а ім'я закінчується на букву k:

```html
SELECT LastName, FirstName, BirthDate, Grants, Email
FROM Students
WHERE LastName LIKE '[JM]%' AND FirstName LIKE '%k';
```

![](select-insert/copy-svgrepo-com.svg)

Результат виконання цього SQL-запиту ви можете побачити на рисунку 23.

![Рисунок 23. Використання ключового слова LIKE](select-insert/kW4NcjvIQ5b7dXmAWS3E_V3Jf7rs5nA4.jpg)

Рисунок 23. Використання ключового слова LIKE

Наступний запит поверне інформацію про студентів, у яких в адресі електронної пошти друга літера не співпадає з жодною літерою з діапазону від f до m:

```html
SELECT LastName, FirstName, BirthDate, Grants, Email
FROM Students
WHERE Email LIKE '_[^f-m]%';
```

![](select-insert/copy-svgrepo-com.svg)

Результат виконання попереднього SQL-запиту (Рисунок 24).

![Рисунок 24. Використання ключового слова LIKE](select-insert/9_ct-wbn04ChgVsNKgCkEwhVUCFdHW22.jpg)

Рисунок 24. Використання ключового слова LIKE

## 3\. Оператор INSERT

У другому уроці, під часстворення таблиці ми заповнювали її значеннями, використовуючи засоби _MS SQL Server Management Studio_. Однак досить часто виникатиме необхідність заповнення таблиць програмним шляхом і в цьому вам допоможе оператор INSERT.

Оператор INSERT може бути використаний двома способами. У першому випадку необхідно вказувати імена тих стовпців таблиці, в які ви будете записувати відповідні значення, вказані після ключового слова VALUES, загальна форма запису виглядає наступним чином:

```html
INSERT INTO tableName(columnName1, columnName2, ...)
VALUES (value1, value2,...);
```

![](select-insert/copy-svgrepo-com.svg)

Якщо ви будете використовувати таку форму оператора INSERT, то вам необхідно вказувати щонайменше всі стовпці таблиці, які не можуть набувати невизначеного (NULL) значення. В іншому випадку при спробі вставити дані _Management Studio_ видасть помилку (Рисунок 25).

![Рисунок 25. Помилка: неможливо вставити значення NULL в стовпець BirthDate](select-insert/ek7PtgnQuwpK3ciNj_3TFIWFgZqjTUeo.jpg)

Рисунок 25. Помилка: неможливо вставити значення NULL в стовпець BirthDate

При написанні такого виду запитів не обов'язково дотримуватися правильного порядку проходження імен стовпців у таблиці. У наступному SQL-запиті ми вкажемо імена необхідних стовпців у довільній послідовності, і не будемо вказувати стовпці, які можуть зберігати невизначені значення (Рисунок 26).

![Рисунок 26. Використання оператора INSERT](select-insert/55yFVNzydBREDYew7BZgM7I72fzgAgg4.jpg)

Рисунок 26. Використання оператора INSERT

Хоча ви бачите повідомлення MS SQL про коректне виконання запиту (1 row affected), переконаємось у правильності додавання даних самостійно, виконавши наступний запит, результат на рисунку 27.

```html
SELECT LastName, FirstName, BirthDate, Grants, Email
FROM Students;
```

![](select-insert/copy-svgrepo-com.svg)

![Рисунок 27. Перевірка правильності додавання даних](select-insert/Y71SGvHvYgdu2DBcdYp7A8KrMbem5VYa.jpg)

Рисунок 27. Перевірка правильності додавання даних

При використанні оператора INSERT другим способом назви стовпців таблиці не вказуються, загальна форма запису виглядає наступним чином:

```html
INSERT INTO tableName
VALUES (value1, value2, ...);
```

![](select-insert/copy-svgrepo-com.svg)

Якщо ви використовуєте таку форму оператора INSERT, то вам необхідно вказувати значення для всіх стовпців, які не можуть набувати невизначеного значення, обов'язково дотримуючись порядку їх проходження в таблиці.

Припустимо, нам потрібно додати до таблиці студентку, яка не отримує стипендії, але адреса її електронної пошти нам відома. У цьому випадку нам необхідно вказати NULL-значення для стипендії, інакше в таблицю будуть записані неправильні дані:

```html
INSERT INTO Students
VALUES ('Evans', 'Grace', '1998-08-30', NULL, 'eg@net.eu');
```

![](select-insert/copy-svgrepo-com.svg)

Переконатися в правильності додавання запису ви можете самостійно, виконавши вже знайомий SQL-запит (див. вище).

У мові Т-SQL існує можливість заповнення існуючої таблиці значеннями, отриманими в результаті виконання SQL-запиту. Для цього використовується оператор INSERT INTO SELECT, застосування якого здійснюється двома способами.

У першому випадку ми копіюємо всі дані з таблиці, які є джерелом даних, і це виглядає наступним чином:

```html
INSERT INTO destinationTable
SELECT * FROM sourceTable
WHERE condition;
```

![](select-insert/copy-svgrepo-com.svg)

Друга форма запису передбачає явну вказівку як назв стовпців таблиці-джерела, що підлягають копіюванню, так і назв стовпців таблиці-приймача даних:

```html
INSERT INTO destinationTable(columnName1, columnName2, ...)
SELECT columnName1, columnName2, ...
FROM sourceTable
WHERE condition;
```

![](select-insert/copy-svgrepo-com.svg)

Відповідні стовпці цих таблиць не обов'язково повинні мати однакові назви, необхідною вимогою при використанні оператора INSERT INTO SELECT є відповідність типів даних у відповідних стовпцях вихідної та цільової таблиць.

Для того щоб перевірити, як це працює нам необхідно, для початку, створити в нашій базі даних University тимчасову таблицю, яку ми назвемо, наприклад, Temp. Створити таку таблицю ви можете самостійно, освіживши знання з уроку №2. Назва полів та їх кількість у таблиці Temp не обов'язково має повторювати всі поля існуючої таблиці Students, обмежимося лише кількома з них (Рисунок 28).

![Рисунок 28. Створення тимчасової таблиці](select-insert/tDPaOec7-vyuk4vOkIJVxv0u3lzX9PGD.jpg)

Рисунок 28. Створення тимчасової таблиці

Після того як ми створили тимчасову таблицю Temp, заповнимо її лише тими відомостями про студентів (з таблиці Students), які народилися в другій половині року, необхідний SQL-запит виглядатиме таким чином (Рисунок 29).

![Рисунок 29. Заповнення тимчасової таблиці потрібними даними](select-insert/cDjZT8dAxsEL4g_GOi6Cn-0V3ceO-rdX.jpg)

Рисунок 29. Заповнення тимчасової таблиці потрібними даними

Виконавши наступний запит до таблиці Temp, ми переконаємось у правильності додавання інформації (Рисунок 30).

```html
SELECT LName, FName, BirthDate
FROM Temp;
```

![](select-insert/copy-svgrepo-com.svg)

![Рисунок 30. Перевірка правильності додавання даних](select-insert/h0hEJrQ-GnS0Ygj0CY14pD1NbRxsCRDp.jpg)

Рисунок 30. Перевірка правильності додавання даних

СУБД _MS SQL Server_ надає можливість створення нової таблиці на основі існуючої шляхом копіювання значень всіх зазначених стовпців з використанням оператора SELECT INTO, загальна форма запису виглядає наступним чином:

```html
SELECTcolumnName1, columnName2, ...
INTO newTable
FROM existingTable
WHERE condition;
```

![](select-insert/copy-svgrepo-com.svg)

Створимо в нашій базі даних University нову таблицю з інформацією про студентів, електронна адреса яких відома, виконавши наступний запит (Рисунок 31).

![Рисунок 31 Створення нової таблиці на основі існуючої](select-insert/qRp1l_7dR-rWJf81rtx1zAuIHiUicGwE.jpg)

Рисунок 31 Створення нової таблиці на основі існуючої

Для того, щоб перевірити отриманий результат, у наступному SQL-запиті ми спеціально не будемо перераховувати назви стовпців, результат на рисунку 32.

```html
SELECT*
FROM Temp1;
```

![](select-insert/copy-svgrepo-com.svg)

![Рисунок 32. Перевірка інформації, записаної у нову таблицю](select-insert/-mVk6gPKZCDXbJhVNooNNMb_kS2hQpDB.jpg)

Рисунок 32. Перевірка інформації, записаної у нову таблицю

Після того, як ми продемонстрували використання операторів INSERT INTO SELECT та SELECT INTO, видалимо непотрібні нам таблиці Temp та Temp1 з бази даних University. Для цього необхідно натиснути правою клавішею миші на ім'я відповідної таблиці у списку Tables бази даних University вікна Object Explorer та в контекстному меню вибрати пункт Delete (Рисунок 33)

![Рисунок 33. Видалення таблиці з бази даних (початок)](select-insert/frqdk3qSStvmD9tbiQAFSf6h16J0VVMw.jpg)

Рисунок 33. Видалення таблиці з бази даних (початок)

Після цього з'явиться вікно Delete Object, в якому після натискання кнопки OK ви побачите індикатор процесу видалення таблиці (Рисунок 34).

![Рисунок 34. Видалення таблиці з бази даних (завершення)](select-insert/_TmAnd-_25lMSLVgtZcWzDiRJ493PGzh.jpg)

Рисунок 34. Видалення таблиці з бази даних (завершення)

Після закриття вікна таблиця зникне зі списку Tables вашої бази даних.

## 4\. Оператор UPDATE

Для того, щоб змінити будь-який запис за допомогою SQL-запиту, використовується оператор UPDATE, загальна форма запису якого виглядає наступним чином:

```html
UPDATE tableName
SET columnName1 = value1, columnName2 = value2, ...
WHERE condition;
```

![](select-insert/copy-svgrepo-com.svg)

Використання оператора WHERE можна вважати обов'язковим, адже якщо ви не вкажете умову, то зміниться значення у відповідному стовпці по всій таблиці.

Змоделюємо певну фантастичну ситуацію: «ректор нашого університету» вирішив виплачувати мінімальну стипендію всім студентам незалежно від їхньої успішності, так би мовити, на покупку зошитів,звичайно не можна залишити поза увагою студентів, які добре навчаються — їм треба підвищити стипендію. Така ініціатива має призвести до зміни інформації в базі даних, тобто нам необхідно виконати запити з використанням оператора UPDATE, які будуть виглядати наступним чином (Рисунок 35).

![Рисунок 35. Зміна інформації у таблиці](select-insert/f0O9MlIXENtNl-CqW2w3gL14TVMTOyS0.jpg)

Рисунок 35. Зміна інформації у таблиці

В даному прикладі дуже важливий порядок виконання SQL-запитів, якщо спочатку встановимо стипендію студентам, що відстають, тоді після збільшення стипендії всім студентам, які навчаються добре, у відстаючих студентів стипендія збільшиться вдвічі.

Подивимося, які дані зараз зберігаються у стовпці Grants таблиці Students (Рисунок 36).

```html
SELECT LastName, FirstName, Grants
FROM Students;
```

![](select-insert/copy-svgrepo-com.svg)

![Рисунок 36. Перевірка правильності зміни даних](select-insert/dLuSWd4G6I9NDx7tGoQXN2DhRGTXvc6J.jpg)

Рисунок 36. Перевірка правильності зміни даних

## 5\. Оператор DELETE

Щоб видалити певну інформацію з таблиць бази даних програмним шляхом необхідно використовувати оператор DELETE, загальна форма запису виглядає наступним чином:

```html
DELETE FROM tableName
WHERE condition;
```

![](select-insert/copy-svgrepo-com.svg)

Використовувати оператор DELETE необхідно з особливою обережністю, тому що можна випадково видалити дуже важливу інформацію. Якщо ви не будете встановлювати граничну умову за допомогою оператора WHERE, то ваш SQL-запит видалить всю інформацію з поточної таблиці.

Наведемо приклад використання оператора DELETE, наприклад, нам необхідно видалити всі записи з таблиці Students, у яких унікальний ідентифікатор (Id) більше 9 (Рисунок 37).

![Рисунок 37. Видалення інформації з таблиці](select-insert/8EATiyMq28-4Z4vHzf4RlR59hxkWQOSg.jpg)

Рисунок 37. Видалення інформації з таблиці

Як ви помітили, в даному випадку було видалено два записи (2 row affected), при цьому результат виконання SQL-запиту у вашій базі даних може відрізнятися.

## 6\. Поняття транзакції. Використання транзакцій

Класичний приклад транзакції з повсякденного життя — переказ коштів з одного рахунку на інший. Звичайно всі хочуть, щоб гроші після зняття з рахунку-відправника потрапили на рахунок-одержувача, але якщо в момент здійснення цієї операції відбудеться збій у системі, то необхідно щоб гроші повернулися на рахунок-відправника. Взагалі, транзакції оточують нас усюди, і ви можете самі навести їх приклади, подумайте.

Під транзакцією розуміється послідовність дій, які виконуються як єдине ціле з можливістю скасування кожної з них у разі помилки.

СУБД _MS SQL Server_ забезпечує підтримку транзакцій, що характеризується чотирма важливими властивостями, відомими під акронімом ACID:

-   Atomicity (_атомарність_) — визначає цілісність транзакції, тобто для успішного завершення транзакції повинні виконатися або всі операції, що становлять цю транзакцію, або жодна з них;
-   Consistency (_узгодженість_) — ця властивість забезпечує цілісність інформації незалежно від того,чи успішно завершилася транзакція чи ні;
-   Isolation (_ізольованість_) — означає, що всі транзакції виконуються паралельно і не можуть впливати одна на одну;
-   Durability (_надійність_) — забезпечує збереження всіх даних після фіксації успішно виконаної транзакції незалежно від можливих збоїв системи.

Існує три типи транзакцій:

-   явні транзакції, які характеризуються явною вказівкою початку транзакції (BEGIN TRAN або BEGIN TRANSACTION), її фіксації у разі успішного завершення (COMMIT TRAN або COMMIT TRANSACTION) та з можливістю переривання (відкату) транзакції при виникненні певної умови (ROLLBACK TRAN або ROLLBACK TRANSACTION);
-   неявні транзакції — транзакції, для яких початок і кінець не вказуються явно,такі транзакції відбуваються при виконанні наступних інструкцій — ALTER TABLE, CREATE, DROP, SELECT, INSERT, DELETE, UPDATE, GRANT, REVOKE, OPEN, FETCH, TRUNCATE TABLE — кожна з них виконується, як окрема транзакція;
-   автоматичні транзакції характерні тим, що кожна успішно виконана операція фіксується, в іншому випадку відкочується,для того, щоб перейти у цей режим необхідно виконати команду SET IMPLICIT\_TRANSACTION з параметром OFF, для виходу SET IMPLICIT\_TRANSACTIONON.

СУБД _MS SQL Server_ створена, як багатокористувацька система, тобто система, яка дозволяє одночасно використовувати об'єкти баз даних декількома користувачами. У зв'язку з цим існують чотири можливі порушення під час роботи з базами даних:

-   читання незафіксованих даних;
-   неповторне читання;
-   фантоми;
-   втрачені оновлення.

Для того, щоб запобігти конфліктам, які можуть виникнути при виконанні різних операцій з одним і тим самим об'єктом різними користувачами використовуються блокування. _MS SQL Server_ забезпечує підтримку шести типів блокованих ресурсів: база даних, таблиця, екстент, сторінка, ключ та рядок. Також існує досить велика кількість типів самих блокувань,перерахуємо основні з них: розділяючі, виняткові, намічені, блокування оновлення, блокування схеми, блокування масового оновлення.

Блокування, що застосовуються під час виконання транзакцій, перешкоджають взаємодії з об'єктами іншим процесам, цим самим можуть бути причиною взаємної ізоляції транзакцій. Для управління ступенем взаємної ізоляції транзакцій існують чотири рівні ізольованості транзакцій:

-   READ UNCOMMITTED — дозволяє зчитувати дані, які були змінені, але не були зафіксовані (не запобігає жодному з можливих порушень);
-   READ COMMITTED — не дозволяє зчитувати дані, які були змінені, але не були зафіксовані (використовується за замовчуванням) (запобігає читанню незафіксованих даних);
-   REPEATABLE READ — ніяка транзакція не може змінювати дані, які зчитуються поточною транзакцією до її завершення (запобігає читанню незафіксованих даних та неповторному читанню);
-   SERIALIZABLE — будь-які інші транзакції не можуть вставляти/змінювати/видаляти дані, які потрапляють до діапазону записів, що задовольняють умову, яка задана в операторі WHERE поточної транзакції (запобігає читанню незафіксованих даних, неповторному читанню та фантомам).

Докладніша інформація про транзакції та їх практичне використання будуть розглянуті в курсі _MS SQL Server_.

## 7\. Домашнє завдання

У домашньому завданні до уроку №2 необхідно було створити базу даних «Лікарня» з таблицею «Patients», заповніть цю таблицю довільними даними з використанням оператора INSERT (не менше десяти записів) та напишіть наступні SQL-запити:

-   вивести інформацію про всіх пацієнтів, які перебувають у лікарні;
-   показати дані про пацієнтів, які лежать у певному відділенні;
-   вивести назви всіх відділень лікарні;
-   отримати дані про пацієнтів, які лежать у лікарні більше місяця, відсортувавши їх за зростанням дати надходження;
-   вивести інформацію про пацієнтів, які були виписані минулого місяця (вам допоможе стандартна функція GETDATE() мови T-SQL, яка дозволяє отримати поточну дату);
-   показати інформацію про пацієнтів, які лежали у лікарні з жовтнядо грудня минулого року у певному відділенні;
-   вивести інформацію про наймолодшого пацієнта та його вік (для написання цього запиту вам слід самостійно вивчити стандартну функцію DATEDIFF(), інформацію про яку ви можете отримати за [посиланням](https://docs.microsoft.com/en-us/sql/t%20-sql/functions/datediff-transact-sql);
-   отримати інформацію про пацієнтів, які лежать у будь-яких трьох відділеннях;
-   показати всіх пацієнтів, прізвище яких починаєтьсяна літеру Р;
-   вивести дані про пацієнтів, яких лікує певний лікар із однаковими захворюваннями;
-   отримати дані про пацієнтів, які користуються послугами певного мобільного оператора;
-   перейменувати назву певного відділення;
-   видалити всіх пацієнтів, які були виписані понад півроку тому.

© STEP IT Academy, [itstep.org](https://itstep.org/)

All the copyrighted photos, audio, and video works, fragments of which are used in the material, are the property of their respective owners. Fragments of the works are used for illustrative purposes to the extent justified by the objective, within the educational process, and for educational purposes, in accordance with the Act of “On Copyright and Related Rights”. The scope and method of the cited works are in accordance with the adopted norms, without prejudice to the normal exploitation of copyright, and do not prejudice the legitimate interests of authors and right holders. At the time of use, the cited works fragments cannot be replaced by alternative, non-copyrighted counterparts and meet the criteria for fair use. All rights reserved. Any reproduction of the materials or its part is prohibited. Use of the works or their fragments must be agreed upon with authors and rights holders. Agreed material use is only possible with reference to the source. Responsibility for unauthorized copying and commercial use of the material is determined by the current legislation.
